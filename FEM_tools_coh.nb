(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    716076,      17780]
NotebookOptionsPosition[    706050,      17634]
NotebookOutlinePosition[    706454,      17650]
CellTagsIndexPosition[    706411,      17647]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["FEM code for VDM", "Title",
 CellChangeTimes->{{3.8799943899350266`*^9, 3.879994395415865*^9}, {
  3.9343708092435837`*^9, 
  3.934370811064824*^9}},ExpressionUUID->"0755cff9-3e35-4645-8c7f-\
357667b38bc1"],

Cell["\<\
The implementation of VDM is relatively simple. The implementation is very \
similar to the standard FEM. 
The key functions include \[OpenCurlyDoubleQuote]EnergyDensity2Dspectral, \
EnergyDensity3Dspectral, OneElementMatrixVD2d, OneElementMatrixVD3d, \
OneElementMatrixVD2dOrder, and OneElementMatrixVD3dOrder\
\[CloseCurlyDoubleQuote]. These four functions calculate \
\[OpenCurlyDoubleQuote]positive\[CloseCurlyDoubleQuote]/\
\[CloseCurlyDoubleQuote]negative\[CloseCurlyDoubleQuote] energy density \
\[Phi]\:207a/\[Phi]\:207b, \[OpenCurlyDoubleQuote]positive\
\[CloseCurlyDoubleQuote]/\[CloseCurlyDoubleQuote]negative\
\[CloseCurlyDoubleQuote]  residual R\:207a/R\:207b, \
\[OpenCurlyDoubleQuote]positive\[CloseCurlyDoubleQuote]/\
\[CloseCurlyDoubleQuote]negative\[CloseCurlyDoubleQuote] material tensor D\
\:207a/D\:207b.  
These functions are not well organized. The code is not well commented. \
\>", "Text",
 CellChangeTimes->{{3.934370847404146*^9, 3.9343709052443132`*^9}, {
  3.9343709692575765`*^9, 3.9343712291815023`*^9}, {3.9343712828326225`*^9, 
  3.934371332314927*^9}, {3.9343713664639482`*^9, 3.93437141001861*^9}, {
  3.934374336457459*^9, 
  3.9343743420388927`*^9}},ExpressionUUID->"ffa4902b-93df-48a8-8a49-\
78a11128ef01"],

Cell[CellGroupData[{

Cell["\<\
Eigenvalue decomposition and spectral decomposition of strain energy in 2D\
\>", "Section",
 CellChangeTimes->{{3.880014277702594*^9, 
  3.8800142972708173`*^9}},ExpressionUUID->"c6c726f1-4280-4457-8902-\
787126562587"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h$t$pa", "=."}], ";", 
  RowBox[{
   RowBox[{"AbortReady", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"h$t$pa", "=."}], ";", 
      RowBox[{"h$t$pa", "=", "\"\<Alter file to abort MMA.txt\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "h$t$pa", "]"}], ",", 
        RowBox[{"DeleteFile", "[", "h$t$pa", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"file", "=", 
       RowBox[{"CreateFile", "[", "h$t$pa", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StartProcess", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<Notepad.exe\>\"", ",", "h$t$pa"}], "}"}], "]"}], ";"}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AbortCheck", "[", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ValueQ", "[", "h$t$pa", "]"}]}], ",", 
       RowBox[{"AbortReady", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "h$t$pa", "]"}], ",", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"ReadList", "[", 
          RowBox[{"h$t$pa", ",", "String", ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"h$t$pa", "=."}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8800816609934807`*^9, 3.880081662346424*^9}, {
  3.897444972854734*^9, 3.8974450080786448`*^9}, {3.8987471621290607`*^9, 
  3.898747221034897*^9}, {3.898747317593865*^9, 3.898747319418665*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"cfd1fc96-405b-448b-994c-1970e153d838"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "Print0", "]"}], "\n", 
 RowBox[{
  RowBox[{"Print0", "[", "expr_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{
      RowBox[{"MessagesNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{
      RowBox[{"MessagesNotebook", "[", "]"}], ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"BoxData", "[", 
         RowBox[{"\"\<During evaluation of In[\>\"", "<>", 
          RowBox[{"ToString", "@", "$Line"}], "<>", "\"\<]\>\""}], "]"}], 
        ",", "\"\<CellLabel\>\""}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{
      RowBox[{"MessagesNotebook", "[", "]"}], ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"BoxData", "[", 
         RowBox[{"ToBoxes", "[", "expr", "]"}], "]"}], ",", "\"\<Print\>\""}],
        "]"}]}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.8994578502334805`*^9, 3.8994578502334805`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"ff0fc33e-1e08-41ba-97e3-088d945857a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Round1", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"n_", ":", "3"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "m", "}"}], ",", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", "\[Equal]", "0.`"}], ",", "0.`", ",", 
        RowBox[{"Round", "[", 
         RowBox[{"Log10", "[", 
          RowBox[{"Abs", "[", "x", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{"x", " ", 
        SuperscriptBox["10", 
         RowBox[{"n", "-", "m"}]]}], "]"}], " ", 
      SuperscriptBox["10.`", 
       RowBox[{"m", "-", "n"}]]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"Round1", ",", "Listable"}], "]"}]}], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"f2bd049d-493b-47bf-becd-e7efa27d4b09"],

Cell[CellGroupData[{

Cell["Extract node force and", "Subsection",
 CellChangeTimes->{{3.897445120460437*^9, 
  3.8974451303852887`*^9}},ExpressionUUID->"cd3e8814-57ad-4086-b3db-\
41f627be5269"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExtractNodeForce", "[", 
   RowBox[{"Rsp_", ",", "nodeList_", ",", "ndim_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Rsp", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nodeList", "-", "1"}], ")"}], "ndim"}], "+", "i"}], "]"}], 
      "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "ndim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExtractNodeForce", "[", 
   RowBox[{"Rsp_", ",", "nodeList_", ",", "ndim_", ",", "idim_"}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Rsp", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"nodeList", "-", "1"}], ")"}], "ndim"}], "+", "idim"}], "]"}],
     "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaussPointToNodeValue", "[", 
   RowBox[{"gpData_", ",", "ele_", ",", "node_", ",", "gpShapeN_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"invN", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"gpShapeN", "\[Transpose]"}], ".", "gpShapeN"}], "]"}], ".", 
        RowBox[{"gpShapeN", "\[Transpose]"}]}]}], ",", "dataE", ",", "dataN", 
      ",", "nodeCount", ",", "ei"}], "}"}], ",", 
    RowBox[{
     RowBox[{"dataE", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"invN", ".", "egp"}], ",", 
        RowBox[{"{", 
         RowBox[{"egp", ",", "gpData"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dataN", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "node", "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nodeCount", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "node", "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ei", "=", 
         RowBox[{"ele", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"dataN", "[", 
          RowBox[{"[", "ei", "]"}], "]"}], "+=", 
         RowBox[{"dataE", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"nodeCount", "[", 
          RowBox[{"[", "ei", "]"}], "]"}], "+=", "1"}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dataN", "/", "nodeCount"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaussPointToNode", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gpData", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ele", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"node", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"gpShapeN", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"invN", "=", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"gpShapeN", "\[Transpose]"}], ".", "gpShapeN"}], "]"}], 
           ".", 
           RowBox[{"gpShapeN", "\[Transpose]"}]}]}], ",", "dataE", ",", 
         "dataN", ",", "nodeCount", ",", "ei"}], "}"}], ",", 
       RowBox[{
        RowBox[{"dataE", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"invN", ".", "egp"}], ",", 
           RowBox[{"{", 
            RowBox[{"egp", ",", "gpData"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataN", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "node", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodeCount", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "node", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ei", "=", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"dataN", "[", 
             RowBox[{"[", "ei", "]"}], "]"}], "+=", 
            RowBox[{"dataE", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"nodeCount", "[", 
             RowBox[{"[", "ei", "]"}], "]"}], "+=", "1"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataN", "/", "nodeCount"}]}]}], "\[IndentingNewLine]", "]"}],
      ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
     ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "GaussPointToNode", " ", "is", " ", "almost", " ", "10", " ", "times", " ",
     "faster", " ", "than", " ", "GaussPointToNodeValue"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8800890429836116`*^9, 3.8800890968402295`*^9}, {
  3.8800893871700773`*^9, 3.8800894387400036`*^9}, {3.8800894987941666`*^9, 
  3.8800895026136246`*^9}, {3.880089583693297*^9, 3.880089605561801*^9}, {
  3.880172088463549*^9, 3.8801720891411715`*^9}, {3.8801721401805263`*^9, 
  3.8801721409226646`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"f03853b6-9f59-4c4c-a396-51fe7b162ba8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanGaussPointToNode", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gpData", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ele", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"node", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dataE", ",", "dataN", ",", "nodeCount", ",", "ei"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"dataE", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Mean", "[", "egp", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"egp", ",", "gpData"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataN", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "node", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodeCount", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "node", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ei", "=", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"dataN", "[", 
             RowBox[{"[", "ei", "]"}], "]"}], "+=", 
            RowBox[{"dataE", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"nodeCount", "[", 
             RowBox[{"[", "ei", "]"}], "]"}], "+=", "1"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataN", "/", "nodeCount"}]}]}], "\[IndentingNewLine]", "]"}],
      ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
     ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8803541549583225`*^9, 3.8803542444553165`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"b8fb3ffb-d523-4628-a81d-507ca55f3178"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eigensystem2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "em", ",", "el", ",", "ev", ",", "a$", ",", "b$", ",", "c$", ",", 
         "em0"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a$", ",", "b$", ",", "c$"}], "}"}], "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
        RowBox[{"em", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a$", "^", "2"}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"b$", "^", "2"}]}], "-", 
           RowBox[{"2", " ", "a$", " ", "c$"}], "+", 
           RowBox[{"c$", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"em0", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"em", "<", 
            RowBox[{"10", "^", 
             RowBox[{"-", "14"}]}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "14"}]}], ",", "em"}], "]"}]}], ";", 
        RowBox[{"el", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.5", " ", 
            RowBox[{"(", 
             RowBox[{"a$", "+", "c$", "-", "em0"}], ")"}]}], ",", 
           RowBox[{"0.5", " ", 
            RowBox[{"(", 
             RowBox[{"a$", "+", "c$", "+", "em0"}], ")"}]}]}], "}"}]}], ";", 
        RowBox[{"ev", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a$", "-", "c$", "-", "em", "+", 
             RowBox[{"10.", "^", 
              RowBox[{"-", "30"}]}]}], ",", 
            RowBox[{"2", " ", "b$"}]}], "}"}], " ", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"10.", "^", 
             RowBox[{"-", "60"}]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"b$", "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a$", "-", "c$", "-", "em"}], ")"}], "^", "2"}]}], 
           "]"}]}]}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"el", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"el", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"ev", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"ev", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"ev", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"ev", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigensystem2v", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real", ",", "1"}], "}"}], 
      RowBox[{"(*", 
       RowBox[{"m11", ",", "m12", ",", "m22"}], "*)"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "em", ",", "el", ",", "ev", ",", "a$", ",", "b$", ",", "c$", ",", 
         "em0"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a$", ",", "b$", ",", "c$"}], "}"}], "=", 
         RowBox[{"Chop", "[", "m", "]"}]}], ";", 
        RowBox[{"em", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a$", "^", "2"}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"b$", "^", "2"}]}], "-", 
           RowBox[{"2", " ", "a$", " ", "c$"}], "+", 
           RowBox[{"c$", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"em0", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"em", "<", 
            RowBox[{"10", "^", 
             RowBox[{"-", "14"}]}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "14"}]}], ",", "em"}], "]"}]}], ";", 
        RowBox[{"el", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.5", " ", 
            RowBox[{"(", 
             RowBox[{"a$", "+", "c$", "-", "em0"}], ")"}]}], ",", 
           RowBox[{"0.5", " ", 
            RowBox[{"(", 
             RowBox[{"a$", "+", "c$", "+", "em0"}], ")"}]}]}], "}"}]}], ";", 
        RowBox[{"ev", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a$", "-", "c$", "-", "em", "+", 
             RowBox[{"10.", "^", 
              RowBox[{"-", "30"}]}]}], ",", 
            RowBox[{"2", " ", "b$"}]}], "}"}], " ", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"10.", "^", 
             RowBox[{"-", "60"}]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"b$", "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a$", "-", "c$", "-", "em"}], ")"}], "^", "2"}]}], 
           "]"}]}]}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"el", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"el", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"ev", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"ev", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"ev", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"ev", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EnergyDensity2Dspectral", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m22", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mat", ",", "_Real", ",", "1"}], 
         RowBox[{"(*", 
          RowBox[{"El", ",", "nu", ",", 
           RowBox[{"type", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0", ":", 
               RowBox[{"plane", " ", "stress"}]}], ",", " ", 
              RowBox[{"1", ":", 
               RowBox[{"plane", " ", "strain"}]}]}], ")"}]}]}], "*)"}], 
         "}"}]}], "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "$l1", " ", ",", "$l2", ",", "$v1", ",", "$v2", ",", "$v3", ",", 
          "$v4", ",", "\[Phi]1", ",", "\[Phi]2", ",", "\[Phi]v", ",", "c1", 
          ",", "c2", ",", 
          RowBox[{"\[Phi]P", "=", "0."}], ",", 
          RowBox[{"\[Phi]N", "=", "0."}], ",", 
          RowBox[{"RK10p", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"{", "10", "}"}]}], "]"}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "f000", ",", "f100", ",", "f010", ",", "f001", ",", "f200", ",", 
              "f110", ",", "f101", ",", "f020", ",", "f011", ",", "f002"}], 
             "}"}], ",", 
            RowBox[{"(", 
             RowBox[{
             "\[CurlyEpsilon]x", ",", "\[CurlyEpsilon]xy", ",", 
              "\[CurlyEpsilon]y"}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\[Phi]", ",", "\[Phi]\[CurlyEpsilon]x", ",", 
              "\[Phi]\[CurlyEpsilon]xy", ",", "\[Phi]\[CurlyEpsilon]y", ",", 
              "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]x", ",", 
              "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]xy", ",", 
              "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]y", ",", 
              "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]xy", ",", 
              "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]y", ",", 
              "\[Phi]\[CurlyEpsilon]y\[CurlyEpsilon]y"}], "}"}]}], "*)"}], 
          ",", 
          RowBox[{"RK10n", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"{", "10", "}"}]}], "]"}]}], ",", "RKtemp"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "$l1", " ", ",", "$l2", ",", "$v1", ",", "$v2", ",", "$v3", ",", 
            "$v4"}], "}"}], "=", 
          RowBox[{"Eigensystem2v", "[", "m22", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mat", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "==", "0."}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c1", ",", "c2"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"mat", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"mat", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mat", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"1", "-", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c1", ",", "c2"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"mat", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", 
                  RowBox[{"mat", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mat", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"1", "-", 
                RowBox[{"2", 
                 RowBox[{"mat", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]v", "=", 
          RowBox[{"c1", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"$l1", "+", "$l2"}], ")"}], "^", "2"}], "/", "2"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]1", "=", 
          RowBox[{"c2", " ", 
           RowBox[{
            RowBox[{"$l1", "^", "2"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Phi]2", "=", 
          RowBox[{"c2", " ", 
           RowBox[{
            RowBox[{"$l2", "^", "2"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RKtemp", "=", 
          RowBox[{"c1", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"$l1", "+", "$l2"}], ")"}], "^", "2"}], "/", "2"}], 
             ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v3", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v3", "*", "$v4"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v3", "^", "2"}]}], ")"}], "^", "2"}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v3", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v3", "*", "$v4"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v3", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"4", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v1", "*", "$v2"}], "+", 
                 RowBox[{"$v3", "*", "$v4"}]}], ")"}], "^", "2"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v3", "*", "$v4"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}]}], ")"}], "^", "2"}]}], "}"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"$l1", "+", "$l2"}], ">", "0."}], ",", 
           RowBox[{
            RowBox[{"RK10p", "+=", "RKtemp"}], ";"}], ",", 
           RowBox[{"RK10n", "+=", "RKtemp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RKtemp", "=", 
          RowBox[{"c2", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"$l1", "^", "2"}], "/", "2"}], ",", 
             RowBox[{"$l1", "*", 
              RowBox[{"$v1", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l1", "*", "$v1", "*", "$v2"}], ",", 
             RowBox[{"$l1", "*", 
              RowBox[{"$v2", "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"$v1", "^", "4"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l1", "*", 
                 RowBox[{"$v1", "^", "2"}], "*", 
                 RowBox[{"$v3", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"$l1", "-", "$l2"}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v1", "^", "3"}], "*", "$v2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l1", "*", "$v1", "*", "$v3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v2", "*", "$v3"}], "+", 
                   RowBox[{"$v1", "*", "$v4"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"$l1", "-", "$l2"}], ")"}]}]}], ",", 
             RowBox[{"$v1", "*", "$v2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "*", "$l1", "*", "$v3", "*", "$v4"}], ")"}], 
                 "/", 
                 RowBox[{"(", 
                  RowBox[{"$l1", "-", "$l2"}], ")"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], "*", "$l2", "*", 
                 RowBox[{"$v1", "^", "2"}], "*", 
                 RowBox[{"$v2", "^", "2"}]}], "+", 
                RowBox[{"2", "*", "$l1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", 
                    RowBox[{"$v3", "^", "2"}]}], "+", 
                   RowBox[{
                   "2", "*", "$v1", "*", "$v2", "*", "$v3", "*", "$v4"}], "+", 
                   RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"$v2", "^", "2"}]}], "+", 
                    RowBox[{"$v4", "^", "2"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{"$l1", "-", "$l2"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], "*", "$l2", "*", "$v1", "*", 
                 RowBox[{"$v2", "^", "3"}]}], "+", 
                RowBox[{"2", "*", "$l1", "*", "$v2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v2", "*", "$v3", "*", "$v4"}], "+", 
                   RowBox[{"$v1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v2", "^", "2"}], "+", 
                    RowBox[{"$v4", "^", "2"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{"$l1", "-", "$l2"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"$v2", "^", "4"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l1", "*", 
                 RowBox[{"$v2", "^", "2"}], "*", 
                 RowBox[{"$v4", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"$l1", "-", "$l2"}], ")"}]}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$l1", ">", "0."}], ",", 
           RowBox[{
            RowBox[{"RK10p", "+=", "RKtemp"}], ";"}], ",", 
           RowBox[{"RK10n", "+=", "RKtemp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RKtemp", "=", 
          RowBox[{"c2", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"$l2", "^", "2"}], "/", "2"}], ",", 
             RowBox[{"$l2", "*", 
              RowBox[{"$v3", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l2", "*", "$v3", "*", "$v4"}], ",", 
             RowBox[{"$l2", "*", 
              RowBox[{"$v4", "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"$v1", "^", "2"}], "*", 
                 RowBox[{"$v3", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
              RowBox[{"$v3", "^", "4"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v3", "^", "3"}], "*", "$v4"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l2", "*", "$v1", "*", "$v3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v2", "*", "$v3"}], "+", 
                   RowBox[{"$v1", "*", "$v4"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}]}], ",", 
             RowBox[{"$v3", "*", "$v4", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "*", "$l2", "*", "$v1", "*", "$v2"}], ")"}], 
                 "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                RowBox[{"$v3", "*", "$v4"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", "*", "$l1", "*", 
                 RowBox[{"$v3", "^", "2"}], "*", 
                 RowBox[{"$v4", "^", "2"}]}], "-", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", 
                    RowBox[{"$v3", "^", "2"}]}], "+", 
                   RowBox[{
                   "2", "*", "$v1", "*", "$v2", "*", "$v3", "*", "$v4"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v1", "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"$v3", "^", "2"}]}]}], ")"}], "*", 
                    RowBox[{"$v4", "^", "2"}]}]}], ")"}]}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"$l1", "-", "$l2"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], "*", "$l1", "*", "$v3", "*", 
                 RowBox[{"$v4", "^", "3"}]}], "+", 
                RowBox[{"2", "*", "$l2", "*", "$v4", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", "$v3"}], "+", 
                   RowBox[{"$v1", "*", "$v2", "*", "$v4"}], "+", 
                   RowBox[{"$v3", "*", 
                    RowBox[{"$v4", "^", "2"}]}]}], ")"}]}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"$v2", "^", "2"}], "*", 
                 RowBox[{"$v4", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
              RowBox[{"$v4", "^", "4"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$l2", ">", "0."}], ",", 
           RowBox[{
            RowBox[{"RK10p", "+=", "RKtemp"}], ";"}], ",", 
           RowBox[{"RK10n", "+=", "RKtemp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"RK10p", ",", "RK10n"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}], ",", 
      RowBox[{"CompilationOptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
         RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
      ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnergyDensity2D", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m22", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], 
        RowBox[{"(*", 
         RowBox[{"El", ",", "nu", ",", 
          RowBox[{"type", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0", ":", 
              RowBox[{"plane", " ", "stress"}]}], ",", " ", 
             RowBox[{"1", ":", 
              RowBox[{"plane", " ", "strain"}]}]}], ")"}]}]}], "*)"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "c1", ",", "c2", ",", "\[CurlyEpsilon]1", ",", "\[CurlyEpsilon]2", 
         ",", "\[CurlyEpsilon]3", ",", 
         RowBox[{"RK10p", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", "10", "}"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "f000", ",", "f100", ",", "f010", ",", "f001", ",", "f200", ",", 
             "f110", ",", "f101", ",", "f020", ",", "f011", ",", "f002"}], 
            "}"}], ",", 
           RowBox[{"(", 
            RowBox[{
            "\[CurlyEpsilon]x", ",", "\[CurlyEpsilon]xy", ",", 
             "\[CurlyEpsilon]y"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\[Phi]", ",", "\[Phi]\[CurlyEpsilon]x", ",", 
             "\[Phi]\[CurlyEpsilon]xy", ",", "\[Phi]\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]x", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]xy", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]xy", ",", 
             "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]y\[CurlyEpsilon]y"}], "}"}]}], "*)"}], ",", 
         RowBox[{"RK10n", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", "10", "}"}]}], "]"}]}], ",", 
         RowBox[{"El", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"v", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "c3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", "0."}], ",", 
          RowBox[{"c3", "=", 
           RowBox[{
            RowBox[{"mat", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{"mat", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], ",", 
          RowBox[{"c3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"mat", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"mat", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CurlyEpsilon]1", ",", "\[CurlyEpsilon]2", ",", 
           "\[CurlyEpsilon]3"}], "}"}], "=", "m22"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", "0"}], ",", 
          RowBox[{"RK10p", "=", 
           RowBox[{"c3", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[CurlyEpsilon]1", "2"], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "v"}], ")"}], " ", 
                  SuperscriptBox["\[CurlyEpsilon]2", "2"]}], "+", 
                 RowBox[{
                 "2", " ", "v", " ", "\[CurlyEpsilon]1", " ", 
                  "\[CurlyEpsilon]3"}], "+", 
                 SuperscriptBox["\[CurlyEpsilon]3", "2"]}], ")"}]}], ",", 
              RowBox[{"\[CurlyEpsilon]1", "+", 
               RowBox[{"v", " ", "\[CurlyEpsilon]3"}]}], ",", 
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "v"}], ")"}], " ", 
               "\[CurlyEpsilon]2"}], ",", 
              RowBox[{
               RowBox[{"v", " ", "\[CurlyEpsilon]1"}], "+", 
               "\[CurlyEpsilon]3"}], ",", "1", ",", "0", ",", "v", ",", 
              RowBox[{"2", "-", 
               RowBox[{"2", " ", "v"}]}], ",", "0", ",", "1"}], "}"}]}]}], 
          ",", 
          RowBox[{"RK10p", "=", 
           RowBox[{"c3", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "v"}], ")"}], " ", 
                    SuperscriptBox["\[CurlyEpsilon]1", "2"]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"2", "-", 
                    RowBox[{"4", " ", "v"}]}], ")"}], " ", 
                  SuperscriptBox["\[CurlyEpsilon]2", "2"]}], "+", 
                 RowBox[{
                 "2", " ", "v", " ", "\[CurlyEpsilon]1", " ", 
                  "\[CurlyEpsilon]3"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "v"}], ")"}], " ", 
                  SuperscriptBox["\[CurlyEpsilon]3", "2"]}]}], ")"}]}], ",", 
              RowBox[{"\[CurlyEpsilon]1", "-", 
               RowBox[{"v", " ", "\[CurlyEpsilon]1"}], "+", 
               RowBox[{"v", " ", "\[CurlyEpsilon]3"}]}], ",", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "v"}]}], ")"}], " ", "\[CurlyEpsilon]2"}], 
              ",", 
              RowBox[{
               RowBox[{"v", " ", 
                RowBox[{"(", 
                 RowBox[{"\[CurlyEpsilon]1", "-", "\[CurlyEpsilon]3"}], 
                 ")"}]}], "+", "\[CurlyEpsilon]3"}], ",", 
              RowBox[{"1", "-", "v"}], ",", "0", ",", "v", ",", 
              RowBox[{"2", "-", 
               RowBox[{"4", " ", "v"}]}], ",", "0", ",", 
              RowBox[{"1", "-", "v"}]}], "}"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"RK10p", ",", "RK10n"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
     ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnergyDensity3Dvoldev", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m22", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], 
        RowBox[{"(*", 
         RowBox[{"El", ",", "nu", ",", 
          RowBox[{"type", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0", ":", 
              RowBox[{"plane", " ", "stress"}]}], ",", " ", 
             RowBox[{"1", ":", 
              RowBox[{"plane", " ", "strain"}]}]}], ")"}]}]}], "*)"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "c1", ",", "c2", ",", "\[CurlyEpsilon]1", ",", "\[CurlyEpsilon]2", 
         ",", "\[CurlyEpsilon]3", ",", "\[CurlyEpsilon]4", ",", 
         "\[CurlyEpsilon]5", ",", "\[CurlyEpsilon]6", ",", 
         RowBox[{"RK10p", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", "28", "}"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "f000", ",", "f100", ",", "f010", ",", "f001", ",", "f200", ",", 
             "f110", ",", "f101", ",", "f020", ",", "f011", ",", "f002"}], 
            "}"}], ",", 
           RowBox[{"(", 
            RowBox[{
            "\[CurlyEpsilon]x", ",", "\[CurlyEpsilon]xy", ",", 
             "\[CurlyEpsilon]y"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\[Phi]", ",", "\[Phi]\[CurlyEpsilon]x", ",", 
             "\[Phi]\[CurlyEpsilon]xy", ",", "\[Phi]\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]x", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]xy", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]xy", ",", 
             "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]y\[CurlyEpsilon]y"}], "}"}]}], "*)"}], ",", 
         RowBox[{"RK10n", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", "28", "}"}]}], "]"}]}], ",", "RKtemp"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c1", ",", "c2"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mat", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "3"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", 
               RowBox[{"mat", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"mat", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"mat", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CurlyEpsilon]1", ",", "\[CurlyEpsilon]2", ",", 
           "\[CurlyEpsilon]3", ",", "\[CurlyEpsilon]4", ",", 
           "\[CurlyEpsilon]5", ",", "\[CurlyEpsilon]6"}], "}"}], "=", "m22"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"RK10n", "=", 
         RowBox[{"c1", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "6"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
               "\[CurlyEpsilon]1", "+", "\[CurlyEpsilon]4", "+", 
                "\[CurlyEpsilon]6"}], ")"}], "2"]}], ",", 
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
              "\[CurlyEpsilon]1", "+", "\[CurlyEpsilon]4", "+", 
               "\[CurlyEpsilon]6"}], ")"}]}], ",", "0", ",", "0", ",", 
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
              "\[CurlyEpsilon]1", "+", "\[CurlyEpsilon]4", "+", 
               "\[CurlyEpsilon]6"}], ")"}]}], ",", "0", ",", 
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
              "\[CurlyEpsilon]1", "+", "\[CurlyEpsilon]4", "+", 
               "\[CurlyEpsilon]6"}], ")"}]}], ",", 
            FractionBox["1", "3"], ",", "0", ",", "0", ",", 
            FractionBox["1", "3"], ",", "0", ",", 
            FractionBox["1", "3"], ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            FractionBox["1", "3"], ",", "0", ",", 
            FractionBox["1", "3"], ",", "0", ",", "0", ",", 
            FractionBox["1", "3"]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RK10p", "=", 
         RowBox[{"c2", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[CurlyEpsilon]1", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[CurlyEpsilon]2", "2"]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[CurlyEpsilon]3", "2"]}], "+", 
               SuperscriptBox["\[CurlyEpsilon]4", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[CurlyEpsilon]5", "2"]}], "-", 
               RowBox[{"\[CurlyEpsilon]4", " ", "\[CurlyEpsilon]6"}], "+", 
               SuperscriptBox["\[CurlyEpsilon]6", "2"], "-", 
               RowBox[{"\[CurlyEpsilon]1", " ", 
                RowBox[{"(", 
                 RowBox[{"\[CurlyEpsilon]4", "+", "\[CurlyEpsilon]6"}], 
                 ")"}]}]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[CurlyEpsilon]1"}], "-", 
               "\[CurlyEpsilon]4", "-", "\[CurlyEpsilon]6"}], ")"}]}], ",", 
            RowBox[{"2", " ", "\[CurlyEpsilon]2"}], ",", 
            RowBox[{"2", " ", "\[CurlyEpsilon]3"}], ",", 
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "\[CurlyEpsilon]1"}], "+", 
               RowBox[{"2", " ", "\[CurlyEpsilon]4"}], "-", 
               "\[CurlyEpsilon]6"}], ")"}]}], ",", 
            RowBox[{"2", " ", "\[CurlyEpsilon]5"}], ",", 
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "\[CurlyEpsilon]1"}], "-", "\[CurlyEpsilon]4", 
               "+", 
               RowBox[{"2", " ", "\[CurlyEpsilon]6"}]}], ")"}]}], ",", 
            FractionBox["2", "3"], ",", "0", ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", "3"]}], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", "3"]}], ",", "2", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "2", ",", "0", ",", "0", ",", "0", ",", 
            FractionBox["2", "3"], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", "3"]}], ",", "2", ",", "0", ",", 
            FractionBox["2", "3"]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "\[CurlyEpsilon]1", "+", "\[CurlyEpsilon]4", "+", 
             "\[CurlyEpsilon]6"}], ")"}], ">", "0."}], ",", 
          RowBox[{
           RowBox[{"RK10p", "+=", "RK10n"}], ";", 
           RowBox[{
            RowBox[{"RK10n", "[", 
             RowBox[{"[", "All", "]"}], "]"}], "=", "0."}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"RK10p", ",", "RK10n"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
     ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnergyDensity3D", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m22", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], 
        RowBox[{"(*", 
         RowBox[{"El", ",", "nu", ",", 
          RowBox[{"type", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0", ":", 
              RowBox[{"plane", " ", "stress"}]}], ",", " ", 
             RowBox[{"1", ":", 
              RowBox[{"plane", " ", "strain"}]}]}], ")"}]}]}], "*)"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "c1", ",", "c2", ",", "\[CurlyEpsilon]1", ",", "\[CurlyEpsilon]2", 
         ",", "\[CurlyEpsilon]3", ",", "\[CurlyEpsilon]4", ",", 
         "\[CurlyEpsilon]5", ",", "\[CurlyEpsilon]6", ",", 
         RowBox[{"RK10p", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", "28", "}"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "f000", ",", "f100", ",", "f010", ",", "f001", ",", "f200", ",", 
             "f110", ",", "f101", ",", "f020", ",", "f011", ",", "f002"}], 
            "}"}], ",", 
           RowBox[{"(", 
            RowBox[{
            "\[CurlyEpsilon]x", ",", "\[CurlyEpsilon]xy", ",", 
             "\[CurlyEpsilon]y"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\[Phi]", ",", "\[Phi]\[CurlyEpsilon]x", ",", 
             "\[Phi]\[CurlyEpsilon]xy", ",", "\[Phi]\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]x", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]xy", ",", 
             "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]xy", ",", 
             "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]y", ",", 
             "\[Phi]\[CurlyEpsilon]y\[CurlyEpsilon]y"}], "}"}]}], "*)"}], ",", 
         RowBox[{"RK10n", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", "28", "}"}]}], "]"}]}], ",", "RKtemp", ",", 
         RowBox[{"El", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"v", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c1", ",", "c2"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mat", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "3"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", 
               RowBox[{"mat", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"mat", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"mat", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c1", "=", 
         FractionBox["El", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "v"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "v"}], ")"}]}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CurlyEpsilon]1", ",", "\[CurlyEpsilon]2", ",", 
           "\[CurlyEpsilon]3", ",", "\[CurlyEpsilon]4", ",", 
           "\[CurlyEpsilon]5", ",", "\[CurlyEpsilon]6"}], "}"}], "=", "m22"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"RK10n", "=", 
         RowBox[{"c1", 
          RowBox[{"{", 
           RowBox[{"0.", ",", 
            RowBox[{"\[CurlyEpsilon]1", "-", 
             RowBox[{"v", " ", "\[CurlyEpsilon]1"}], "+", 
             RowBox[{"v", " ", 
              RowBox[{"(", 
               RowBox[{"\[CurlyEpsilon]4", "+", "\[CurlyEpsilon]6"}], 
               ")"}]}]}], ",", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "v"}]}], ")"}], " ", "\[CurlyEpsilon]2"}], 
            ",", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "v"}]}], ")"}], " ", "\[CurlyEpsilon]3"}], 
            ",", 
            RowBox[{"\[CurlyEpsilon]4", "+", 
             RowBox[{"v", " ", 
              RowBox[{"(", 
               RowBox[{
               "\[CurlyEpsilon]1", "-", "\[CurlyEpsilon]4", "+", 
                "\[CurlyEpsilon]6"}], ")"}]}]}], ",", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "v"}]}], ")"}], " ", "\[CurlyEpsilon]5"}], 
            ",", 
            RowBox[{
             RowBox[{"v", " ", 
              RowBox[{"(", 
               RowBox[{
               "\[CurlyEpsilon]1", "+", "\[CurlyEpsilon]4", "-", 
                "\[CurlyEpsilon]6"}], ")"}]}], "+", "\[CurlyEpsilon]6"}], ",", 
            RowBox[{"1", "-", "v"}], ",", "0", ",", "0", ",", "v", ",", "0", 
            ",", "v", ",", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "v"}]}], ",", "0", ",", "0", ",", "0", ",", 
            "0", ",", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "v"}]}], ",", "0", ",", "0", ",", "0", ",", 
            RowBox[{"1", "-", "v"}], ",", "0", ",", "v", ",", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "v"}]}], ",", "0", ",", 
            RowBox[{"1", "-", "v"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"RK10p", ",", "RK10n"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
     ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8800143169984455`*^9, 3.8800143174081273`*^9}, {
   3.8800841799622107`*^9, 3.880084189236429*^9}, {3.880084245040925*^9, 
   3.8800842465059423`*^9}, {3.8800848011256914`*^9, 
   3.8800848056355553`*^9}, {3.8800849287850256`*^9, 3.8800849936033397`*^9}, 
   3.8800864204948425`*^9, 3.8801739783586397`*^9, {3.8806462366770515`*^9, 
   3.8806462519010553`*^9}, {3.880646398167768*^9, 3.880646402245034*^9}, {
   3.8806464465546923`*^9, 3.880646446847096*^9}, {3.880646534792327*^9, 
   3.880646552559252*^9}, {3.8806465920055485`*^9, 3.880646595944976*^9}, {
   3.8806466376904955`*^9, 3.8806466415237465`*^9}, {3.880646681014005*^9, 
   3.8806467672462063`*^9}, {3.8806468083025293`*^9, 
   3.8806468877880325`*^9}, {3.8806469547688065`*^9, 
   3.8806469555220003`*^9}, {3.8806472015858707`*^9, 
   3.8806472329739323`*^9}, {3.880647333688755*^9, 3.880647355605487*^9}, {
   3.8806475680885344`*^9, 3.8806475733268404`*^9}, {3.8806476525576515`*^9, 
   3.8806476529417486`*^9}, {3.8806476986005125`*^9, 
   3.8806477286677876`*^9}, {3.8806477723940063`*^9, 3.880647833983237*^9}, {
   3.880647896120075*^9, 3.8806479197233915`*^9}, {3.8821144794507103`*^9, 
   3.8821144924883165`*^9}, {3.8821157629535236`*^9, 3.882115790862626*^9}, {
   3.8821158545132475`*^9, 3.8821158590333967`*^9}, {3.8821159202151175`*^9, 
   3.882115940099365*^9}, {3.88211597914879*^9, 3.882115990723879*^9}, {
   3.8821160377572565`*^9, 3.88211614334273*^9}, {3.8949623423655806`*^9, 
   3.894962370611446*^9}, {3.894962608964071*^9, 3.8949626284922595`*^9}, 
   3.8949626637179184`*^9, 3.897445162422192*^9, {3.899345788954257*^9, 
   3.8993457924072905`*^9}, {3.8993458285888395`*^9, 3.89934591721054*^9}, {
   3.899346038903384*^9, 3.8993461179550624`*^9}, 3.8993461653846436`*^9, {
   3.8993469932597604`*^9, 3.899347021207229*^9}, {3.934368037936217*^9, 
   3.934368073451429*^9}, {3.934369664047531*^9, 3.934369665603055*^9}, {
   3.934371256117031*^9, 
   3.9343712662140374`*^9}},ExpressionUUID->"dbbacb9f-1470-473b-89f4-\
028376bf3f29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["EnergyDensity2DspectralDecomposition", "Subsection",
 CellChangeTimes->{{3.8945131648120737`*^9, 3.8945131849502773`*^9}, {
  3.9343697018394337`*^9, 
  3.93436970213588*^9}},ExpressionUUID->"5d92b0c8-6dcc-4271-ae49-\
00520ab7b4e6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894510274088174*^9, 3.894510274640793*^9}, {
   3.8945127930662255`*^9, 3.8945128076865683`*^9}, {3.894513044579427*^9, 
   3.894513090869995*^9}, {3.8945131223845806`*^9, 3.894513130053933*^9}, {
   3.894513536527068*^9, 3.894513552399829*^9}, 3.8949606611146927`*^9, {
   3.894960695806379*^9, 3.8949606982018037`*^9}, {3.8950228820627527`*^9, 
   3.8950232033334126`*^9}, {3.8950232508374166`*^9, 3.8950233007787714`*^9}, 
   3.895023331980466*^9, {3.8950305437006044`*^9, 3.895030543974643*^9}, {
   3.89503059696774*^9, 3.8950305986546946`*^9}, {3.8950310751791797`*^9, 
   3.895031080020172*^9}, {3.895031154585758*^9, 3.8950311691136446`*^9}, {
   3.8950312371897273`*^9, 3.8950313271112747`*^9}, 3.8950313609672966`*^9, {
   3.895031481330389*^9, 3.895031543674314*^9}, {3.8950443104566307`*^9, 
   3.895044341517045*^9}, {3.895044684619294*^9, 3.895044697083652*^9}, {
   3.895044730558459*^9, 3.8950447954410458`*^9}, 3.895044881402875*^9, {
   3.895044929300138*^9, 3.895044946549324*^9}, {3.895111349262003*^9, 
   3.895111353209042*^9}, 3.8951117596423645`*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"7ab2d612-46c6-4c71-83a2-aeea2e450362"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Eigensystem3Dv", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"m$", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "a$", ",", "b$", ",", "c$", ",", "d$", ",", "e$", ",", "f$", ",", 
         "dn$", ",", "dd$", ",", "cc$", ",", "bb$", ",", "d1$", ",", "d$1", 
         ",", "C$", ",", "r$$0", ",", 
         RowBox[{"nx$", "=", "1"}], ",", 
         RowBox[{"x1$", "=", "0."}], ",", 
         RowBox[{"x2$", "=", "0."}], ",", 
         RowBox[{"x3$", "=", "0."}], ",", "v1$", ",", "v2$", ",", "v3$", ",", 
         RowBox[{"tol$", "=", 
          RowBox[{"10.", "^", 
           RowBox[{"-", "24"}]}]}], ",", 
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", "m$", "]"}]}], ",", 
         RowBox[{"maxx", "=", "0."}], ",", "dx", ",", "dy", ",", "ixyz", ",", 
         "xyz", ",", "v123", ",", 
         RowBox[{"told", "=", 
          RowBox[{"10.", "^", 
           RowBox[{"-", "14"}]}]}], ",", 
         RowBox[{"tol2", "=", "0."}], ",", 
         RowBox[{"mmax", "=", "0."}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"tol2", "=", 
         RowBox[{"told", "^", "2"}]}], ";", 
        RowBox[{"mmax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"m$", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"m$", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"m$", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"m$", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"m$", "[", 
               RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"m$", "[", 
               RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mmax", "=", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"mmax", "+", "tol2"}], ")"}]}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "a$", ",", "b$", ",", "c$", ",", "d$", ",", "e$", ",", "f$"}], 
          "}"}], "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"m$", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "mmax"}], ",", 
            RowBox[{
             RowBox[{"m$", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "mmax"}], ",", 
            RowBox[{
             RowBox[{"m$", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "mmax"}], ",", 
            RowBox[{
             RowBox[{"m$", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "mmax"}], ",", 
            RowBox[{
             RowBox[{"m$", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "mmax"}], ",", 
            RowBox[{
             RowBox[{"m$", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "mmax"}]}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"dn$", "=", 
         RowBox[{
          RowBox[{"b$", " ", "b$"}], "+", 
          RowBox[{"c$", " ", "c$"}], "+", 
          RowBox[{"e$", " ", "e$"}]}]}], ";", 
        RowBox[{"(*", "p1", "*)"}], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1$", ",", "v2$", ",", "v3$"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1.", ",", "0.", ",", "0."}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "1.", ",", "0."}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dn$", "<", "tol2"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1$", ",", "x2$", ",", "x3$"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{"a$", ",", "d$", ",", "f$"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nx$", "=", "1"}]}], ",", 
          RowBox[{
           RowBox[{"dd$", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a$", "+", "d$", "+", "f$"}], ")"}], "/", "3."}]}], ";", 
           RowBox[{"(*", "q", "*)"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"cc$", "=", 
              RowBox[{
               RowBox[{"a$", " ", "a$"}], "+", 
               RowBox[{"d$", " ", "d$"}], "+", 
               RowBox[{"f$", " ", "f$"}], "-", 
               RowBox[{"3", " ", "dd$", " ", "dd$"}], "+", 
               RowBox[{"2", " ", "dn$"}]}]}], ";", 
             RowBox[{
              RowBox[{
               RowBox[{"There", " ", "is", " ", "a", " ", 
                RowBox[{"bug", ".", " ", "Remember"}], " ", "there", " ", 
                "is", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"a$", "-", "d$"}], ")"}], "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"a$", "-", "f$"}], ")"}], "^", "2"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d$", "-", "f$"}], ")"}], "^", "2"}]}], "==", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", "a$", " ", "a$"}], "+", 
                RowBox[{"3", "d$", " ", "d$"}], "+", 
                RowBox[{"3", "f$", " ", "f$"}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"a$", "+", "d$", "+", "f$"}], ")"}], "^", "2"}]}], 
               ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"cc$", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "3"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"a$", "-", "d$"}], ")"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"a$", "-", "f$"}], ")"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d$", "-", "f$"}], ")"}], "^", "2"}]}], 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"3", "a$", " ", "a$"}], "+", 
                 RowBox[{"3", "d$", " ", "d$"}], "+", 
                 RowBox[{"3", "f$", " ", "f$"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a$", "+", "d$", "+", "f$"}], ")"}], "^", "2"}]}], 
                "*)"}], ")"}]}], " ", "+", 
             RowBox[{"2", " ", "dn$"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", "p2", "*)"}], 
           RowBox[{"bb$", "=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"cc$", "/", "6"}], "]"}]}], ";", 
           RowBox[{"(*", "p", "*)"}], 
           RowBox[{"d1$", "=", 
            RowBox[{
             RowBox[{"a$", " ", "d$", " ", "f$"}], "+", 
             RowBox[{"2", " ", "b$", " ", "e$", " ", "c$"}], "-", 
             RowBox[{"a$", " ", "e$", " ", "e$"}], "-", 
             RowBox[{"d$", " ", "c$", " ", "c$"}], "-", 
             RowBox[{"f$", " ", "b$", " ", "b$"}]}]}], ";", 
           RowBox[{"(*", "detA", "*)"}], 
           RowBox[{"d$1", "=", 
            RowBox[{"0.5", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d1$", "+", 
                RowBox[{"dd$", " ", "dn$"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"dd$", "^", "3"}]}], "-", 
                RowBox[{"dd$", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"a$", " ", "d$"}], "+", 
                   RowBox[{"a$", " ", "f$"}], "+", 
                   RowBox[{"d$", " ", "f$"}]}], ")"}]}]}], ")"}], "/", 
              RowBox[{"bb$", "^", "3"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "d$1", "]"}], "\[GreaterEqual]", "1."}], 
             ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"d$1", "\[LessEqual]", 
                 RowBox[{"-", "1."}]}], ",", 
                RowBox[{
                 RowBox[{"nx$", "=", "2"}], ";", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x1$", ",", "x3$"}], "}"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"dd$", "+", "bb$"}], ",", 
                    RowBox[{"dd$", "-", 
                    RowBox[{"2", " ", "bb$"}]}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"x2$", "=", "x1$"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"d$1", "\[GreaterEqual]", "1."}], ",", 
                RowBox[{
                 RowBox[{"nx$", "=", "2"}], ";", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x1$", ",", "x3$"}], "}"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"dd$", "-", "bb$"}], ",", 
                    RowBox[{"dd$", "+", 
                    RowBox[{"2", " ", "bb$"}]}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"x2$", "=", "x1$"}]}]}], "]"}], ";"}], ",", 
             RowBox[{
              RowBox[{"C$", "=", 
               RowBox[{
                RowBox[{"ArcCos", "[", "d$1", "]"}], "/", "3."}]}], ";", 
              RowBox[{"nx$", "=", "3"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1$", ",", "x2$"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"dd$", "+", 
                  RowBox[{"2", " ", "bb$", " ", 
                   RowBox[{"Cos", "[", "C$", "]"}]}]}], ",", 
                 RowBox[{"dd$", "+", 
                  RowBox[{"2", " ", "bb$", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"C$", "+", 
                    RowBox[{"2.", " ", 
                    RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}]}]}]}], "}"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"x3$", "=", 
               RowBox[{
                RowBox[{"3", " ", "dd$"}], "-", "x1$", "-", "x2$"}]}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nx$", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"v3$", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"e$", "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d$", "-", "x3$"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"f$", "-", "x3$"}], ")"}]}]}], ",", 
              RowBox[{
               RowBox[{"c$", " ", "e$"}], "+", 
               RowBox[{"b$", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "f$"}], "+", "x3$"}], ")"}]}]}], ",", 
              RowBox[{
               RowBox[{"b$", " ", "e$"}], "+", 
               RowBox[{"c$", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "d$"}], "+", "x3$"}], ")"}]}]}]}], "}"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"r$$0", "=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"v3$", ".", "v3$"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"r$$0", "<", "tol2"}], ",", 
             RowBox[{"v3$", "=", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], ",", 
             RowBox[{"v3$", "*=", 
              RowBox[{"1.", "/", "r$$0"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v2$", "=", 
            RowBox[{"v3$", "+", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"1.", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"v2$", "-=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"v3$", ".", "v2$"}], ")"}], " ", "v3$"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v2$", "*=", 
            RowBox[{"1.", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"v2$", ".", "v2$"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v1$", "=", 
            RowBox[{"Cross", "[", 
             RowBox[{"v2$", ",", "v3$"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nx$", "\[Equal]", "3"}], ",", 
          RowBox[{
           RowBox[{"v1$", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"e$", "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d$", "-", "x1$"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"f$", "-", "x1$"}], ")"}]}]}], ",", 
              RowBox[{
               RowBox[{"c$", " ", "e$"}], "+", 
               RowBox[{"b$", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "f$"}], "+", "x1$"}], ")"}]}]}], ",", 
              RowBox[{
               RowBox[{"b$", " ", "e$"}], "+", 
               RowBox[{"c$", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "d$"}], "+", "x1$"}], ")"}]}]}]}], "}"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"r$$0", "=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"v1$", ".", "v1$"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"r$$0", "<", "tol2"}], ",", 
             RowBox[{"v1$", "=", 
              RowBox[{"{", 
               RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], ",", 
             RowBox[{"v1$", "*=", 
              RowBox[{"1.", "/", "r$$0"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v2$", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"e$", "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d$", "-", "x2$"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"f$", "-", "x2$"}], ")"}]}]}], ",", 
              RowBox[{
               RowBox[{"c$", " ", "e$"}], "+", 
               RowBox[{"b$", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "f$"}], "+", "x2$"}], ")"}]}]}], ",", 
              RowBox[{
               RowBox[{"b$", " ", "e$"}], "+", 
               RowBox[{"c$", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "d$"}], "+", "x2$"}], ")"}]}]}]}], "}"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"r$$0", "=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"v2$", ".", "v2$"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"r$$0", "<", "tol2"}], ",", 
             RowBox[{"v2$", "=", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], ",", 
             RowBox[{"v2$", "*=", 
              RowBox[{"1.", "/", "r$$0"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v2$", "*=", 
            RowBox[{"1.", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"v2$", ".", "v2$"}], "]"}]}]}], ";", 
           RowBox[{"v3$", "=", 
            RowBox[{"Cross", "[", 
             RowBox[{"v1$", ",", "v2$"}], "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Make", " ", "the", " ", "eigenvalue", " ", "distinct"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"xyz", "=", 
         RowBox[{"{", 
          RowBox[{"x1$", ",", "x2$", ",", "x3$"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"v123", "=", 
         RowBox[{"{", 
          RowBox[{"v1$", ",", "v2$", ",", "v3$"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ixyz", "=", 
         RowBox[{"Ordering", "[", "xyz", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xyz", "=", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "ixyz", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"v123", "=", 
           RowBox[{"v123", "[", 
            RowBox[{"[", "ixyz", "]"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"x1$", "=", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"x2$", "=", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"x3$", "=", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v1$", "=", 
         RowBox[{"v123", "[", 
          RowBox[{"[", 
           RowBox[{"ixyz", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"v2$", "=", 
         RowBox[{"v123", "[", 
          RowBox[{"[", 
           RowBox[{"ixyz", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"v3$", "=", 
         RowBox[{"v123", "[", 
          RowBox[{"[", 
           RowBox[{"ixyz", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"maxx", "=", 
         RowBox[{"1.", "/", 
          RowBox[{"(", 
           RowBox[{"told", "+", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Abs", "[", "x1$", "]"}], ",", 
              RowBox[{"Abs", "[", "x3$", "]"}]}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2$", "-", "x1$"}], ")"}], "maxx"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dy", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x3$", "-", "x2$"}], ")"}], "maxx"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"told", "=", 
           RowBox[{"told", "/", "maxx"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dx", "<", "told"}], " ", "&&", " ", 
           RowBox[{"dy", ">", "told"}]}], ",", 
          RowBox[{"x1$", "-=", "told"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dy", "<", "told"}], " ", "&&", " ", 
           RowBox[{"dx", ">", "told"}]}], ",", 
          RowBox[{"x3$", "+=", "told"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dx", "<", "told"}], " ", "&&", " ", 
           RowBox[{"dy", "<", "told"}]}], ",", 
          RowBox[{
           RowBox[{"x1$", "-=", "told"}], ";", 
           RowBox[{"x3$", "+=", "told"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1$", "/", "mmax"}], ",", 
          RowBox[{"x2$", "/", "mmax"}], ",", 
          RowBox[{"x3$", "/", "mmax"}], ",", 
          RowBox[{"v1$", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"v1$", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"v1$", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"v2$", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"v2$", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"v2$", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"v3$", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"v3$", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"v3$", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"ace4e6b4-89fa-410b-a146-2063f21bf45d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"return", " ", "RK10p"}], "=", 
     RowBox[{"(", 
      RowBox[{"\[Phi]\:207a", ",", "\[Sigma]\:207a", ",", 
       RowBox[{"d\[Sigma]\:207a", "/", "d\[CurlyEpsilon]"}]}], ")"}]}], ",", 
    " ", 
    RowBox[{"RK10n", "=", 
     RowBox[{"(", 
      RowBox[{"\[Phi]\:207b", ",", "\[Sigma]\:207b", ",", 
       RowBox[{"d\[Sigma]\:207b", "/", "d\[CurlyEpsilon]"}]}], ")"}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"EnergyDensity3Dspectral", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m22", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mat", ",", "_Real", ",", "1"}], 
         RowBox[{"(*", 
          RowBox[{"El", ",", "nu", ",", 
           RowBox[{"type", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0", ":", 
               RowBox[{"plane", " ", "stress"}]}], ",", " ", 
              RowBox[{"1", ":", 
               RowBox[{"plane", " ", "strain"}]}]}], ")"}]}]}], "*)"}], 
         "}"}]}], "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "$l1", " ", ",", "$l2", ",", "$l3", ",", "$v1", ",", "$v2", ",", 
          "$v3", ",", "$v4", ",", "$v5", ",", "$v6", ",", "$v7", ",", "$v8", 
          ",", "$v9", ",", "\[Phi]1", ",", "\[Phi]2", ",", "\[Phi]3", ",", 
          "\[Phi]v", ",", "c1", ",", "c2", ",", 
          RowBox[{"\[Phi]P", "=", "0."}], ",", 
          RowBox[{"\[Phi]N", "=", "0."}], ",", 
          RowBox[{"RK10p", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"{", "28", "}"}]}], "]"}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "f000", ",", "f100", ",", "f010", ",", "f001", ",", "f200", ",", 
              "f110", ",", "f101", ",", "f020", ",", "f011", ",", "f002"}], 
             "}"}], ",", 
            RowBox[{"(", 
             RowBox[{
             "\[CurlyEpsilon]x", ",", "\[CurlyEpsilon]xy", ",", 
              "\[CurlyEpsilon]y"}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\[Phi]", ",", "\[Phi]\[CurlyEpsilon]x", ",", 
              "\[Phi]\[CurlyEpsilon]xy", ",", "\[Phi]\[CurlyEpsilon]y", ",", 
              "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]x", ",", 
              "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]xy", ",", 
              "\[Phi]\[CurlyEpsilon]x\[CurlyEpsilon]y", ",", 
              "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]xy", ",", 
              "\[Phi]\[CurlyEpsilon]xy\[CurlyEpsilon]y", ",", 
              "\[Phi]\[CurlyEpsilon]y\[CurlyEpsilon]y"}], "}"}]}], "*)"}], 
          ",", 
          RowBox[{"RK10n", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"{", "28", "}"}]}], "]"}]}], ",", "RKtemp"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "$l1", " ", ",", "$l2", ",", "$l3", ",", "$v1", ",", "$v2", ",", 
            "$v3", ",", "$v4", ",", "$v5", ",", "$v6", ",", "$v7", ",", "$v8",
             ",", "$v9"}], "}"}], "=", 
          RowBox[{"Eigensystem3Dv", "[", "m22", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mat", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "==", "0."}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c1", ",", "c2"}], "}"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"mat", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"mat", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"1", "-", 
                 RowBox[{"mat", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ","}]}], 
          "*)"}], 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c1", ",", "c2"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mat", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"mat", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"mat", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"1", "-", 
              RowBox[{"2", 
               RowBox[{"mat", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Phi]v", "=", 
          RowBox[{"c1", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "^", "2"}], "/",
             "2"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]1", "=", 
          RowBox[{"c2", " ", 
           RowBox[{
            RowBox[{"$l1", "^", "2"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Phi]2", "=", 
          RowBox[{"c2", " ", 
           RowBox[{
            RowBox[{"$l2", "^", "2"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Phi]3", "=", 
          RowBox[{"c2", " ", 
           RowBox[{
            RowBox[{"$l3", "^", "2"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RKtemp", "=", 
          RowBox[{"c1", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "^", "2"}], 
              "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}], "+", 
                RowBox[{"$v7", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v4", "*", "$v5"}], "+", 
                RowBox[{"$v7", "*", "$v8"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v3"}], "+", 
                RowBox[{"$v4", "*", "$v6"}], "+", 
                RowBox[{"$v7", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v5", "^", "2"}], "+", 
                RowBox[{"$v8", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "*", "$v3"}], "+", 
                RowBox[{"$v5", "*", "$v6"}], "+", 
                RowBox[{"$v8", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v3", "^", "2"}], "+", 
                RowBox[{"$v6", "^", "2"}], "+", 
                RowBox[{"$v9", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}], "+", 
                RowBox[{"$v7", "^", "2"}]}], ")"}], "^", "2"}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}], "+", 
                RowBox[{"$v7", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v4", "*", "$v5"}], "+", 
                RowBox[{"$v7", "*", "$v8"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}], "+", 
                RowBox[{"$v7", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v3"}], "+", 
                RowBox[{"$v4", "*", "$v6"}], "+", 
                RowBox[{"$v7", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}], "+", 
                RowBox[{"$v7", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v5", "^", "2"}], "+", 
                RowBox[{"$v8", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}], "+", 
                RowBox[{"$v7", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "*", "$v3"}], "+", 
                RowBox[{"$v5", "*", "$v6"}], "+", 
                RowBox[{"$v8", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "^", "2"}], "+", 
                RowBox[{"$v4", "^", "2"}], "+", 
                RowBox[{"$v7", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v3", "^", "2"}], "+", 
                RowBox[{"$v6", "^", "2"}], "+", 
                RowBox[{"$v9", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"4", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v1", "*", "$v2"}], "+", 
                 RowBox[{"$v4", "*", "$v5"}], "+", 
                 RowBox[{"$v7", "*", "$v8"}]}], ")"}], "^", "2"}]}], ",", 
             RowBox[{"4", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v4", "*", "$v5"}], "+", 
                RowBox[{"$v7", "*", "$v8"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v3"}], "+", 
                RowBox[{"$v4", "*", "$v6"}], "+", 
                RowBox[{"$v7", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v4", "*", "$v5"}], "+", 
                RowBox[{"$v7", "*", "$v8"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v5", "^", "2"}], "+", 
                RowBox[{"$v8", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"4", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v4", "*", "$v5"}], "+", 
                RowBox[{"$v7", "*", "$v8"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "*", "$v3"}], "+", 
                RowBox[{"$v5", "*", "$v6"}], "+", 
                RowBox[{"$v8", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"$v4", "*", "$v5"}], "+", 
                RowBox[{"$v7", "*", "$v8"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v3", "^", "2"}], "+", 
                RowBox[{"$v6", "^", "2"}], "+", 
                RowBox[{"$v9", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"4", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v1", "*", "$v3"}], "+", 
                 RowBox[{"$v4", "*", "$v6"}], "+", 
                 RowBox[{"$v7", "*", "$v9"}]}], ")"}], "^", "2"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v5", "^", "2"}], "+", 
                RowBox[{"$v8", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v3"}], "+", 
                RowBox[{"$v4", "*", "$v6"}], "+", 
                RowBox[{"$v7", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{"4", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v3"}], "+", 
                RowBox[{"$v4", "*", "$v6"}], "+", 
                RowBox[{"$v7", "*", "$v9"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "*", "$v3"}], "+", 
                RowBox[{"$v5", "*", "$v6"}], "+", 
                RowBox[{"$v8", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v3"}], "+", 
                RowBox[{"$v4", "*", "$v6"}], "+", 
                RowBox[{"$v7", "*", "$v9"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v3", "^", "2"}], "+", 
                RowBox[{"$v6", "^", "2"}], "+", 
                RowBox[{"$v9", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v5", "^", "2"}], "+", 
                RowBox[{"$v8", "^", "2"}]}], ")"}], "^", "2"}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v5", "^", "2"}], "+", 
                RowBox[{"$v8", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "*", "$v3"}], "+", 
                RowBox[{"$v5", "*", "$v6"}], "+", 
                RowBox[{"$v8", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "^", "2"}], "+", 
                RowBox[{"$v5", "^", "2"}], "+", 
                RowBox[{"$v8", "^", "2"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v3", "^", "2"}], "+", 
                RowBox[{"$v6", "^", "2"}], "+", 
                RowBox[{"$v9", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"4", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v2", "*", "$v3"}], "+", 
                 RowBox[{"$v5", "*", "$v6"}], "+", 
                 RowBox[{"$v8", "*", "$v9"}]}], ")"}], "^", "2"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "*", "$v3"}], "+", 
                RowBox[{"$v5", "*", "$v6"}], "+", 
                RowBox[{"$v8", "*", "$v9"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v3", "^", "2"}], "+", 
                RowBox[{"$v6", "^", "2"}], "+", 
                RowBox[{"$v9", "^", "2"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v3", "^", "2"}], "+", 
                RowBox[{"$v6", "^", "2"}], "+", 
                RowBox[{"$v9", "^", "2"}]}], ")"}], "^", "2"}]}], "}"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"$l1", "+", "$l2", "+", "$l3"}], ">", "0."}], ",", 
           RowBox[{
            RowBox[{"RK10p", "+=", "RKtemp"}], ";"}], ",", 
           RowBox[{"RK10n", "+=", "RKtemp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RKtemp", "=", 
          RowBox[{"c2", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"$l1", "^", "2"}], "/", "2"}], ",", 
             RowBox[{"$l1", "*", 
              RowBox[{"$v1", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l1", "*", "$v1", "*", "$v2"}], ",", 
             RowBox[{"2", "*", "$l1", "*", "$v1", "*", "$v3"}], ",", 
             RowBox[{"$l1", "*", 
              RowBox[{"$v2", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l1", "*", "$v2", "*", "$v3"}], ",", 
             RowBox[{"$l1", "*", 
              RowBox[{"$v3", "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"$v1", "^", "4"}], "+", 
              RowBox[{"2", "*", "$l1", "*", 
               RowBox[{"$v1", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v4", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v7", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v1", "^", "3"}], "*", "$v2"}], "+", 
              RowBox[{"2", "*", "$l1", "*", "$v1", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v2", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v4", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v7", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v1", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v1", "^", "3"}], "*", "$v3"}], "+", 
              RowBox[{"2", "*", "$l1", "*", "$v1", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v4", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v7", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v1", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ",", 
             RowBox[{"$v1", "*", "$v2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2"}], "+", 
                RowBox[{"2", "*", "$l1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{"2", "*", "$v1", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v2", "*", "$v3"}], "+", 
                RowBox[{"$l1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v3", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"$v2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{"$v1", "*", "$v3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v1", "*", "$v3"}], "+", 
                RowBox[{"2", "*", "$l1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", 
                 RowBox[{"$v2", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"$v4", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"$v7", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"2", "*", "$l1", "*", "$v1", "*", "$v2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"$v1", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"$v2", "^", "2"}]}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v5", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v8", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v1", "^", "2"}], "*", "$v2", "*", "$v3"}], "+", 
              RowBox[{"2", "*", "$l1", "*", "$v2", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v4", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v7", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v1", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}], "+", 
              RowBox[{"2", "*", "$l1", "*", "$v1", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v1", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", "$v2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"$v1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v2", "^", "2"}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v5", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v8", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", "$l1", "*", "$v2", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v2", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}], "+", 
              RowBox[{"2", "*", "$v1", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "*", 
                  RowBox[{"$v2", "^", "2"}], "*", "$v3"}], "+", 
                 RowBox[{"$l1", "*", "$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v5", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v8", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$l1", "*", "$v2", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", "$v2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"$v1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v2", "*", "$v3"}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", 
                 RowBox[{"$v3", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"$v4", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"$v7", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"2", "*", "$l1", "*", "$v1", "*", "$v3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"$v1", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"$v3", "^", "2"}]}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v6", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v9", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{"2", "*", "$v2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", "$v3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"$v1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v2", "*", "$v3"}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", "$l1", "*", "$v3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v2", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}], "+", 
              RowBox[{"2", "*", "$v1", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$l1", "*", "$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v2", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"$v3", "^", "2"}]}], "+", 
                    RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v6", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v9", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                   ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", "$v3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"$v1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v3", "^", "2"}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v6", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v9", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"$v2", "^", "4"}], "+", 
              RowBox[{"2", "*", "$l1", "*", 
               RowBox[{"$v2", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v5", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v8", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v2", "^", "3"}], "*", "$v3"}], "+", 
              RowBox[{"2", "*", "$l1", "*", "$v2", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$v3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v5", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v8", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"$v2", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ",", 
             RowBox[{"$v2", "*", "$v3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v2", "*", "$v3"}], "+", 
                RowBox[{"2", "*", "$l1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", 
                 RowBox[{"$v3", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"$v5", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"$v8", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"2", "*", "$l1", "*", "$v2", "*", "$v3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"$v2", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"$v3", "^", "2"}]}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v6", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v9", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{"2", "*", "$v3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l1", "*", "$v3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"$v2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$v3", "^", "2"}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v6", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v9", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"$v3", "^", "4"}], "+", 
              RowBox[{"2", "*", "$l1", "*", 
               RowBox[{"$v3", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v6", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l1", "-", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v9", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l1", "-", "$l3"}], ")"}]}]}], ")"}]}]}]}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$l1", ">", "0."}], ",", 
           RowBox[{
            RowBox[{"RK10p", "+=", "RKtemp"}], ";"}], ",", 
           RowBox[{"RK10n", "+=", "RKtemp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RKtemp", "=", 
          RowBox[{"c2", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"$l2", "^", "2"}], "/", "2"}], ",", 
             RowBox[{"$l2", "*", 
              RowBox[{"$v4", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l2", "*", "$v4", "*", "$v5"}], ",", 
             RowBox[{"2", "*", "$l2", "*", "$v4", "*", "$v6"}], ",", 
             RowBox[{"$l2", "*", 
              RowBox[{"$v5", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l2", "*", "$v5", "*", "$v6"}], ",", 
             RowBox[{"$l2", "*", 
              RowBox[{"$v6", "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"$v4", "^", "4"}], "+", 
              RowBox[{"2", "*", "$l2", "*", 
               RowBox[{"$v4", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v1", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v7", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v4", "^", "3"}], "*", "$v5"}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v4", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v1", "*", "$v2", "*", "$v4"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", "$v5"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v7", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v5", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v8"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v4", "^", "3"}], "*", "$v6"}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v4", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v1", "*", "$v3", "*", "$v4"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", "$v6"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v7", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"$v4", "*", "$v5", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v4", "*", "$v5"}], "+", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{"2", "*", "$v4", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v4", "*", "$v5", "*", "$v6"}], "+", 
                RowBox[{"$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v5"}], "+", 
                    RowBox[{"$v2", "*", "$v6"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{"$v4", "*", "$v6", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v4", "*", "$v6"}], "+", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v4", "^", "2"}], "*", 
               RowBox[{"$v5", "^", "2"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$l3", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v2", "*", "$v4"}], "+", 
                    RowBox[{"$v1", "*", "$v5"}]}], ")"}], "^", "2"}]}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v5", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v8"}]}], ")"}], "^", "2"}]}], "-", 
                   RowBox[{"$l2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", 
                    RowBox[{"$v4", "^", "2"}]}], "+", 
                    RowBox[{
                    "2", "*", "$v1", "*", "$v2", "*", "$v4", "*", "$v5"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", 
                    RowBox[{"$v5", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v5", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v8"}]}], ")"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"$l1", "-", "$l2"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"$l2", "-", "$l3"}], ")"}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v4", "^", "2"}], "*", "$v5", "*", "$v6"}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v5", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v1", "*", "$v3", "*", "$v4"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", "$v6"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v7", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v4", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v4"}], "+", 
                    RowBox[{"$v1", "*", "$v6"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v8", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v5", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v4", "*", 
                 RowBox[{"$v5", "^", "2"}]}], "+", 
                RowBox[{"$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", "$v4"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v2", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v5", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v8"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", "$v4", "*", 
               RowBox[{"$v5", "^", "2"}], "*", "$v6"}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v5", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v5"}], "+", 
                    RowBox[{"$v2", "*", "$v6"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v7", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v4", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v2", "*", "$v3", "*", "$v5"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", "$v6"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v8", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v6", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v4", "*", "$v5", "*", "$v6"}], "+", 
                RowBox[{"$l2", "*", "$v5", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v7", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"$l2", "*", "$v4", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v4", "^", "2"}], "*", 
               RowBox[{"$v6", "^", "2"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$l3", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v4"}], "+", 
                    RowBox[{"$v1", "*", "$v6"}]}], ")"}], "^", "2"}]}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}], "^", "2"}]}], "-", 
                   RowBox[{"$l2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", 
                    RowBox[{"$v4", "^", "2"}]}], "+", 
                    RowBox[{
                    "2", "*", "$v1", "*", "$v3", "*", "$v4", "*", "$v6"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", 
                    RowBox[{"$v6", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"$l1", "-", "$l2"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"$l2", "-", "$l3"}], ")"}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v5", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v4", "*", "$v5", "*", "$v6"}], "+", 
                RowBox[{"$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v4"}], "+", 
                    RowBox[{"$v1", "*", "$v6"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", "$v4", "*", "$v5", "*", 
               RowBox[{"$v6", "^", "2"}]}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v6", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v5"}], "+", 
                    RowBox[{"$v2", "*", "$v6"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l2"}], ")"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v7", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v4", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", "$v5"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v2", "*", "$v3", "*", "$v6"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v9", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v6", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v4", "*", 
                 RowBox[{"$v6", "^", "2"}]}], "+", 
                RowBox[{"$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", "$v4"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v3", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v9", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"$v5", "^", "4"}], "+", 
              RowBox[{"2", "*", "$l2", "*", 
               RowBox[{"$v5", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v2", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v8", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v5", "^", "3"}], "*", "$v6"}], "+", 
              RowBox[{"2", "*", "$l2", "*", "$v5", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v2", "*", "$v3", "*", "$v5"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", "$v6"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v8", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"$v5", "*", "$v6", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v5", "*", "$v6"}], "+", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v8", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v5", "^", "2"}], "*", 
               RowBox[{"$v6", "^", "2"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", "$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$l3", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v5"}], "+", 
                    RowBox[{"$v2", "*", "$v6"}]}], ")"}], "^", "2"}]}], "+", 
                   RowBox[{"$l1", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}], "^", "2"}]}], "-", 
                   RowBox[{"$l2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", 
                    RowBox[{"$v5", "^", "2"}]}], "+", 
                    RowBox[{
                    "2", "*", "$v2", "*", "$v3", "*", "$v5", "*", "$v6"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", 
                    RowBox[{"$v6", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"$l1", "-", "$l2"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"$l2", "-", "$l3"}], ")"}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v6", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v5", "*", 
                 RowBox[{"$v6", "^", "2"}]}], "+", 
                RowBox[{"$l2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", "$v3", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v9", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"$v6", "^", "4"}], "+", 
              RowBox[{"2", "*", "$l2", "*", 
               RowBox[{"$v6", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v3", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v9", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}]}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$l2", ">", "0."}], ",", 
           RowBox[{
            RowBox[{"RK10p", "+=", "RKtemp"}], ";"}], ",", 
           RowBox[{"RK10n", "+=", "RKtemp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RKtemp", "=", 
          RowBox[{"c2", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"$l3", "^", "2"}], "/", "2"}], ",", 
             RowBox[{"$l3", "*", 
              RowBox[{"$v7", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l3", "*", "$v7", "*", "$v8"}], ",", 
             RowBox[{"2", "*", "$l3", "*", "$v7", "*", "$v9"}], ",", 
             RowBox[{"$l3", "*", 
              RowBox[{"$v8", "^", "2"}]}], ",", 
             RowBox[{"2", "*", "$l3", "*", "$v8", "*", "$v9"}], ",", 
             RowBox[{"$l3", "*", 
              RowBox[{"$v9", "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", "$l3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v1", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v4", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*", 
               RowBox[{"$v7", "^", "2"}]}], "+", 
              RowBox[{"$v7", "^", "4"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v7", "^", "3"}], "*", "$v8"}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v7", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v1", "*", "$v2", "*", "$v7"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", "$v8"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v5", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v8"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v7", "^", "3"}], "*", "$v9"}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v7", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v1", "*", "$v3", "*", "$v7"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", "$v9"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"$v7", "*", "$v8", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{"$v7", "*", "$v8"}]}], ")"}]}], ",", 
             RowBox[{"2", "*", "$v7", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v7", "*", "$v8", "*", "$v9"}], "+", 
                RowBox[{"$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v8"}], "+", 
                    RowBox[{"$v2", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{"$v7", "*", "$v9", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{"$v7", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v7", "^", "2"}], "*", 
               RowBox[{"$v8", "^", "2"}]}], "+", 
              RowBox[{"2", "*", "$l3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", 
                    RowBox[{"$v7", "^", "2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v5", "^", "2"}], "*", 
                    RowBox[{"$v7", "^", "2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "2", "*", "$v1", "*", "$v2", "*", "$v7", "*", "$v8"}], 
                   ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "2", "*", "$v4", "*", "$v5", "*", "$v7", "*", "$v8"}], 
                   ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v1", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v4", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*", 
                  RowBox[{"$v8", "^", "2"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v7", "^", "2"}], "*", "$v8", "*", "$v9"}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v8", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v1", "*", "$v3", "*", "$v7"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v1", "^", "2"}], "*", "$v9"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v7", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v7"}], "+", 
                    RowBox[{"$v1", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v5", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v8", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v7", "*", 
                 RowBox[{"$v8", "^", "2"}]}], "+", 
                RowBox[{"$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", "$v7"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v2", "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v5", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v8"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", "$v7", "*", 
               RowBox[{"$v8", "^", "2"}], "*", "$v9"}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v8", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v8"}], "+", 
                    RowBox[{"$v2", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v7", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v2", "*", "$v3", "*", "$v8"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", "$v9"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v5", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v9", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*",
                  "$v7"}], "+", 
                RowBox[{"$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v4", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*",
                  "$v8"}], "+", 
                RowBox[{"$v7", "*", "$v8", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v7", "^", "2"}], "*", 
               RowBox[{"$v9", "^", "2"}]}], "+", 
              RowBox[{"2", "*", "$l3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", 
                    RowBox[{"$v7", "^", "2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v6", "^", "2"}], "*", 
                    RowBox[{"$v7", "^", "2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "2", "*", "$v1", "*", "$v3", "*", "$v7", "*", "$v9"}], 
                   ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "2", "*", "$v4", "*", "$v6", "*", "$v7", "*", "$v9"}], 
                   ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v1", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v4", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*", 
                  RowBox[{"$v9", "^", "2"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v8", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v7", "*", "$v8", "*", "$v9"}], "+", 
                RowBox[{"$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v7"}], "+", 
                    RowBox[{"$v1", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", "$v7", "*", "$v8", "*", 
               RowBox[{"$v9", "^", "2"}]}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v9", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "*", "$v8"}], "+", 
                    RowBox[{"$v2", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l1", "-", "$l3"}], ")"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v7", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", "$v8"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v2", "*", "$v3", "*", "$v9"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v6", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v9", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v7", "*", 
                 RowBox[{"$v9", "^", "2"}]}], "+", 
                RowBox[{"$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", "$v7"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v1", "*", "$v3", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v6", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v7"}], "+", 
                    RowBox[{"$v4", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", "$l3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v2", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v5", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*", 
               RowBox[{"$v8", "^", "2"}]}], "+", 
              RowBox[{"$v8", "^", "4"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"$v8", "^", "3"}], "*", "$v9"}], "+", 
              RowBox[{"2", "*", "$l3", "*", "$v8", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v2", "*", "$v3", "*", "$v8"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v2", "^", "2"}], "*", "$v9"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"$v5", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], ",", 
             RowBox[{"$v8", "*", "$v9", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", "$v3"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v5", "*", "$v6"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{"$v8", "*", "$v9"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"$v8", "^", "2"}], "*", 
               RowBox[{"$v9", "^", "2"}]}], "+", 
              RowBox[{"2", "*", "$l3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", 
                    RowBox[{"$v8", "^", "2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$v6", "^", "2"}], "*", 
                    RowBox[{"$v8", "^", "2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "2", "*", "$v2", "*", "$v3", "*", "$v8", "*", "$v9"}], 
                   ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "2", "*", "$v5", "*", "$v6", "*", "$v8", "*", "$v9"}], 
                   ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$v2", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"$v5", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*", 
                  RowBox[{"$v9", "^", "2"}]}]}], ")"}]}]}], ",", 
             RowBox[{"2", "*", "$v9", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$v8", "*", 
                 RowBox[{"$v9", "^", "2"}]}], "+", 
                RowBox[{"$l3", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v3", "^", "2"}], "*", "$v8"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v2", "*", "$v3", "*", "$v9"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"$v6", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$v6", "*", "$v8"}], "+", 
                    RowBox[{"$v5", "*", "$v9"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"$l2", "-", "$l3"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"2", "*", "$l3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$v3", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l1"}], "+", "$l3"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"$v6", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "$l2"}], "+", "$l3"}], ")"}]}]}], ")"}], "*", 
               RowBox[{"$v9", "^", "2"}]}], "+", 
              RowBox[{"$v9", "^", "4"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$l3", ">", "0."}], ",", 
           RowBox[{
            RowBox[{"RK10p", "+=", "RKtemp"}], ";"}], ",", 
           RowBox[{"RK10n", "+=", "RKtemp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"RK10p", ",", "RK10n"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}], ",", 
      RowBox[{"CompilationOptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
         RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
      ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.8800082819049177`*^9, {3.8800119055213895`*^9, 3.8800119346175857`*^9}, {
   3.880012030707839*^9, 3.8800120617308035`*^9}, {3.880467182785458*^9, 
   3.880467182847375*^9}, {3.8804674301234207`*^9, 3.8804675536082287`*^9}, {
   3.8804677518941917`*^9, 3.8804677539711046`*^9}, {3.880467810268654*^9, 
   3.8804678543459253`*^9}, {3.8804678925269403`*^9, 3.880467914695818*^9}, 
   3.934368010079733*^9, {3.9343697479748297`*^9, 
   3.934369904364608*^9}},ExpressionUUID->"77317bcb-5246-4aef-8d37-\
a31ac1a4ece7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conventional code for FEM", "Section",
 CellChangeTimes->{{3.8799943999920177`*^9, 
  3.8799944451460023`*^9}},ExpressionUUID->"1eb439b5-3261-48b8-82d2-\
013418856e66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<MeshIntegrationPoints.nb\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<NOM_tools v0.nb\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.783059022412573*^9, 3.78305902322562*^9}, {
   3.8799918610574007`*^9, 3.8799918669160643`*^9}, {3.904789101714229*^9, 
   3.904789109814561*^9}, 3.904789878505247*^9, {3.9048005437230062`*^9, 
   3.904800577833544*^9}, {3.934368003028965*^9, 
   3.9343680048217635`*^9}},ExpressionUUID->"a478105a-8d18-4ef7-a39b-\
48ac5b480c7f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.904800554900771*^9},ExpressionUUID->"15e368be-6bcd-4c05-af6a-\
ec0a31647ac4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Area23", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", "=", 
          RowBox[{"Length", "[", "m", "]"}]}], ",", 
         RowBox[{"nc", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "im"}], "}"}], ",", 
       RowBox[{
        RowBox[{"im", "=", "0."}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "2"}], "&&", 
           RowBox[{"nr", "\[Equal]", "1"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], "]"}], 
           "]"}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Length", " ", "of", " ", "line", " ", "in", " ", "2", "D"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "2"}], "&&", 
           RowBox[{"nr", "\[Equal]", "2"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"m", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "]"}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Area", " ", "in", " ", "2", "D"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "3"}], "&&", 
           RowBox[{"nr", "\[Equal]", "1"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}]}], "]"}], 
           "]"}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Length", " ", "of", " ", "line", " ", "in", " ", "3", "D"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "3"}], "&&", 
           RowBox[{"nr", "\[Equal]", "2"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}], "2"], 
             "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}], "2"], 
             "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                 RowBox[{"m", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}], "2"]}], 
            "]"}], "]"}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"(*", 
          RowBox[{"Area", " ", "in", " ", "3", "D"}], "*)"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "3"}], "&&", 
           RowBox[{"nr", "\[Equal]", "3"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"m", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], "]"}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Volume", " ", "in", " ", "3", "D"}], "*)"}], 
        "\[IndentingNewLine]", "im"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7827534321904964`*^9, 3.78275363645818*^9}, {
  3.782753679970669*^9, 3.7827539354862833`*^9}, {3.7827539881482954`*^9, 
  3.7827540040632057`*^9}, {3.782755756722452*^9, 3.7827558050192146`*^9}, {
  3.7827560226006594`*^9, 3.7827560525043697`*^9}, {3.782756223413145*^9, 
  3.7827562677286797`*^9}, {3.7827566700286903`*^9, 3.782756672508832*^9}, {
  3.782757509566709*^9, 3.7827575776916056`*^9}, {3.7827576130496283`*^9, 
  3.782757707391024*^9}, {3.7827577415129757`*^9, 3.7827577750478935`*^9}, {
  3.782788468556866*^9, 3.7827884823296537`*^9}, {3.7830668605738907`*^9, 
  3.7830668760057735`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"661deced-f7e7-4ccb-b9ce-2cf24681593f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Otimes", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "a", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "b", "]"}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"res", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", 
            RowBox[{"b", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "a", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}], ";", 
        "res"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"96beced4-a89e-431a-81c7-5e15932bebf5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"return", " ", "the", " ", 
    RowBox[{"(", 
     RowBox[{"pseudo", "-"}], ")"}], "inverse", " ", "of", " ", "low", " ", 
    "order", " ", "matrix"}], ",", " ", 
   RowBox[{"2", "d"}], ",", " ", 
   RowBox[{"3", "d"}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "row"}], "\[LessEqual]", " ", "column"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ndim", "=", "2"}], ";", 
    RowBox[{"nr", "=", "2"}], ";", 
    RowBox[{"m", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"nr", ",", "ndim"}], "}"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{
      RowBox[{"Inverse23", "[", "m", "]"}], "//", 
      RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
       RowBox[{"Inverse", "[", "m", "]"}]}]}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
      RowBox[{"m", ".", 
       RowBox[{"Inverse23", "[", "m", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7827548960002213`*^9, 3.7827549422408667`*^9}, {
   3.7827550024973125`*^9, 3.7827550051634655`*^9}, 3.782758162364047*^9, 
   3.8974452479280753`*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"47cc8103-c817-4739-83ce-cbcd0d83bc56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse23", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", "=", 
          RowBox[{"Length", "[", "m", "]"}]}], ",", 
         RowBox[{"nc", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "im"}], "}"}], ",", 
       RowBox[{
        RowBox[{"im", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", "nc", "}"}], ",", 
           RowBox[{"{", "nr", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nr", ">", "3"}], " ", "||", " ", 
             RowBox[{"nc", ">", "nr"}]}], ",", 
            RowBox[{"Return", "[", "im", "]"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "2"}], "&&", 
           RowBox[{"nr", "\[Equal]", "1"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                ")"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                ")"}]}], "}"}]}], "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "2"}], "&&", 
           RowBox[{"nr", "\[Equal]", "2"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], 
                 ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], 
                 ")"}]}], ",", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}]}], 
              "}"}]}], "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "3"}], "&&", 
           RowBox[{"nr", "\[Equal]", "1"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                ")"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                ")"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "3"}], "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"m", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                ")"}]}], "}"}]}], "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "3"}], "&&", 
           RowBox[{"nr", "\[Equal]", "2"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], 
                 ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], 
                 ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], 
                 ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                    ")"}]}]}], ")"}]}]}], "}"}]}], "}"}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nc", "\[Equal]", "3"}], "&&", 
           RowBox[{"nr", "\[Equal]", "3"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                   RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], 
              "}"}]}], "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "im"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7827541468623734`*^9, 3.782754152698707*^9}, {
   3.782754475921194*^9, 3.782754485597748*^9}, {3.782754665522039*^9, 
   3.782754668358201*^9}, {3.782754717538014*^9, 3.7827548046429963`*^9}, {
   3.782755083348937*^9, 3.7827550884022264`*^9}, 3.7827579329569254`*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"eea08416-59b1-43c3-9316-622d3c6c334d"],

Cell[CellGroupData[{

Cell["Shape functions and their derivatives", "Subsection",
 CellChangeTimes->{{3.8799945303659596`*^9, 
  3.879994547868737*^9}},ExpressionUUID->"4b9c0b3b-12eb-41f3-8d16-\
9d1cd08eb4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMShapeDeriFun", "[", 
    RowBox[{"topCode_String", ",", 
     RowBox[{"shapeNdN_String", ":", "\"\<shapeNdN\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Nh", ",", "dNh", ",", "\[Zeta]c", ",", "\[Kappa]", ",", "xy", ",", 
       "ixy", ",", "\[Xi]", ",", "\[Eta]", ",", "\[Zeta]", ",", "sN", ",", 
       RowBox[{"H1top", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}]}], ",", 
       " ", 
       RowBox[{"H2Stop", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"xy", "=", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<T1\>\"", ",", "\"\<O1\>\"", ",", "\"\<Q1\>\"", ",", 
             "\"\<S1\>\"", ",", "\"\<H1\>\"", ",", "\"\<L1\>\"", ",", 
             "\"\<L2\>\"", ",", "\"\<C1\>\"", ",", "\"\<C2\>\"", ",", 
             "\"\<T2\>\"", ",", "\"\<O2\>\"", ",", "\"\<Q2\>\"", ",", 
             "\"\<Q2S\>\"", ",", "\"\<S2S\>\"", ",", "\"\<P2\>\"", ",", 
             "\"\<S2\>\"", ",", "\"\<H2S\>\"", ",", "\"\<H2\>\""}], "}"}], 
           ",", "topCode"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Error, element type not found\>\"", "]"}],
          ";", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"topCode", "\[Equal]", "\"\<L1\>\""}], " ", "\[Or]", " ", 
         RowBox[{"topCode", "\[Equal]", "\"\<C1\>\""}]}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Xi]"}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}]}], "}"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"topCode", "\[Equal]", "\"\<L2\>\""}], " ", "\[Or]", " ", 
         RowBox[{"topCode", "\[Equal]", "\"\<C2\>\""}]}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], "  ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
           RowBox[{
            FractionBox["1", "2"], " ", "\[Xi]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Xi]", "2"]}], ")"}]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"topCode", "\[Equal]", "\"\<Q1\>\""}], "\[Or]", " ", 
         RowBox[{"topCode", "\[Equal]", "\"\<S1\>\""}]}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{
          FractionBox["1", "4"], " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Xi]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Xi]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}]}]}], "}"}]}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"topCode", "\[Equal]", "\"\<Q2S\>\""}], " ", "\[Or]", " ", 
         RowBox[{"topCode", "\[Equal]", "\"\<S2S\>\""}]}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox["1", "4"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Xi]"}], ")"}], "  ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Eta]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[Xi]"}], "-", "\[Eta]", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "4"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Eta]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"\[Xi]", "-", "\[Eta]", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "4"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"\[Xi]", "+", "\[Eta]", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "4"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Xi]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[Xi]"}], "+", "\[Eta]", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[Xi]", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[Eta]", "2"]}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[Xi]", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Eta]"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Xi]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[Eta]", "2"]}], ")"}]}]}], "}"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"topCode", "\[Equal]", "\"\<Q2\>\""}], "\[Or]", " ", 
         RowBox[{"topCode", "\[Equal]", "\"\<S2\>\""}]}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox["1", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
           RowBox[{
            FractionBox["1", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
            "\[Xi]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "4"], " ", "\[Eta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", "\[Xi]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", "4"], " ", "\[Eta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", "\[Xi]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[Eta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], "}"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"topCode", "\[Equal]", "\"\<T1\>\""}], "\[Or]", 
         RowBox[{"topCode", "\[Equal]", "\"\<P1\>\""}]}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "\[Eta]", ",", 
           RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]"}]}], "}"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"topCode", "\[Equal]", "\"\<T2\>\""}], " ", "\[Or]", " ", 
         RowBox[{"topCode", "\[Equal]", "\"\<P2\>\""}]}], ",", 
        RowBox[{
         RowBox[{"\[Zeta]c", "=", 
          RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nh", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Xi]"}], "-", "1"}], ")"}], " ", "\[Xi]"}],
             ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Eta]"}], "-", "1"}], ")"}], " ", 
             "\[Eta]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Zeta]c"}], "-", "1"}], ")"}], " ", 
             "\[Zeta]c"}], ",", 
            RowBox[{"4", " ", "\[Xi]", " ", "\[Eta]"}], ",", 
            RowBox[{"4", " ", "\[Eta]", " ", "\[Zeta]c"}], ",", 
            RowBox[{"4", " ", "\[Zeta]c", " ", "\[Xi]"}]}], "}"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"topCode", "\[Equal]", "\"\<O2\>\""}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Kappa]", "=", 
          RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nh", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Xi]"}], "-", "1"}], ")"}], " ", "\[Xi]"}],
             ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Eta]"}], "-", "1"}], ")"}], " ", 
             "\[Eta]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Zeta]"}], "-", "1"}], ")"}], " ", 
             "\[Zeta]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Kappa]"}], "-", "1"}], ")"}], " ", 
             "\[Kappa]"}], ",", 
            RowBox[{"4", " ", "\[Xi]", " ", "\[Eta]"}], ",", 
            RowBox[{"4", " ", "\[Eta]", " ", "\[Zeta]"}], ",", 
            RowBox[{"4", " ", "\[Zeta]", " ", "\[Xi]"}], ",", 
            RowBox[{"4", " ", "\[Xi]", " ", "\[Kappa]"}], ",", 
            RowBox[{"4", " ", "\[Eta]", " ", "\[Kappa]"}], ",", 
            RowBox[{"4", " ", "\[Zeta]", " ", "\[Kappa]"}]}], "}"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"topCode", "\[Equal]", "\"\<O1\>\""}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]", ",", 
           RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}]}], 
          "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"topCode", "\[Equal]", "\"\<H1\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Nh", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox["1", "8"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Xi]", " ", "#1"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Eta]", " ", "#2"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Zeta]", " ", "#3"}]}], ")"}]}], "&"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"H1top", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "8"}], "\[RightDoubleBracket]"}], "]"}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"topCode", "\[Equal]", "\"\<H2S\>\""}], ",", 
        RowBox[{"Nh", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox["1", "8"], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"\[Xi]", " ", "#1"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"\[Eta]", " ", "#2"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"\[Zeta]", " ", "#3"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Xi]", " ", "#1"}], "+", 
                 RowBox[{"\[Eta]", " ", "#2"}], "+", 
                 RowBox[{"\[Zeta]", " ", "#3"}], "-", "2"}], ")"}]}], "&"}], 
             ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"H2Stop", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", "8"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox["1", "4"], " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#1", "\[Equal]", "0"}], ",", 
                 RowBox[{"1", "-", 
                  SuperscriptBox["\[Xi]", "2"]}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"\[Xi]", " ", "#1"}]}]}], "]"}], " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#2", "\[Equal]", "0"}], ",", 
                 RowBox[{"1", "-", 
                  SuperscriptBox["\[Eta]", "2"]}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"\[Eta]", " ", "#2"}]}]}], "]"}], " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#3", "\[Equal]", "0"}], ",", 
                 RowBox[{"1", "-", 
                  SuperscriptBox["\[Zeta]", "2"]}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"\[Zeta]", " ", "#3"}]}]}], "]"}]}], "&"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"H2Stop", "\[LeftDoubleBracket]", 
               RowBox[{"9", ";;", "20"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"topCode", "\[Equal]", "\"\<H2\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Nh", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "8"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "8"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ",
              "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "8"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "8"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "8"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "8"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ",
              "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "8"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "8"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ",
              "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "4"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Zeta]"}], ")"}], " ", "\[Zeta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", "\[Xi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Xi]"}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", "\[Eta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Xi]"}], ")"}], " ", "\[Xi]"}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", "\[Zeta]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Zeta]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Eta]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ixy", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Variables", "[", "Nh", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dNh", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Nh", ",", 
          RowBox[{"{", 
           RowBox[{"xy", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "ixy"}], "\[RightDoubleBracket]"}], "}"}]}], 
         "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sN", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"InputForm", "[", 
           RowBox[{"Prepend", "[", 
            RowBox[{"dNh", ",", "Nh"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"xy", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
            "\"\<\[Xi]\>\""}], ",", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"xy", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Rule]", 
            "\"\<\[Eta]\>\""}], ",", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"xy", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "\[Rule]", 
            "\"\<\[Zeta]\>\""}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sN", "=", 
       RowBox[{
       "shapeNdN", "<>", "\"\<[\[Xi]_,\[Eta]_,\[Zeta]_]:=\>\"", "<>", 
        "sN"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ToExpression", "[", "sN", "]"}], ";", "\[IndentingNewLine]", 
      "sN"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.783055617842843*^9, 3.783055655921021*^9}, {
   3.783055689538944*^9, 3.783055696937367*^9}, {3.7830557330944347`*^9, 
   3.783055817588268*^9}, {3.7830558889253483`*^9, 3.7830559482327404`*^9}, 
   3.783056014036504*^9, {3.7830560987893515`*^9, 3.7830563286104965`*^9}, {
   3.783056371719962*^9, 3.7830564400458703`*^9}, 3.7830564863415184`*^9, {
   3.7830565228656073`*^9, 3.783056546708971*^9}, {3.783057032461755*^9, 
   3.7830570584112387`*^9}, {3.7830570995785933`*^9, 3.783057100461644*^9}, {
   3.783057183491393*^9, 3.7830571895007367`*^9}, {3.783163644356761*^9, 
   3.783163660116663*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"60ab1846-3534-4f9d-946c-7c7aa9a5da8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElementShapeNdN", "[", 
    RowBox[{"elementType_String", ",", "gpr_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "$$$aaa$$$", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FEMShapeDeriFun", "[", 
       RowBox[{"elementType", ",", 
        RowBox[{"ToString", "[", "$$$aaa$$$", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"$$$aaa$$$", "@@", 
         RowBox[{"gpr", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", 
           RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "gpr", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.783057592569791*^9, 3.783057672039336*^9}, 
   3.7830578986492977`*^9, {3.7830579353943996`*^9, 3.7830579629879775`*^9}, {
   3.7830580201242456`*^9, 3.7830580825788183`*^9}, {3.7830582223898144`*^9, 
   3.7830582646762333`*^9}, {3.7830583828519926`*^9, 
   3.7830583832700167`*^9}, {3.783058434226931*^9, 3.7830584395892377`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"a8a3e635-7de5-4890-96e3-155d30d48e40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FEMGaussPointdNdX", "[", 
   RowBox[{"shapedN_", ",", "nnode_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dsi", ",", "ngs", ",", "ndim", ",", "m", ",", "jm", ",", "numNode", ",",
       "BB", ",", "BList", ",", "im", ",", "dNdX"}], "}"}], ",", 
    RowBox[{
     RowBox[{"ngs", "=", 
      RowBox[{"Length", "[", "shapedN", "]"}]}], ";", 
     RowBox[{"numNode", "=", 
      RowBox[{"Length", "[", "nnode", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"shapedN", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", "numNode"}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"shapedN", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
        "numNode"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Error, the number of points dismatch!\>\"", "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
     RowBox[{"ndim", "=", 
      RowBox[{"Length", "[", 
       RowBox[{
       "nnode", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"BB", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"{", "ngs", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ndim", "+", "1"}], "}"}], ",", 
        RowBox[{"{", "numNode", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dsi", "=", 
         RowBox[{"shapedN", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"BList", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"{", 
              RowBox[{"ndim", "+", "1"}], "}"}], ",", 
             RowBox[{"{", "numNode", "}"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"dsi", ".", "nnode"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "m", "]"}], ",", "m", ",", "dsi"}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jm", "=", 
         RowBox[{"Area23", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"im", "=", 
         RowBox[{"Inverse23", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dNdX", "=", 
         RowBox[{"im", ".", "dsi"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "dNdX", "]"}], ",", "im", ",", 
            "dNdX"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BB", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{"dNdX", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "ndim"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"BB", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "=", "jm"}], 
        ";"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"BB", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "BList"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "ngs"}], "}"}]}], "]"}], ";", "BB"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.78275161204539*^9, 3.7827516133334637`*^9}, {
   3.7827522448845863`*^9, 3.782752245800639*^9}, {3.7827524784309444`*^9, 
   3.7827525437356796`*^9}, {3.7827525747734547`*^9, 
   3.7827526006579356`*^9}, {3.7827528752356405`*^9, 
   3.7827529290177164`*^9}, {3.782756725386856*^9, 3.782756747761136*^9}, {
   3.782756779956978*^9, 3.7827568019152336`*^9}, {3.782756861248627*^9, 
   3.7827568751134205`*^9}, {3.7827569702878637`*^9, 3.782756992469133*^9}, {
   3.7827570274011307`*^9, 3.7827570666013727`*^9}, {3.7827574400577335`*^9, 
   3.782757441660825*^9}, {3.782758457507928*^9, 3.782758470568675*^9}, {
   3.7827862879231415`*^9, 3.7827862909213123`*^9}, {3.782786364794538*^9, 
   3.7827863709448895`*^9}, {3.782786416070471*^9, 3.7827864243609447`*^9}, 
   3.782786487527558*^9, {3.7827865212814884`*^9, 3.782786527275831*^9}, {
   3.7827866908121853`*^9, 3.7827866915932293`*^9}, {3.782786730443452*^9, 
   3.782786733631634*^9}, {3.7827867916869545`*^9, 3.78278679317704*^9}, {
   3.782786924970578*^9, 3.7827869255566115`*^9}, {3.7827872410136547`*^9, 
   3.7827872422157235`*^9}, {3.7827883086777215`*^9, 3.782788308898734*^9}, 
   3.782788572549814*^9, {3.7827890186543303`*^9, 3.7827890211544733`*^9}, {
   3.7827890911834784`*^9, 3.7827891075274134`*^9}, {3.7827891723241196`*^9, 
   3.7827891948354073`*^9}, {3.7827892574359875`*^9, 3.782789261777236*^9}, {
   3.782789325923905*^9, 3.7827893712114954`*^9}, 3.7827894705251756`*^9, {
   3.7827895094154*^9, 3.782789515574752*^9}, {3.7827898107526355`*^9, 
   3.782789826535538*^9}, {3.7827899335036564`*^9, 3.782789951116664*^9}, 
   3.782789988012774*^9, {3.78279002727102*^9, 3.7827900692694216`*^9}, {
   3.782790229084563*^9, 3.78279022956559*^9}, {3.782790359778038*^9, 
   3.7827903846894627`*^9}, 3.7827904215425706`*^9, {3.7827905650017757`*^9, 
   3.7827905674189143`*^9}, 3.7827907123152018`*^9, {3.7827909901220913`*^9, 
   3.7827909988185887`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"eee7c999-75d5-4a13-a4d3-f822840eb630"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMGaussPointdNdXc", "::", "usage"}], "=", 
   "\"\<Return the {w,dN/dX,dN/dY,dN/dZ}, the order of {X,Y,Z} for 3D, for \
example\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEMGaussPointdNdXc", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shapedN0", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dsi", ",", "ngs", ",", "ndim", ",", "m", ",", "jm", ",", "numNode", 
         ",", "BB", ",", "BList", ",", "im", ",", "dNdX"}], "}"}], ",", 
       RowBox[{
        RowBox[{"ngs", "=", 
         RowBox[{"Length", "[", "shapedN0", "]"}]}], ";", 
        RowBox[{"numNode", "=", 
         RowBox[{"Length", "[", "nnode", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"shapedN", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", "numNode"}],
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"shapedN", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
             "numNode"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Error, the number of points dismatch!\>\"", 
              "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ndim", "=", 
         RowBox[{"Length", "[", 
          RowBox[{
          "nnode", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"BB", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", "ngs", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", "+", "1"}], "}"}], ",", 
           RowBox[{"{", "numNode", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dsi", "=", 
            RowBox[{"shapedN0", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"BList", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", 
                 RowBox[{"ndim", "+", "1"}], "}"}], ",", 
                RowBox[{"{", "numNode", "}"}]}], "]"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"m", "=", 
            RowBox[{"dsi", ".", "nnode"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"dsi", ",", "m"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "m", "]"}], ",", "m", ",", "dsi"}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"jm", "=", 
            RowBox[{"Area23", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"im", "=", 
            RowBox[{"Inverse23", "[", "m", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"jm", ",", "im"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"dNdX", "=", 
            RowBox[{"im", ".", "dsi"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "dNdX", "]"}], ",", "im", ",", 
               "dNdX"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"BB", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"dNdX", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "ndim"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BB", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "=", "jm"}], 
           ";"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "BList"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "ngs"}], "}"}]}], "]"}], ";", "BB"}]}], "]"}], 
     ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.782793290545668*^9, 3.7827933537462835`*^9}, 
   3.7827933981358223`*^9, {3.7827956140355644`*^9, 3.782795616888727*^9}, {
   3.782795660345213*^9, 3.782795661648288*^9}, {3.7830146702244205`*^9, 
   3.7830146764797783`*^9}, {3.7831035578476505`*^9, 3.783103576178699*^9}, {
   3.7831039309099884`*^9, 3.7831039360912848`*^9}, {3.783103968969165*^9, 
   3.7831040639325967`*^9}, {3.7831040997986484`*^9, 3.7831041209808598`*^9}, 
   3.7831731431990643`*^9, {3.7928632931659145`*^9, 3.7928633096020927`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"38059ea5-fabe-4747-b37b-bedaf6ae608b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMGaussPointdNdXcR", "::", "usage"}], "=", 
   "\"\<Return the {w,dN/dZ,dN/dY,dN/dX}, the reverse order of {X,Y,Z} for \
3D, for example\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FEMGaussPointdNdXcR", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shapedN0", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dsi", ",", "ngs", ",", "ndim", ",", "m", ",", "jm", ",", "numNode", 
         ",", "BB", ",", "BList", ",", "im", ",", "dNdX"}], "}"}], ",", 
       RowBox[{
        RowBox[{"ngs", "=", 
         RowBox[{"Length", "[", "shapedN0", "]"}]}], ";", 
        RowBox[{"numNode", "=", 
         RowBox[{"Length", "[", "nnode", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"shapedN", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", "numNode"}],
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"shapedN", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
             "numNode"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Error, the number of points dismatch!\>\"", 
              "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ndim", "=", 
         RowBox[{"Length", "[", 
          RowBox[{
          "nnode", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"BB", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", "ngs", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", "+", "1"}], "}"}], ",", 
           RowBox[{"{", "numNode", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dsi", "=", 
            RowBox[{"shapedN0", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"BList", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", 
                 RowBox[{"ndim", "+", "1"}], "}"}], ",", 
                RowBox[{"{", "numNode", "}"}]}], "]"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"m", "=", 
            RowBox[{"dsi", ".", "nnode"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"dsi", ",", "m"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "m", "]"}], ",", "m", ",", "dsi"}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"jm", "=", 
            RowBox[{"Area23", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"im", "=", 
            RowBox[{"Inverse23", "[", "m", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"jm", ",", "im"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"dNdX", "=", 
            RowBox[{"im", ".", "dsi"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "dNdX", "]"}], ",", "im", ",", 
               "dNdX"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"BB", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"dNdX", "[", 
               RowBox[{"[", 
                RowBox[{"ndim", "-", "j", "+", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "ndim"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BB", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "=", "jm"}], 
           ";"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "BList"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "ngs"}], "}"}]}], "]"}], ";", "BB"}]}], "]"}], 
     ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.792863119223384*^9, 3.792863156268903*^9}, {
  3.7928632012818837`*^9, 3.7928632808943853`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"2ad09320-9d74-4da3-a8a3-441d158bf6f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FEMGaussPointWeightc", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shapedN0", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dsi", ",", "ngs", ",", "m", ",", "jm"}], "}"}], ",", 
       RowBox[{
        RowBox[{"ngs", "=", 
         RowBox[{"Length", "[", "shapedN0", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", "ngs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dsi", "=", 
            RowBox[{"shapedN0", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"m", "=", 
            RowBox[{"dsi", ".", "nnode"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"jm", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Area23", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]",
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "ngs"}], "}"}]}], "]"}], ";", "jm"}]}], "]"}], 
     ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.78309672418272*^9, 3.7830967253277855`*^9}, {
   3.7830967564145637`*^9, 3.783096931728591*^9}, 3.7831731383537865`*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"73d1f430-30b7-4b56-b528-18663eeeef57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NeiIIndex", "[", 
    RowBox[{"NeiI_List", ",", "udim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n2", ",", "n3"}], "}"}], ",", 
     RowBox[{
      RowBox[{"n2", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"udim", " ", 
          RowBox[{"Length", "[", "NeiI", "]"}]}]}], "]"}]}], ";", 
      RowBox[{"n3", "=", 
       RowBox[{"udim", " ", 
        RowBox[{"(", 
         RowBox[{"NeiI", "-", "1"}], ")"}]}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ";;", 
            RowBox[{"-", "1"}], ";;", "udim"}], "]"}], "]"}], "=", 
         RowBox[{"n3", "+", "i"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "udim"}], "}"}]}], "]"}], ";", "n2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeiIIndexC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NeiI", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"udim", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n2", ",", "n3"}], "}"}], ",", 
       RowBox[{
        RowBox[{"n2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"udim", " ", 
             RowBox[{"Length", "[", "NeiI", "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"n3", "=", 
         RowBox[{"udim", " ", 
          RowBox[{"(", 
           RowBox[{"NeiI", "-", "1"}], ")"}]}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}], ";;", "udim"}], "]"}], "]"}], "=", 
           RowBox[{"n3", "+", "i"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "udim"}], "}"}]}], "]"}], ";", "n2"}]}], "]"}]}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783059107809458*^9, 3.7830591133977776`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"b1b948e8-878e-45b7-8333-50e385c0a2fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Strain matrix", "Subsection",
 CellChangeTimes->{{3.8799945811799483`*^9, 3.8799945837668123`*^9}, 
   3.9343679619914417`*^9},ExpressionUUID->"538c4d70-6f6a-477f-a2ea-\
c63338f18251"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrainBMatrix", "[", "BBi_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nnode", ",", "ndim", ",", "Bmat", ",", "i2"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ndim", ",", "nnode"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "BBi", "]"}]}], ";", 
       RowBox[{"ndim", "=", 
        RowBox[{"ndim", "-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{"ndim", "-", "1"}], ")"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ndim", " ", "nnode"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ndim", "\[Equal]", "2"}], ",", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i2", "=", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i2"}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "i2"}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", 
                RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nnode"}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ndim", "\[Equal]", "3"}], ",", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i2", "=", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i2"}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", 
                RowBox[{"i2", "+", "2"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", 
                RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", 
                RowBox[{"i2", "+", "2"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", "i2"}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", 
                RowBox[{"i2", "+", "2"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"6", ",", "i2"}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"Bmat", "[", 
              RowBox[{"[", 
               RowBox[{"6", ",", 
                RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"BBi", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nnode"}], "}"}]}], "]"}]}], "]"}], ";", 
       "Bmat"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrainBMatrixC2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"BBi", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nnode", ",", "ndim", ",", "Bmat", ",", "i2"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ndim", ",", "nnode"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "BBi", "]"}]}], ";", 
        RowBox[{"ndim", "=", 
         RowBox[{"ndim", "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"3", " ", 
             RowBox[{"(", 
              RowBox[{"ndim", "-", "1"}], ")"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "nnode"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ndim", "\[Equal]", "2"}], ",", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i2", "=", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}]}], ";", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i2"}], "]"}], "]"}], "=", 
              RowBox[{"BBi", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";", 
             RowBox[{"(*", "\[CurlyEpsilon]xx", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", 
                 RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"BBi", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ";", 
             RowBox[{"(*", "\[CurlyEpsilon]yy", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i2"}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "i"}], "]"}], "]"}]}]}], ";", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", 
                 RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i"}], "]"}], "]"}]}]}], ";"}], 
            RowBox[{"(*", 
             RowBox[{"\[CurlyEpsilon]xy", "=", 
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", "\[Gamma]xy"}]}], "*)"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nnode"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ndim", "\[Equal]", "3"}], ",", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i2", "=", 
              RowBox[{
               RowBox[{"3", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i2"}], "]"}], "]"}], "=", 
              RowBox[{"BBi", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ";", 
             RowBox[{"(*", "\[CurlyEpsilon]xx", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "2", "*)"}], 
                RowBox[{"4", ",", 
                 RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"BBi", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"\[CurlyEpsilon]yy", ",", " ", 
               RowBox[{"2", "->", "4"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "3", "*)"}], 
                RowBox[{"6", ",", 
                 RowBox[{"i2", "+", "2"}]}], "]"}], "]"}], "=", 
              RowBox[{"BBi", "[", 
               RowBox[{"[", 
                RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"\[CurlyEpsilon]zz", ",", 
               RowBox[{"3", "->", "6"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "4", "*)"}], 
                RowBox[{"5", ",", 
                 RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ",", "i"}], "]"}], "]"}]}]}], ";", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "4", "*)"}], 
                RowBox[{"5", ",", 
                 RowBox[{"i2", "+", "2"}]}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "i"}], "]"}], "]"}]}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"\[CurlyEpsilon]yz", "->", 
               RowBox[{"\[CurlyEpsilon]4", "->", "5"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "5", "*)"}], 
                RowBox[{"3", ",", "i2"}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ",", "i"}], "]"}], "]"}]}]}], ";", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "5", "*)"}], 
                RowBox[{"3", ",", 
                 RowBox[{"i2", "+", "2"}]}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i"}], "]"}], "]"}]}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"\[CurlyEpsilon]xz", "->", 
               RowBox[{"\[CurlyEpsilon]5", "->", "3"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "6", "*)"}], 
                RowBox[{"2", ",", "i2"}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "i"}], "]"}], "]"}]}]}], ";", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"[", 
                RowBox[{"(*", "6", "*)"}], 
                RowBox[{"2", ",", 
                 RowBox[{"i2", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"0.5", 
               RowBox[{"BBi", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i"}], "]"}], "]"}]}]}], ";"}], 
            RowBox[{"(*", 
             RowBox[{"\[CurlyEpsilon]xy", "->", 
              RowBox[{"\[CurlyEpsilon]6", "->", "2"}]}], "*)"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nnode"}], "}"}]}], "]"}]}], "]"}], ";", 
        "Bmat"}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7827964561847324`*^9, 3.7827964597869387`*^9}, {
   3.78279651295998*^9, 3.78279657519654*^9}, {3.78279665229795*^9, 
   3.7827967909118776`*^9}, {3.7827968337623286`*^9, 
   3.7827973540210857`*^9}, {3.7830142747558007`*^9, 3.783014308504731*^9}, {
   3.783014355845439*^9, 3.7830143562554626`*^9}, {3.7842173076078014`*^9, 
   3.7842173725819154`*^9}, {3.892351873200617*^9, 3.8923518906486216`*^9}, {
   3.8924407952052083`*^9, 3.8924408002771435`*^9}, {3.8924408428502426`*^9, 
   3.8924408689513407`*^9}, {3.8924409065018883`*^9, 
   3.8924411475515175`*^9}, {3.892441185322626*^9, 3.892441277271082*^9}, {
   3.8924413454465456`*^9, 3.8924414284594316`*^9}, {3.8924414585904436`*^9, 
   3.8924415073862176`*^9}, 3.8989082757716045`*^9, {3.934367952461589*^9, 
   3.934367956324517*^9}},ExpressionUUID->"ede37a2e-b19e-43f8-97b8-\
0e65b64a3180"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix calculation and assembly.", "Subsection",
 CellChangeTimes->{{3.879994603839032*^9, 3.879994612278248*^9}, 
   3.9343679323747487`*^9},ExpressionUUID->"2f59df24-32b2-4386-8cc6-\
c306b12ce5eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KMatrix", "[", 
    RowBox[{"wl_", ",", "jl_", ",", "BBi_", ",", "Di_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"BBi", "\[Transpose]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"wl", " ", "jl"}], ")"}], "Di"}], ")"}], ".", "BBi"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7827973910532036`*^9, 3.782797510657045*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"98d4272f-e67e-4907-9c43-6bd1b7e9a412"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OneElementMatrix", "[", 
    RowBox[{"wl_", ",", "shapedN_", ",", "nnode_", ",", "Di_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"nnode", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"numN", "=", 
        RowBox[{"Length", "[", "nnode", "]"}]}], ",", "Kmat", ",", "BB", ",", 
       "BBi"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Kmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"shapedN", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
           RowBox[{"Length", "[", "nnode", "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Error, shape function dismatchs the nodes\>\"", 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"BB", "=", 
       RowBox[{"FEMGaussPointdNdXc", "[", 
        RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"BBi", "=", 
          RowBox[{"StrainBMatrix", "[", 
           RowBox[{"BB", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
         RowBox[{"Kmat", "+=", 
          RowBox[{
           RowBox[{"BBi", "\[Transpose]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"wl", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", 
               RowBox[{"BB", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}], 
             "Di"}], ")"}], ".", "BBi"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "Kmat"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OneElementMatrixC", "[", 
    RowBox[{"wl_", ",", "shapedN_", ",", "nnode_", ",", "Di_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"nnode", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"numN", "=", 
        RowBox[{"Length", "[", "nnode", "]"}]}], ",", "Kmat", ",", "BB", ",", 
       "BBi"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Kmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"shapedN", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
           RowBox[{"Length", "[", "nnode", "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Error, shape function dismatchs the nodes\>\"", 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"BB", "=", 
       RowBox[{"FEMGaussPointdNdXc", "[", 
        RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"BBi", "=", 
          RowBox[{"StrainBMatrix", "[", 
           RowBox[{"BB", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
         RowBox[{"Kmat", "+=", 
          RowBox[{
           RowBox[{"BBi", "\[Transpose]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"wl", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", 
               RowBox[{"BB", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}], 
             "Di"}], ")"}], ".", "BBi"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "Kmat"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FemAllMatrix", "[", 
     RowBox[{"wl_", ",", "shapedN_", ",", "xyz_", ",", "ele_", ",", "Di_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ncount", "=", 
         RowBox[{"Length", "[", "xyz", "]"}]}], ",", 
        RowBox[{"ndim", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"xyz", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "ndof", ",", "Ksp", 
        ",", "ei", ",", "xyzi", ",", "NeiI2", ",", "Ki"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ndof", "=", 
        RowBox[{"ndim", " ", "ncount"}]}], ";", 
       RowBox[{"Ksp", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"shapedN", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"ele", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Error, shape function dismatches the nodes\>\"", 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ei", "=", 
           RowBox[{"ele", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", 
          RowBox[{"xyzi", "=", 
           RowBox[{"xyz", "[", 
            RowBox[{"[", "ei", "]"}], "]"}]}], ";", 
          RowBox[{"Ki", "=", 
           RowBox[{"OneElementMatrix", "[", 
            RowBox[{"wl", ",", "shapedN", ",", "xyzi", ",", "Di"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"NeiI2", "=", 
           RowBox[{"NeiIIndex", "[", 
            RowBox[{"ei", ",", "ndim"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Ksp", "+=", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Tuples", "[", 
               RowBox[{"NeiI2", ",", "2"}], "]"}], "\[Rule]", 
              RowBox[{"Flatten", "[", "Ki", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "Ksp"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "OneElementMatrix", " ", "is", " ", "based", " ", "on", " ", 
     "traditional", " ", "FEM"}], ",", " ", 
    RowBox[{"stainv", "=", 
     RowBox[{"{", 
      RowBox[{"\[CurlyEpsilon]xx", ",", "\[CurlyEpsilon]yy", ",", " ", 
       RowBox[{"2", " ", "\[CurlyEpsilon]xy"}]}], "}"}]}], "\:ff0c", " ", 
    RowBox[{"Di", " ", "matrix", " ", "is", " ", "obtained", " ", "by", " ", 
     RowBox[{"MatIsotropic", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OneElementMatrix", "[", 
    RowBox[{"wl_", ",", "shapedN_", ",", "nnode_", ",", "uv_", ",", "Di_"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"nnode", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"numN", "=", 
        RowBox[{"Length", "[", "nnode", "]"}]}], ",", "Kmat", ",", "Rmat", 
       ",", "BB", ",", "BBi", ",", "stressv", ",", "strainv"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Kmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"shapedN", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
           RowBox[{"Length", "[", "nnode", "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Error, shape function dismatchs the nodes\>\"", 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"BB", "=", 
       RowBox[{"FEMGaussPointdNdXc", "[", 
        RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"BBi", "=", 
          RowBox[{"StrainBMatrix", "[", 
           RowBox[{"BB", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"strainv", "=", 
          RowBox[{"BBi", ".", "uv"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stressv", "=", 
          RowBox[{"Di", ".", "strainv"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Rmat", "+=", 
          RowBox[{
           RowBox[{"BBi", "\[Transpose]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"wl", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", 
               RowBox[{"BB", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}], 
             "stressv"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Kmat", "+=", 
          RowBox[{
           RowBox[{"BBi", "\[Transpose]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"wl", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", 
               RowBox[{"BB", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}], 
             "Di"}], ")"}], ".", "BBi"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Rmat", ",", "Kmat"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FemAllMatrix", "[", 
    RowBox[{
    "wl_", ",", "shapedN_", ",", "xyz_", ",", "uvw_", ",", "ele_", ",", 
     "Di_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ncount", "=", 
        RowBox[{"Length", "[", "xyz", "]"}]}], ",", 
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "ndof", ",", "Ksp", 
       ",", "Rsp", ",", "ei", ",", "xyzi", ",", "uvwi", ",", "NeiI2", ",", 
       "Ki", ",", "Ri"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ndof", "=", 
       RowBox[{"ndim", " ", "ncount"}]}], ";", 
      RowBox[{"Ksp", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rsp", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "ndof", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"shapedN", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"ele", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error, shape function dismatches the nodes\>\"", 
          "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ei", "=", 
          RowBox[{"ele", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", 
         RowBox[{"xyzi", "=", 
          RowBox[{"xyz", "[", 
           RowBox[{"[", "ei", "]"}], "]"}]}], ";", 
         RowBox[{"uvwi", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"uvw", "[", 
            RowBox[{"[", "ei", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Ri", ",", "Ki"}], "}"}], "=", 
          RowBox[{"OneElementMatrix", "[", 
           RowBox[{
           "wl", ",", "shapedN", ",", "xyzi", ",", "uvwi", ",", "Di"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"NeiI2", "=", 
          RowBox[{"NeiIIndex", "[", 
           RowBox[{"ei", ",", "ndim"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Rsp", "+=", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"NeiI2", "\[Rule]", "Ri"}], ",", 
            RowBox[{"{", "ndof", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Ksp", "+=", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tuples", "[", 
              RowBox[{"NeiI2", ",", "2"}], "]"}], "\[Rule]", 
             RowBox[{"Flatten", "[", "Ki", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Rsp", ",", "Ksp"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.7828165663448153`*^9, 3.7828166040032816`*^9}, {
   3.782816708445465*^9, 3.78281674540193*^9}, {3.782817046856859*^9, 
   3.782817433815539*^9}, {3.782817472051206*^9, 3.7828175012544575`*^9}, {
   3.782817573841385*^9, 3.7828176150878572`*^9}, 3.782817681512774*^9, {
   3.7828181152403355`*^9, 3.7828181174243393`*^9}, {3.7828181598876143`*^9, 
   3.782818508127026*^9}, {3.7831042125180955`*^9, 3.7831043095866475`*^9}, {
   3.7831044044710746`*^9, 3.7831044139146147`*^9}, 3.783104460411274*^9, {
   3.7842173850931373`*^9, 3.7842173885095434`*^9}, {3.8799948940274086`*^9, 
   3.87999489466359*^9}, {3.8922822957562013`*^9, 3.892282298332534*^9}, {
   3.8924372744371233`*^9, 3.892437331516122*^9}, 
   3.934367925922496*^9},ExpressionUUID->"5bd53094-6ac4-4dae-99ad-\
afe278fe1118"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variational damage for fractures", "Section",
 CellChangeTimes->{{3.8799956703239727`*^9, 
  3.8799956819892735`*^9}},ExpressionUUID->"d51a0621-ee14-4e7d-a5af-\
c83b945e05bb"],

Cell[CellGroupData[{

Cell["OneElementMatrixVD2d", "Subsubsection",
 CellChangeTimes->{
  3.890378640728984*^9},ExpressionUUID->"507c1f55-7ed6-4f27-a06b-\
173597077d99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OneElementMatrixVD2d0", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"wl", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapeN", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapedN", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"uv", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Hmax", ",", "_Real", ",", "1"}], "}"}], 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "Gauss", " ", "points"}], "*)"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], "}"}]}], 
      RowBox[{"(*", 
       RowBox[{"(*", 
        RowBox[{"El", ",", "nu", ",", 
         RowBox[{"type", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", 
             RowBox[{"plane", " ", "stress"}]}], ",", " ", 
            RowBox[{"1", ":", 
             RowBox[{"plane", " ", "strain"}]}]}], ")"}]}], ",", "Gc", ",", 
         "lc", ",", 
         RowBox[{"damageType", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", "tensile"}], ",", 
            RowBox[{"1", ":", "shear"}], ",", 
            RowBox[{"2", ":", "mix"}]}], ")"}]}], ",", " ", "morder", ",", 
         "HmaxCritical"}], "*)"}], "*)"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nnode", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"numN", "=", 
          RowBox[{"Length", "[", "nnode", "]"}]}], ",", "Kmat", ",", "Rmat", 
         ",", "BB", ",", "BBi", ",", "strainv", ",", "rkp", ",", "rkn", ",", 
         "hmean", ",", 
         RowBox[{"HmaxT", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "wl", "]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"detJ", "=", "0."}], ",", "Di", ",", 
         RowBox[{"alpha", "=", "1."}], ",", 
         RowBox[{"morder", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"morder", "<", "0"}], ",", 
          RowBox[{"morder", "=", "1."}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"shapedN", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
             RowBox[{"Length", "[", "nnode", "]"}]}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Error, shape function dismatchs the nodes\>\"", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"BB", "=", 
         RowBox[{"FEMGaussPointdNdXc", "[", 
          RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hmean", "=", 
         RowBox[{"Mean", "[", "Hmax", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"within", " ", "an", " ", "element"}], ",", " ", 
          RowBox[{
          "the", " ", "h", " ", "history", " ", "is", " ", "treated", " ", 
           "as", " ", "the", " ", 
           RowBox[{"same", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"hmean", "=", 
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], 
                RowBox[{"hmean", "/", 
                 RowBox[{"mat", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "morder"}], ")"}]}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "morder"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BBi", "=", 
            RowBox[{"StrainBMatrixC2", "[", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"detJ", "=", 
            RowBox[{
             RowBox[{"wl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"BB", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"strainv", "=", 
            RowBox[{"BBi", ".", "uv"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"strainv", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*=", "0.5"}], ";"}], "*)"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"strainv", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "/", "2"}], ",", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Hmax", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "<", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
                RowBox[{"EnergyDensity2Dspectral", "[", 
                 RowBox[{"strainv", ",", "mat"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
                RowBox[{"EnergyDensity2Dvoldev", "[", 
                 RowBox[{"strainv", ",", "mat"}], "]"}]}]}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
            RowBox[{"EnergyDensity2Dspectral", "[", 
             RowBox[{"strainv", ",", "mat"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"EnergyDensity2Dvoldev", "[", 
              RowBox[{"strainv", ",", "mat"}], "]"}], ";"}], "*)"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"EnergyDensity2Dspectral", "[", 
              RowBox[{"strainv", ",", "mat"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"alpha", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Hmax", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"rkp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HmaxT", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "alpha"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"alpha", "=", 
            RowBox[{"1", "/", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mat", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], 
                   RowBox[{"alpha", "/", 
                    RowBox[{"mat", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "morder"}], ")"}]}]}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"1", "+", "morder"}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "the", " ", "history", " ", "energy", " ", "depends", " ", "on", 
             " ", "one", " ", "gauss", " ", "point"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"rkp", "*=", "alpha"}], ";", 
           RowBox[{"rkp", "+=", "rkn"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Di", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "       ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "       ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "10", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rmat", "+=", 
            RowBox[{
             RowBox[{"(", "detJ", ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"BBi", "\[Transpose]"}], ".", 
               RowBox[{"rkp", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Kmat", "+=", 
            RowBox[{
             RowBox[{"BBi", "\[Transpose]"}], ".", 
             RowBox[{"(", 
              RowBox[{"detJ", "*", "Di"}], ")"}], ".", "BBi"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"Rmat", ",", 
          RowBox[{"Flatten", "[", "Kmat", "]"}], ",", "HmaxT"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OneElementMatrixVD2d", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"wl", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapeN", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapedN", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"uv", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Hmax", ",", "_Real", ",", "1"}], "}"}], 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "Gauss", " ", "points"}], "*)"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nnode", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"numN", "=", 
          RowBox[{"Length", "[", "nnode", "]"}]}], ",", "Kmat", ",", "Rmat", 
         ",", "BB", ",", "BBi", ",", "strainv", ",", "rkp", ",", "rkn", ",", 
         "hmean", ",", 
         RowBox[{"HmaxT", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "wl", "]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"detJ", "=", "0."}], ",", "Di", ",", 
         RowBox[{"alpha", "=", "1."}], ",", 
         RowBox[{"morder", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{"sdamg", "=", "0."}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"morder", "<", "0"}], ",", 
          RowBox[{"morder", "=", "1."}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BB", "=", 
         RowBox[{"FEMGaussPointdNdXc", "[", 
          RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hmean", "=", 
         RowBox[{"Mean", "[", "Hmax", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"within", " ", "an", " ", "element"}], ",", " ", 
          RowBox[{
          "the", " ", "h", " ", "history", " ", "is", " ", "treated", " ", 
           "as", " ", "the", " ", 
           RowBox[{"same", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"hmean", "=", 
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], 
                RowBox[{"hmean", "/", 
                 RowBox[{"mat", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "morder"}], ")"}]}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "morder"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"sdamg", "=", 
           RowBox[{"1", "/", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"mat", "[", 
                   RowBox[{"[", "5", "]"}], "]"}], 
                  RowBox[{"hmean", "/", 
                   RowBox[{"mat", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "morder"}], ")"}]}]}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "morder"}], ")"}]}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BBi", "=", 
            RowBox[{"StrainBMatrixC2", "[", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"detJ", "=", 
            RowBox[{
             RowBox[{"wl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"BB", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"strainv", "=", 
            RowBox[{"BBi", ".", "uv"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
            RowBox[{"EnergyDensity2Dspectral", "[", 
             RowBox[{"strainv", ",", "mat"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"EnergyDensity2Dvoldev", "[", 
              RowBox[{"strainv", ",", "mat"}], "]"}], ";"}], "*)"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"EnergyDensity2Dspectral", "[", 
              RowBox[{"strainv", ",", "mat"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"alpha", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Hmax", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"rkp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HmaxT", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "alpha"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rkp", "*=", "hmean"}], ";", 
           RowBox[{"(*", 
            RowBox[{"alpha", ";"}], "*)"}], 
           RowBox[{"rkp", "+=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"hmean", ">", "0.1"}], ",", "rkn", ",", 
              RowBox[{"hmean", "*", "rkn"}]}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"0.1", "-", "0.8"}], ",", " ", 
             RowBox[{
             "the", " ", "crack", " ", "paths", " ", "of", " ", "notched", 
              " ", "plate", " ", "under", " ", "shear", " ", "BC", " ", "are",
               " ", "almost", " ", "the", " ", 
              RowBox[{"same", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Di", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "       ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "       ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "10", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rmat", "+=", 
            RowBox[{
             RowBox[{"(", "detJ", ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"BBi", "\[Transpose]"}], ".", 
               RowBox[{"rkp", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Kmat", "+=", 
            RowBox[{
             RowBox[{"BBi", "\[Transpose]"}], ".", 
             RowBox[{"(", 
              RowBox[{"detJ", "*", "Di"}], ")"}], ".", "BBi"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"Rmat", ",", 
          RowBox[{"Flatten", "[", "Kmat", "]"}], ",", "HmaxT"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OneElementMatrixVD3d", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"wl", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapeN", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapedN", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"uv", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Hmax", ",", "_Real", ",", "1"}], "}"}], 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "Gauss", " ", "points"}], "*)"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], "}"}]}], 
      RowBox[{"(*", 
       RowBox[{"(*", 
        RowBox[{"El", ",", "nu", ",", 
         RowBox[{"type", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", 
             RowBox[{"plane", " ", "stress"}]}], ",", " ", 
            RowBox[{"1", ":", 
             RowBox[{"plane", " ", "strain"}]}]}], ")"}]}], ",", "Gc", ",", 
         "lc", ",", 
         RowBox[{"damageType", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", "tensile"}], ",", 
            RowBox[{"1", ":", "shear"}], ",", 
            RowBox[{"2", ":", "mix"}]}], ")"}]}], ",", " ", "morder", ",", 
         "HmaxCritical"}], "*)"}], "*)"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nnode", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"phie", "=", "0."}], ",", 
         RowBox[{"numN", "=", 
          RowBox[{"Length", "[", "nnode", "]"}]}], ",", "hmean", ",", "Kmat", 
         ",", "Rmat", ",", "BB", ",", "BBi", ",", "strainv", ",", "rkp", ",", 
         "rkn", ",", 
         RowBox[{"HmaxT", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "wl", "]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"detJ", "=", "0."}], ",", "Di", ",", 
         RowBox[{"alpha", "=", "1."}], ",", 
         RowBox[{"morder", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"morder", "<", "0"}], ",", 
          RowBox[{"morder", "=", "1."}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"shapedN", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
             RowBox[{"Length", "[", "nnode", "]"}]}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Error, shape function dismatchs the nodes\>\"", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"BB", "=", 
         RowBox[{"FEMGaussPointdNdXc", "[", 
          RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hmean", "=", 
         RowBox[{"Mean", "[", "Hmax", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"within", " ", "an", " ", "element"}], ",", 
          RowBox[{
          "the", " ", "h", " ", "history", " ", "is", " ", "treated", " ", 
           "as", " ", "the", " ", 
           RowBox[{"same", "."}]}]}], "*)"}], 
        RowBox[{"hmean", "=", 
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], " ", 
                RowBox[{"hmean", "/", 
                 RowBox[{"mat", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "morder"}], ")"}]}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "morder"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BBi", "=", 
            RowBox[{"StrainBMatrixC2", "[", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"detJ", "=", 
            RowBox[{
             RowBox[{"wl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"BB", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"strainv", "=", 
            RowBox[{"BBi", ".", "uv"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"phie", "=", 
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", 
             RowBox[{
              RowBox[{"mat", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"2", 
                   RowBox[{"mat", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"mat", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"mat", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", 
                  RowBox[{
                   RowBox[{"strainv", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"4", 
                   RowBox[{"mat", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "-", 
               RowBox[{"4", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "-", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], "-", 
               RowBox[{"4", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], " ", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], "^", "2"}], "-", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "6", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"strainv", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "+", 
                  RowBox[{"strainv", "[", 
                   RowBox[{"[", "6", "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"phie", ">", 
              RowBox[{"mat", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
               RowBox[{"EnergyDensity3Dspectral", "[", 
                RowBox[{"strainv", ",", "mat"}], "]"}]}], ";"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
              RowBox[{"EnergyDensity3D", "[", 
               RowBox[{"strainv", ",", "mat"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"alpha", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Hmax", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"rkp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HmaxT", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "alpha"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rkp", "*=", "hmean"}], 
           RowBox[{"(*", "alpha", "*)"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"hmean", "<", "0.2"}], ",", 
             RowBox[{"rkn", "*=", "hmean"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"rkp", "+=", "rkn"}], ";", 
           RowBox[{"rkp", "*=", "detJ"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Di", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "11", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "12", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "13", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "14", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "15", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "16", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "17", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "18", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "15", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "19", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "20", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "21", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "22", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "11", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "16", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "20", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "23", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "24", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "25", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "12", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "17", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "21", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "24", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "26", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "27", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "13", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "18", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "22", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "25", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "27", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "28", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rmat", "+=", 
            RowBox[{
             RowBox[{"BBi", "\[Transpose]"}], ".", 
             RowBox[{"rkp", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", "7"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Kmat", "+=", 
            RowBox[{
             RowBox[{"BBi", "\[Transpose]"}], ".", "Di", ".", "BBi"}]}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"Rmat", ",", 
          RowBox[{"Flatten", "[", "Kmat", "]"}], ",", "HmaxT"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"WeakPlane2D", ",", "_Real", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"StrainBMatrixC", ",", "_Real", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"MaximalEnergyDirection2D", ",", "_Real", ",", "1"}], 
          "}"}]}], "}"}], ","}], "*)"}], 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7938098130857973`*^9, 3.7938098314888496`*^9}, {
   3.7938098959005337`*^9, 3.793809908350246*^9}, {3.879995780874137*^9, 
   3.8799957886485023`*^9}, {3.880008063719676*^9, 3.8800081719442616`*^9}, {
   3.8800083730433187`*^9, 3.88000840594057*^9}, {3.8800084391790504`*^9, 
   3.8800084650975676`*^9}, {3.8800115608582306`*^9, 3.880011566169207*^9}, {
   3.8800116154605193`*^9, 3.8800116802412925`*^9}, {3.8800117433514795`*^9, 
   3.8800117898098583`*^9}, {3.880011845799402*^9, 3.8800118649825697`*^9}, {
   3.8800120926551833`*^9, 3.880012134798064*^9}, {3.880012181751114*^9, 
   3.8800122267375507`*^9}, {3.8800122938665*^9, 3.880012376569397*^9}, {
   3.880012414666976*^9, 3.8800125088217955`*^9}, {3.880012549268815*^9, 
   3.880012643594427*^9}, {3.880012674710266*^9, 3.880012748685611*^9}, {
   3.8800128087525496`*^9, 3.880012930822706*^9}, {3.8800129616828766`*^9, 
   3.88001303141466*^9}, {3.880013078193327*^9, 3.8800130796641307`*^9}, {
   3.8800131384087124`*^9, 3.880013260975525*^9}, {3.8800132959167533`*^9, 
   3.880013335545518*^9}, {3.8800134001288652`*^9, 3.880013409828856*^9}, {
   3.880085899071453*^9, 3.8800859010934234`*^9}, {3.880086228305874*^9, 
   3.8800862540199823`*^9}, {3.8800956793779063`*^9, 
   3.8800956856072083`*^9}, {3.8800957650512915`*^9, 3.880095804005884*^9}, {
   3.880095847235784*^9, 3.8800958732014666`*^9}, {3.880359208646453*^9, 
   3.880359303253206*^9}, {3.880515691874874*^9, 3.8805158508754315`*^9}, 
   3.880515977876183*^9, {3.880516395607503*^9, 3.8805164276602693`*^9}, {
   3.8805165480870743`*^9, 3.880516554583173*^9}, {3.8805265562787437`*^9, 
   3.8805265579327393`*^9}, {3.8805271966278343`*^9, 3.880527196852352*^9}, {
   3.8805373768779*^9, 3.8805373875516524`*^9}, {3.880537641848708*^9, 
   3.8805376426735163`*^9}, {3.8805392209120717`*^9, 
   3.8805392428115053`*^9}, {3.880540529703904*^9, 3.8805405431702695`*^9}, {
   3.8805429407934427`*^9, 3.880542945238079*^9}, {3.8806480236787553`*^9, 
   3.880648118998445*^9}, {3.8806481714467483`*^9, 3.8806482301994734`*^9}, 
   3.880684109333274*^9, {3.8820983295770736`*^9, 3.882098335233562*^9}, {
   3.8820984724507437`*^9, 3.882098521807367*^9}, {3.88209858596352*^9, 
   3.8820985930869484`*^9}, {3.8820986651690197`*^9, 3.882098671104233*^9}, {
   3.882098800651775*^9, 3.8820988469127455`*^9}, {3.882105858283155*^9, 
   3.882105867906281*^9}, {3.882110514750512*^9, 3.8821105186557517`*^9}, {
   3.8821162123223763`*^9, 3.882116224179927*^9}, 3.8824369010910673`*^9, {
   3.883889578502389*^9, 3.883889683137268*^9}, 3.883890998934654*^9, {
   3.889066373021535*^9, 3.88906637361901*^9}, {3.8896016278111095`*^9, 
   3.889601633793331*^9}, {3.8903785665833125`*^9, 3.890378569766759*^9}, {
   3.892286552518756*^9, 3.8922865736212482`*^9}, {3.892286679381877*^9, 
   3.892286681740097*^9}, {3.8922867512864075`*^9, 3.892286818474506*^9}, 
   3.8923541201667185`*^9, 3.892364185726424*^9, {3.8923658603635235`*^9, 
   3.892365869627006*^9}, {3.8923661133339486`*^9, 3.8923661481531343`*^9}, {
   3.8924415959017115`*^9, 3.892441603282154*^9}, 3.8924421714790444`*^9, {
   3.8925511605133667`*^9, 3.8925511667467484`*^9}, {3.898934722585098*^9, 
   3.8989347514592156`*^9}, {3.8990052729598923`*^9, 
   3.8990052862135725`*^9}, {3.8990053351779923`*^9, 
   3.8990054007180023`*^9}, {3.8993462475897694`*^9, 
   3.8993462742856565`*^9}, {3.899346384312991*^9, 3.899346399382118*^9}, {
   3.8993465503823433`*^9, 3.899346561895838*^9}, {3.8993468226861486`*^9, 
   3.8993468252759166`*^9}, {3.8993468645014424`*^9, 3.89934694042422*^9}, {
   3.8993479277700663`*^9, 3.899347952091982*^9}, 3.899348108579239*^9, {
   3.8994366686274014`*^9, 3.8994366785282373`*^9}, {3.899436741777466*^9, 
   3.899436748465228*^9}, {3.900576398212392*^9, 3.9005764203618345`*^9}, 
   3.9005764514469852`*^9, {3.9005767435130606`*^9, 3.900576802546671*^9}, {
   3.9005782274807262`*^9, 3.9005782343572845`*^9}, 3.90059307248701*^9, 
   3.900593556674918*^9, 3.9005939068110423`*^9, {3.9005948559927797`*^9, 
   3.900594890477009*^9}, {3.900853151628441*^9, 3.900853231105332*^9}, {
   3.9343671800182705`*^9, 3.934367200292954*^9}, {3.934367882403389*^9, 
   3.9343678980568533`*^9}, {3.934369935200218*^9, 3.9343699629626865`*^9}, {
   3.934374110023034*^9, 
   3.9343741256479793`*^9}},ExpressionUUID->"602e8b66-1cb6-4e6d-bf47-\
133869076448"]
}, Open  ]],

Cell[CellGroupData[{

Cell["(*Variational damage model with/without threshold value*)", \
"Subsubsection",
 CellChangeTimes->{{3.9072283130595036`*^9, 3.907228360787678*^9}, 
   3.934374136916897*^9},ExpressionUUID->"c4fc7ab4-cf7b-42a9-9b93-\
cbf67d6efad6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DamageValueSR", "[", 
   RowBox[{"Hmax_", ",", "lp_", ",", "gc_", ",", "vdT_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sValue", ",", "rValue", ",", "tempValue"}], "}"}], ",", 
    RowBox[{
     RowBox[{"tempValue", "=", 
      RowBox[{"Hmax", " ", 
       RowBox[{"lp", "/", "gc"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Abs", "[", "vdT", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"vdT", "<", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{
         "damage", " ", "model", " ", "without", " ", "treshold", " ", 
          "value"}], ")"}], "*)"}], " ", 
       RowBox[{
        RowBox[{"sValue", "=", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"lp", " ", 
              RowBox[{"Hmax", "/", "gc"}]}], ")"}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Power", "[", 
             RowBox[{
              RowBox[{"lp", " ", 
               RowBox[{"Hmax", "/", "gc"}]}], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rValue", "=", 
         RowBox[{"1", "/", 
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"lp", " ", 
                RowBox[{"Hmax", "/", "gc"}]}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ",", 
            RowBox[{"1", "-", "vdT"}]}], "]"}]}]}], ";"}], ",", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{
         "damage", " ", "model", " ", "with", " ", "treshold", " ", "value"}],
          ")"}], "*)"}], " ", 
       RowBox[{
        RowBox[{"sValue", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tempValue", "<=", "1."}], ",", "0.", ",", 
           RowBox[{"1", "-", 
            RowBox[{"Power", "[", 
             RowBox[{"tempValue", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rValue", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tempValue", "<=", "1."}], ",", "1.", ",", 
           RowBox[{"Power", "[", 
            RowBox[{"tempValue", ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"vdT", "+", "1"}], ")"}]}], "/", "vdT"}]}], "]"}]}], 
          "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"sValue", ",", "rValue"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907228363859166*^9, 3.907228381187592*^9}, {
  3.9072284178342624`*^9, 3.9072284321444798`*^9}, {3.9343678714181333`*^9, 
  3.9343678765927925`*^9}},ExpressionUUID->"43eba3cf-c3ab-4855-be6a-\
01346e24caf6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OneElementMatrixVD2dOrder", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"wl", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapeN", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapedN", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"uv", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Hmax", ",", "_Real", ",", "1"}], "}"}], 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "Gauss", " ", "points"}], "*)"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], "}"}]}], 
      RowBox[{"(*", 
       RowBox[{"(*", 
        RowBox[{"El", ",", "nu", ",", 
         RowBox[{"type", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", 
             RowBox[{"plane", " ", "stress"}]}], ",", " ", 
            RowBox[{"1", ":", 
             RowBox[{"plane", " ", "strain"}]}]}], ")"}]}], ",", "Gc", ",", 
         "lc", ",", 
         RowBox[{"damageType", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", "tensile"}], ",", 
            RowBox[{"1", ":", "shear"}], ",", 
            RowBox[{"2", ":", "mix"}]}], ")"}]}], ",", " ", "morder", ",", 
         "HmaxCritical"}], "*)"}], "*)"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nnode", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"numN", "=", 
          RowBox[{"Length", "[", "nnode", "]"}]}], ",", "Kmat", ",", "Rmat", 
         ",", "BB", ",", "BBi", ",", "strainv", ",", "rkp", ",", "rkn", ",", 
         "hmean", ",", 
         RowBox[{"HmaxT", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "wl", "]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"detJ", "=", "0."}], ",", "Di", ",", 
         RowBox[{"alpha", "=", "1."}], ",", 
         RowBox[{"vdT", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{"sdamg", "=", "0."}], ",", 
         RowBox[{"gc", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"lp", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", "tempValue", ",", "sValue", 
         ",", "rValue"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"morder", "<", "0"}], ",", 
           RowBox[{"morder", "=", "1."}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Kmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BB", "=", 
         RowBox[{"FEMGaussPointdNdXc", "[", 
          RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hmean", "=", 
         RowBox[{"Mean", "[", "Hmax", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"within", " ", "an", " ", "element"}], ",", " ", 
          RowBox[{
          "the", " ", "h", " ", "is", " ", "treated", " ", "as", " ", "the", 
           " ", 
           RowBox[{"same", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"tempValue", "=", 
         RowBox[{"hmean", " ", 
          RowBox[{"lp", "/", "gc"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Abs", "[", "vdT", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vdT", "<", "0"}], ",", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{
            "damage", " ", "model", " ", "without", " ", "treshold", " ", 
             "value"}], ")"}], "*)"}], "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"sValue", "=", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"lp", " ", 
                 RowBox[{"hmean", "/", "gc"}]}], ")"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"lp", " ", 
                  RowBox[{"hmean", "/", "gc"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ")"}]}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"rValue", "=", 
            RowBox[{"1", "/", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"1", "+", 
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"lp", " ", 
                   RowBox[{"hmean", "/", "gc"}]}], ",", 
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ",", 
               RowBox[{"1", "-", "vdT"}]}], "]"}]}]}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{
            "damage", " ", "model", " ", "with", " ", "treshold", " ", 
             "value"}], ")"}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sValue", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"tempValue", "<=", "1."}], ",", "0.", ",", 
              RowBox[{"1", "-", 
               RowBox[{"Power", "[", 
                RowBox[{"tempValue", ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"rValue", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"tempValue", "<=", "1."}], ",", "1.", ",", 
              RowBox[{"Power", "[", 
               RowBox[{"tempValue", ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"vdT", "+", "1"}], ")"}]}], "/", "vdT"}]}], 
               "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BBi", "=", 
            RowBox[{"StrainBMatrixC2", "[", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"detJ", "=", 
            RowBox[{
             RowBox[{"wl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"BB", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"strainv", "=", 
            RowBox[{"BBi", ".", "uv"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
            RowBox[{"EnergyDensity2Dspectral", "[", 
             RowBox[{"strainv", ",", "mat"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"alpha", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Hmax", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"rkp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HmaxT", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "alpha"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"alpha", "=", 
              RowBox[{"1", "/", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mat", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], 
                    RowBox[{"alpha", "/", 
                    RowBox[{"mat", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "/", "morder"}], ")"}]}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "morder"}], ")"}]}]}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"rkp", "*=", "rValue"}], ";", 
           RowBox[{"(*", 
            RowBox[{"alpha", ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rkp", "+=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"sValue", "<", "0.7"}], ",", "rkn", ",", 
              RowBox[{"rValue", "*", "rkn"}]}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"0.1", "-", "0.8"}], ",", " ", 
             RowBox[{
             "the", " ", "crack", " ", "paths", " ", "of", " ", "notched", 
              " ", "plate", " ", "under", " ", "shear", " ", "BC", " ", "are",
               " ", "almost", " ", "the", " ", 
              RowBox[{"same", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Di", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "       ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "       ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "10", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rmat", "+=", 
            RowBox[{
             RowBox[{"(", "detJ", ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"BBi", "\[Transpose]"}], ".", 
               RowBox[{"rkp", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Kmat", "+=", 
            RowBox[{
             RowBox[{"BBi", "\[Transpose]"}], ".", 
             RowBox[{"(", 
              RowBox[{"detJ", "*", "Di"}], ")"}], ".", "BBi"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"Rmat", ",", 
          RowBox[{"Flatten", "[", "Kmat", "]"}], ",", "HmaxT"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OneElementMatrixVD3dOrder", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"wl", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapeN", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapedN", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"uv", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Hmax", ",", "_Real", ",", "1"}], "}"}], 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "Gauss", " ", "points"}], "*)"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"mat", ",", "_Real", ",", "1"}], "}"}]}], 
      RowBox[{"(*", 
       RowBox[{"(*", 
        RowBox[{"El", ",", "nu", ",", 
         RowBox[{"type", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", 
             RowBox[{"plane", " ", "stress"}]}], ",", " ", 
            RowBox[{"1", ":", 
             RowBox[{"plane", " ", "strain"}]}]}], ")"}]}], ",", "Gc", ",", 
         "lc", ",", 
         RowBox[{"damageType", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", ":", "tensile"}], ",", 
            RowBox[{"1", ":", "shear"}], ",", 
            RowBox[{"2", ":", "mix"}]}], ")"}]}], ",", " ", "morder", ",", 
         "HmaxCritical"}], "*)"}], "*)"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nnode", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"phie", "=", "0."}], ",", 
         RowBox[{"numN", "=", 
          RowBox[{"Length", "[", "nnode", "]"}]}], ",", "hmean", ",", "Kmat", 
         ",", "Rmat", ",", "BB", ",", "BBi", ",", "strainv", ",", "rkp", ",", 
         "rkn", ",", 
         RowBox[{"HmaxT", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "wl", "]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"detJ", "=", "0."}], ",", "Di", ",", 
         RowBox[{"alpha", "=", "1."}], ",", 
         RowBox[{"vdT", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{"sdamg", "=", "0."}], ",", 
         RowBox[{"gc", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"lp", "=", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", "tempValue", ",", "sValue", 
         ",", "rValue"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Kmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"ndim", " ", "numN"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"shapedN", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
             RowBox[{"Length", "[", "nnode", "]"}]}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Error, shape function dismatchs the nodes\>\"", "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"BB", "=", 
         RowBox[{"FEMGaussPointdNdXc", "[", 
          RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hmean", "=", 
         RowBox[{"Mean", "[", "Hmax", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"within", " ", "an", " ", "element"}], ",", 
          RowBox[{
          "the", " ", "h", " ", "history", " ", "is", " ", "treated", " ", 
           "as", " ", "the", " ", 
           RowBox[{"same", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tempValue", "=", 
         RowBox[{"hmean", " ", 
          RowBox[{"lp", "/", "gc"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Abs", "[", "vdT", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vdT", "<", "0"}], ",", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{
            "damage", " ", "model", " ", "without", " ", "treshold", " ", 
             "value"}], ")"}], "*)"}], "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"sValue", "=", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"lp", " ", 
                 RowBox[{"hmean", "/", "gc"}]}], ")"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"lp", " ", 
                  RowBox[{"hmean", "/", "gc"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ")"}]}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"rValue", "=", 
            RowBox[{"1", "/", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"1", "+", 
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"lp", " ", 
                   RowBox[{"hmean", "/", "gc"}]}], ",", 
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ",", 
               RowBox[{"1", "-", "vdT"}]}], "]"}]}]}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{
            "damage", " ", "model", " ", "with", " ", "treshold", " ", 
             "value"}], ")"}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sValue", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"tempValue", "<=", "1."}], ",", "0.", ",", 
              RowBox[{"1", "-", 
               RowBox[{"Power", "[", 
                RowBox[{"tempValue", ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"rValue", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"tempValue", "<=", "1."}], ",", "1.", ",", 
              RowBox[{"Power", "[", 
               RowBox[{"tempValue", ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"vdT", "+", "1"}], ")"}]}], "/", "vdT"}]}], 
               "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BBi", "=", 
            RowBox[{"StrainBMatrixC2", "[", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"detJ", "=", 
            RowBox[{
             RowBox[{"wl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"BB", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"strainv", "=", 
            RowBox[{"BBi", ".", "uv"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"phie", "=", 
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", 
             RowBox[{
              RowBox[{"mat", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"2", 
                   RowBox[{"mat", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"mat", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"mat", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", 
                  RowBox[{
                   RowBox[{"strainv", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"4", 
                   RowBox[{"mat", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "-", 
               RowBox[{"4", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "-", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], "-", 
               RowBox[{"4", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], " ", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], "^", "2"}], "-", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"strainv", "[", 
                  RowBox[{"[", "6", "]"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", 
                RowBox[{"mat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"strainv", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "+", 
                  RowBox[{"strainv", "[", 
                   RowBox[{"[", "6", "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"phie", ">", 
              RowBox[{"mat", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
               RowBox[{"EnergyDensity3Dspectral", "[", 
                RowBox[{"strainv", ",", "mat"}], "]"}]}], ";"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"rkp", ",", "rkn"}], "}"}], "=", 
              RowBox[{"EnergyDensity3D", "[", 
               RowBox[{"strainv", ",", "mat"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"alpha", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Hmax", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"rkp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HmaxT", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "alpha"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"rkp", "*=", "rValue"}], ";", 
           RowBox[{"(*", 
            RowBox[{"alpha", ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rkp", "+=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"sValue", "<", "0.7"}], ",", "rkn", ",", 
              RowBox[{"rValue", "*", "rkn"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"rkp", "+=", "rkn"}], ";", 
           RowBox[{"rkp", "*=", "detJ"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Di", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "11", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "12", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "13", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "14", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "15", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "16", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "17", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "18", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "15", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "19", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "20", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "21", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "22", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "11", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "16", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "20", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "23", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "24", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "25", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "12", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "17", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "21", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "24", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "26", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "27", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "13", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "18", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "22", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "25", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "27", "]"}], "]"}], ",", 
                RowBox[{"rkp", "[", 
                 RowBox[{"[", "28", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rmat", "+=", 
            RowBox[{
             RowBox[{"BBi", "\[Transpose]"}], ".", 
             RowBox[{"rkp", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", "7"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Kmat", "+=", 
            RowBox[{
             RowBox[{"BBi", "\[Transpose]"}], ".", "Di", ".", "BBi"}]}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"Rmat", ",", 
          RowBox[{"Flatten", "[", "Kmat", "]"}], ",", "HmaxT"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.90722818220978*^9, 3.9072281945900803`*^9}, 
   3.907228246879617*^9, {3.9072282993833947`*^9, 3.9072282998877535`*^9}, {
   3.907228458077487*^9, 3.9072285620767093`*^9}, {3.9072286029466643`*^9, 
   3.9072287271662216`*^9}, {3.9072288442178307`*^9, 3.907228847945509*^9}, {
   3.9072289207151804`*^9, 3.9072289595287247`*^9}, {3.9072289923948083`*^9, 
   3.9072289947869663`*^9}, {3.934367778810878*^9, 
   3.9343678636693673`*^9}},ExpressionUUID->"a9e218c3-15c8-4cd7-b092-\
14cf677fcb39"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FemAllMatrixVD2d for one type of energy decomposition", "Subsection",
 CellChangeTimes->{{3.890378574681302*^9, 
  3.8903785901678433`*^9}},ExpressionUUID->"da2ab995-6ed1-434a-bb5b-\
73b4a516b76a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FemAllMatrixVD2d", "[", 
    RowBox[{
    "wl_", ",", "shapeN_", ",", "shapedN_", ",", "xyz_", ",", "uvw_", ",", 
     "HmaxAll_", ",", "ele_", ",", "mat_", ",", "Rindex_", ",", "Kindex_", 
     ",", "OneElementMatrixVD2d_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ncount", "=", 
        RowBox[{"Length", "[", "xyz", "]"}]}], ",", 
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "ndof", ",", "Ksp", 
       ",", "Rsp", ",", "ei", ",", "xyzi", ",", "uvwi", ",", "NeiI2", ",", 
       "RKH", ",", "Ki", ",", "Ri", ",", "HmaxAllnew", ",", "HmaxAll2"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"ndof", "=", 
       RowBox[{"ndim", " ", "ncount"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Ksp", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rsp", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "ndof", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Hdirect", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "ele", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "wl", "]"}], "}"}], ",", 
           RowBox[{"{", "hlen", "}"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"shapedN", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"ele", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error, shape function dismatches the nodes\>\"", 
          "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"xyzi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xyz", "[", 
          RowBox[{"[", 
           RowBox[{"ele", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uvwi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uvw", "[", 
           RowBox[{"[", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"HmaxAll2", "=", "HmaxAll"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RKH", "=", 
       RowBox[{"OneElementMatrixVD2d", "[", 
        RowBox[{
        "wl", ",", "shapeN", ",", "shapedN", ",", "xyzi", ",", "uvwi", ",", 
         "HmaxAll2", ",", "mat"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HmaxAllnew", "=", 
       RowBox[{"RKH", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{"Length", "[", "wl", "]"}]}], ";;", 
           RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"HmaxAllnew", "[", 
          RowBox[{"[", 
           RowBox[{"nright", ",", "All"}], "]"}], "]"}], "=", "0."}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"RKH", "=", 
       RowBox[{"RKH", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", 
              RowBox[{"Length", "[", "wl", "]"}]}], "-", "1"}], ")"}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "1", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ri", ",", "Ki"}], "}"}], "=", 
       RowBox[{"RKextractFEM", "[", 
        RowBox[{"RKH", ",", "ele", ",", 
         RowBox[{"Length", "[", "Rindex", "]"}], ",", 
         RowBox[{"Length", "[", "Kindex", "]"}], ",", "ndim"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "2", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Rsp", "=", 
       RowBox[{"matrixAssembly", "[", 
        RowBox[{"Ri", ",", "Rindex", ",", "ndof"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "3", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Ksp", "=", 
       RowBox[{"matrixAssembly", "[", 
        RowBox[{"Ki", ",", "Kindex", ",", 
         RowBox[{"{", 
          RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "4", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Rsp", ",", "Ksp", ",", "HmaxAllnew"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FemAllMatrixVD2d", "[", 
    RowBox[{
    "wl_", ",", "shapeN_", ",", "shapedN_", ",", "xyz_", ",", "uvw_", ",", 
     "HmaxAll_", ",", "ele_", ",", "mat_", ",", "Rindex_", ",", "Kindex_", 
     ",", "OneElementMatrixVD2d_", ",", "bcTime_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ncount", "=", 
        RowBox[{"Length", "[", "xyz", "]"}]}], ",", 
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "ndof", ",", "Ksp", 
       ",", "Rsp", ",", "ei", ",", "xyzi", ",", "uvwi", ",", "NeiI2", ",", 
       "RKH", ",", "Ki", ",", "Ri", ",", "HmaxAllnew", ",", "HmaxAll2"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"ndof", "=", 
       RowBox[{"ndim", " ", "ncount"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Ksp", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rsp", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "ndof", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Hdirect", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "ele", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "wl", "]"}], "}"}], ",", 
           RowBox[{"{", "hlen", "}"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"shapedN", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"ele", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error, shape function dismatches the nodes\>\"", 
          "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"xyzi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xyz", "[", 
          RowBox[{"[", 
           RowBox[{"ele", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uvwi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uvw", "[", 
           RowBox[{"[", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"HmaxAll2", "=", "HmaxAll"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"RKH", "=", 
       RowBox[{"OneElementMatrixVD2d", "[", 
        RowBox[{
        "wl", ",", "shapeN", ",", "shapedN", ",", "xyzi", ",", "uvwi", ",", 
         "HmaxAll2", ",", "mat", ",", "bcTime"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"HmaxAllnew", "=", 
       RowBox[{"RKH", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{"Length", "[", "wl", "]"}]}], ";;", 
           RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"HmaxAllnew", "[", 
          RowBox[{"[", 
           RowBox[{"nright", ",", "All"}], "]"}], "]"}], "=", "0."}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"RKH", "=", 
       RowBox[{"RKH", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", 
              RowBox[{"Length", "[", "wl", "]"}]}], "-", "1"}], ")"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ri", ",", "Ki"}], "}"}], "=", 
       RowBox[{"RKextractFEM", "[", 
        RowBox[{"RKH", ",", "ele", ",", 
         RowBox[{"Length", "[", "Rindex", "]"}], ",", 
         RowBox[{"Length", "[", "Kindex", "]"}], ",", "ndim"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Rsp", "=", 
       RowBox[{"matrixAssembly", "[", 
        RowBox[{"Ri", ",", "Rindex", ",", "ndof"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ksp", "=", 
       RowBox[{"matrixAssembly", "[", 
        RowBox[{"Ki", ",", "Kindex", ",", 
         RowBox[{"{", 
          RowBox[{"ndof", ",", "ndof"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Rsp", ",", "Ksp", ",", "HmaxAllnew"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7938098130857973`*^9, 3.7938098314888496`*^9}, {
   3.7938098959005337`*^9, 3.793809908350246*^9}, {3.879995780874137*^9, 
   3.8799957886485023`*^9}, {3.880008063719676*^9, 3.8800081719442616`*^9}, {
   3.8800083730433187`*^9, 3.88000840594057*^9}, {3.8800084391790504`*^9, 
   3.8800084650975676`*^9}, {3.8800115608582306`*^9, 3.880011566169207*^9}, {
   3.8800116154605193`*^9, 3.8800116802412925`*^9}, {3.8800117433514795`*^9, 
   3.8800117898098583`*^9}, {3.880011845799402*^9, 3.8800118649825697`*^9}, {
   3.8800120926551833`*^9, 3.880012134798064*^9}, {3.880012181751114*^9, 
   3.8800122267375507`*^9}, {3.8800122938665*^9, 3.880012376569397*^9}, {
   3.880012414666976*^9, 3.8800125088217955`*^9}, {3.880012549268815*^9, 
   3.880012643594427*^9}, {3.880012674710266*^9, 3.880012748685611*^9}, {
   3.8800128087525496`*^9, 3.880012930822706*^9}, {3.8800129616828766`*^9, 
   3.88001303141466*^9}, {3.880013078193327*^9, 3.8800130796641307`*^9}, {
   3.8800131384087124`*^9, 3.880013260975525*^9}, {3.8800132959167533`*^9, 
   3.880013335545518*^9}, {3.8800134001288652`*^9, 3.880013409828856*^9}, {
   3.880085899071453*^9, 3.8800859010934234`*^9}, {3.880086228305874*^9, 
   3.8800862540199823`*^9}, {3.8800956793779063`*^9, 
   3.8800956856072083`*^9}, {3.8800957650512915`*^9, 3.880095804005884*^9}, {
   3.880095847235784*^9, 3.8800958732014666`*^9}, {3.880359208646453*^9, 
   3.880359303253206*^9}, {3.880515691874874*^9, 3.8805158508754315`*^9}, 
   3.880515977876183*^9, {3.880516395607503*^9, 3.8805164276602693`*^9}, {
   3.8805165480870743`*^9, 3.880516554583173*^9}, {3.8805265562787437`*^9, 
   3.8805265579327393`*^9}, {3.8805271966278343`*^9, 3.880527196852352*^9}, {
   3.8805373768779*^9, 3.8805373875516524`*^9}, {3.880537641848708*^9, 
   3.8805376426735163`*^9}, {3.8805392209120717`*^9, 
   3.8805392428115053`*^9}, {3.880540529703904*^9, 3.8805405431702695`*^9}, {
   3.8805429407934427`*^9, 3.880542945238079*^9}, {3.8806480236787553`*^9, 
   3.880648118998445*^9}, {3.8806481714467483`*^9, 3.8806482301994734`*^9}, 
   3.880684109333274*^9, {3.8820983295770736`*^9, 3.882098335233562*^9}, {
   3.8820984724507437`*^9, 3.882098521807367*^9}, {3.88209858596352*^9, 
   3.8820985930869484`*^9}, {3.8820986651690197`*^9, 3.882098671104233*^9}, {
   3.882098800651775*^9, 3.8820988469127455`*^9}, {3.882105858283155*^9, 
   3.882105867906281*^9}, {3.882110514750512*^9, 3.8821105186557517`*^9}, {
   3.8821162123223763`*^9, 3.882116224179927*^9}, 3.8824369010910673`*^9, {
   3.883889578502389*^9, 3.883889683137268*^9}, 3.883890998934654*^9, {
   3.889066373021535*^9, 3.88906637361901*^9}, {3.8896016278111095`*^9, 
   3.889601633793331*^9}, {3.8903785665833125`*^9, 3.890378569766759*^9}, {
   3.8956435120624475`*^9, 3.895643528668105*^9}, 3.8987477254277678`*^9, {
   3.8993481519905186`*^9, 3.8993481893687196`*^9}, 3.89934836111019*^9, 
   3.8993483978911333`*^9, 3.8993484468342075`*^9, {3.89989629907974*^9, 
   3.899896300174733*^9}, {3.8998974928138475`*^9, 3.8998975383678007`*^9}, {
   3.8998975726193633`*^9, 3.899897606284584*^9}, {3.8998976507695527`*^9, 
   3.899897704214789*^9}, {3.9001289702829266`*^9, 3.9001289793779984`*^9}, {
   3.900129276012484*^9, 3.9001292835322666`*^9}, {3.9003191795549774`*^9, 
   3.900319211146897*^9}, 3.9003361728451724`*^9, 3.900474856245825*^9, 
   3.9010154386956625`*^9, {3.934369980881585*^9, 
   3.9343699956994343`*^9}},ExpressionUUID->"90aaec32-efda-4813-aaef-\
4f494157e2e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FemAllElementStrain", "[", 
    RowBox[{
    "wl_", ",", "shapeN_", ",", "shapedN_", ",", "xyz_", ",", "uvw_", ",", 
     "ele_", ",", "OneElementMatrix2Dstrain_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ncount", "=", 
        RowBox[{"Length", "[", "xyz", "]"}]}], ",", 
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "ndof", ",", "ei", 
       ",", "xyzi", ",", "uvwi"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ndof", "=", 
       RowBox[{"ndim", " ", "ncount"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"shapedN", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"ele", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, shape function mismatched with the nodes\>\"", "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"xyzi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xyz", "[", 
          RowBox[{"[", 
           RowBox[{"ele", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uvwi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uvw", "[", 
           RowBox[{"[", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"OneElementMatrix2Dstrain", "[", 
       RowBox[{
       "wl", ",", "shapeN", ",", "shapedN", ",", "xyzi", ",", "uvwi"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OneElementMatrix2Dstrain", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"wl", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapeN", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"shapedN", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nnode", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"uv", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nnode", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"numN", "=", 
          RowBox[{"Length", "[", "nnode", "]"}]}], ",", "BB", ",", "BBi", ",",
          "strainv", ",", "rkp", ",", "rkn", ",", "res", ",", 
         RowBox[{"Hstrain", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", 
             RowBox[{"3", " ", 
              RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}]}]}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BB", "=", 
         RowBox[{"FEMGaussPointdNdXc", "[", 
          RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BBi", "=", 
            RowBox[{"StrainBMatrixC2", "[", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"strainv", "=", 
            RowBox[{"BBi", ".", "uv"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"strainv", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"strainv", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Hstrain", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "3"}], "+", "1"}], ")"}], ";;", 
               RowBox[{"3", "i"}]}], "]"}], "]"}], "=", "strainv"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "Hstrain"}]}], "\[IndentingNewLine]", "]"}], 
     ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrayReshapeC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], 
            RowBox[{"b", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "1"}], ";;", 
          RowBox[{"i", " ", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"b", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrainOnGaussPointToNode", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gpData", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ngp", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ele", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"node", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"gpShapeN", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"invN", "=", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"gpShapeN", "\[Transpose]"}], ".", "gpShapeN"}], "]"}], 
           ".", 
           RowBox[{"gpShapeN", "\[Transpose]"}]}]}], ",", "dataE", ",", 
         "dataN", ",", "nodeCount", ",", "ei", ",", 
         RowBox[{"len", "=", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"gpData", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "ngp"}], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"dataE", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"invN", ".", 
            RowBox[{"ArrayReshapeC", "[", 
             RowBox[{"egp", ",", 
              RowBox[{"{", 
               RowBox[{"ngp", ",", "len"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"egp", ",", "gpData"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataN", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "node", "]"}], "}"}], ",", 
           RowBox[{"{", "len", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nodeCount", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "node", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ei", "=", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"dataN", "[", 
             RowBox[{"[", "ei", "]"}], "]"}], "+=", 
            RowBox[{"dataE", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"nodeCount", "[", 
             RowBox[{"[", "ei", "]"}], "]"}], "+=", "1"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataN", "/", "nodeCount"}]}]}], "\[IndentingNewLine]", "]"}],
      ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
     ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.892202333928608*^9, 3.892202351977742*^9}, {
   3.892202403065982*^9, 3.8922024836860833`*^9}, {3.8922025928770204`*^9, 
   3.89220262101303*^9}, {3.892202666865119*^9, 3.8922026681454105`*^9}, {
   3.8922028828535414`*^9, 3.89220288782218*^9}, {3.8922034422694016`*^9, 
   3.8922034614410925`*^9}, {3.8922035202875013`*^9, 3.892203521961856*^9}, {
   3.892203596454154*^9, 3.8922035988784485`*^9}, {3.8922038292705383`*^9, 
   3.8922039263518333`*^9}, {3.892203984464244*^9, 3.8922039996491704`*^9}, {
   3.8922041228399715`*^9, 3.892204126095092*^9}, {3.8922767335662966`*^9, 
   3.892276797188418*^9}, 3.8922871046079297`*^9, {3.8925512242374*^9, 
   3.8925512320636616`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"1b5e6aae-1c20-411b-a79f-5e39726caf09"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Additional functions for integral in element.", "Section",
 CellChangeTimes->{{3.8799940184601088`*^9, 
  3.879994039992173*^9}},ExpressionUUID->"d29fa193-fee2-42ab-ba45-\
07f002021799"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OneElementIntegrate", "[", 
    RowBox[{
    "wl_", ",", "shapeN_", ",", "shapedN_", ",", "nnode_", ",", "ff_"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"nnode", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"numN", "=", 
        RowBox[{"Length", "[", "nnode", "]"}]}], ",", "jm", ",", "ff1", ",", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", "ff", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nf", "\[NotEqual]", "numN"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, the length of field list should be the same as the \
number of nodes\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
      RowBox[{"jm", "=", 
       RowBox[{"FEMGaussPointWeightc", "[", 
        RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wl", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", 
          RowBox[{"jm", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Otimes", "[", 
           RowBox[{
            RowBox[{"shapeN", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"shapeN", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ".", "ff"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"ff1", "+=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"wl", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", 
            RowBox[{"jm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Otimes", "[", 
             RowBox[{
              RowBox[{"shapeN", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"shapeN", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ".", "ff"}], 
           ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "ff1"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.783096260053173*^9, 3.783096273055917*^9}, {
  3.783096479883747*^9, 3.7830965072373114`*^9}, {3.783096962695362*^9, 
  3.7830971226945133`*^9}, {3.783097201536023*^9, 3.783097208511422*^9}, {
  3.78309726826184*^9, 3.78309730672604*^9}, {3.7830974017154727`*^9, 
  3.7830974173033643`*^9}, {3.7830991023227415`*^9, 3.7830991049748936`*^9}, {
  3.7830998291053114`*^9, 3.7830998376427994`*^9}, {3.783099963493998*^9, 
  3.7830999881024055`*^9}, {3.7831001206419864`*^9, 3.7831002011875935`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"73c3d8c2-e6c0-4b58-9df7-bb7d6072a850"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OneElementIntegrateDot", "[", 
    RowBox[{
    "wl_", ",", "shapeN_", ",", "shapedN_", ",", "nnode_", ",", "ff_"}], 
    "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"u", "\[CenterDot]", "f"}], "*)"}], 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"nnode", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"numN", "=", 
        RowBox[{"Length", "[", "nnode", "]"}]}], ",", "jm", ",", "ff1", ",", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", "ff", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "ff", "]"}], "\[NotEqual]", 
         RowBox[{"Dimensions", "[", "nnode", "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, the dimensions of field list should be the same as that \
of nodes\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
      RowBox[{"jm", "=", 
       RowBox[{"FEMGaussPointWeightc", "[", 
        RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wl", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", 
          RowBox[{"jm", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Otimes", "[", 
           RowBox[{
            RowBox[{"shapeN", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"shapeN", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ".", "ff"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"ff1", "+=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"wl", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", 
            RowBox[{"jm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Otimes", "[", 
             RowBox[{
              RowBox[{"shapeN", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"shapeN", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ".", "ff"}], 
           ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "ff1", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OneElementIntegrateDotConst", "[", 
    RowBox[{
    "wl_", ",", "shapeN_", ",", "shapedN_", ",", "nnode_", ",", "ff_"}], 
    "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"u", "\[CenterDot]", "f"}], "*)"}], 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"nnode", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"numN", "=", 
        RowBox[{"Length", "[", "nnode", "]"}]}], ",", "jm", ",", "ff1", ",", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", "ff", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "ff", "]"}], "\[NotEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"nnode", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, the length of field list should be the same as that of \
coordinate\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
      RowBox[{"jm", "=", 
       RowBox[{"FEMGaussPointWeightc", "[", 
        RowBox[{"shapedN", ",", "nnode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wl", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", 
          RowBox[{"jm", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Otimes", "[", 
          RowBox[{
           RowBox[{"shapeN", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "ff"}], "]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"ff1", "+=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"wl", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", 
            RowBox[{"jm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"Otimes", "[", 
            RowBox[{
             RowBox[{"shapeN", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "ff"}], "]"}], ")"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "wl", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "ff1", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783100585084551*^9, 3.7831007275476995`*^9}, {
  3.783101660946087*^9, 3.783101664097267*^9}, {3.7831427261883965`*^9, 
  3.7831428133613825`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"dfb8e9dc-13c5-434b-ba9e-e2811db922f5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Integral]", " ", 
    RowBox[{"\[DoubleStruckU]", "\[CenterDot]", "\[DoubleStruckF]"}]}], " ", 
   ";", " ", 
   RowBox[{
    RowBox[{"ResidualOfElementSet", " ", "ResiBC"}], "=", 
    RowBox[{"ResidualOfElementSet", "[", 
     RowBox[{
     "weighLB", ",", "endnNB", ",", "endndNB", ",", "coord", ",", "forceEle", 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10.", "^", "6"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"gprB", "=", "L2ic21m"}], ";", "\[IndentingNewLine]", 
   RowBox[{"endnB", "=", 
    RowBox[{"ElementShapeNdN", "[", 
     RowBox[{"\"\<L1\>\"", ",", "gprB"}], "]"}]}], ";", 
   RowBox[{"endnNB", "=", 
    RowBox[{"endnB", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
   RowBox[{"endndNB", "=", 
    RowBox[{"endnB", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"weighLB", "=", 
    RowBox[{"gprB", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"forceEle", "=", 
    RowBox[{"FindBoundaryElement", "[", 
     RowBox[{"coord", ",", "eleB", ",", "eleP", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"L", ",", "0"}], "}"}], "-", "0.001"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"L", ",", "L"}], "}"}], "+", "0.001"}]}], "]"}]}], ";", 
   RowBox[{"forceEle", "//", "Length"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.783141412374251*^9, 3.7831414371326666`*^9}, {
  3.895721599382084*^9, 3.895721630952504*^9}, {3.8957216667732253`*^9, 
  3.8957216681229057`*^9}, {3.895721737668722*^9, 3.8957217396832933`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"f93da6a7-26f2-405d-a24e-ecf874877586"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResidualOfElementSet", "[", 
    RowBox[{
    "wl_", ",", "shapeN_", ",", "shapedN_", ",", "xyz_", ",", "eleB_", ",", 
     "bf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ncount", "=", 
        RowBox[{"Length", "[", "xyz", "]"}]}], ",", 
       RowBox[{"ndim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"xyz", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "ndof", ",", "Rsp", 
       ",", "ei", ",", "xyzi", ",", "uvwi", ",", "NeiI2", ",", "Ri", ",", 
       "nbf", ",", 
       RowBox[{"constantbf", "=", "True"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ndof", "=", 
       RowBox[{"ndim", " ", "ncount"}]}], ";", 
      RowBox[{"nbf", "=", 
       RowBox[{"Dimensions", "[", "bf", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"constantbf", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "nbf", "]"}], "\[Equal]", "1"}], ")"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"constantbf", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "bf", "]"}], "\[NotEqual]", "ndim"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Error, bf should be length of \>\"", ",", "ndim"}], 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "constantbf"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nbf", "\[NotEqual]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "eleB", "]"}], ",", "ndim"}], "}"}]}], 
          ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Error, bf should be the shape of Length[eleB] x ndim\>\"", 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"eleB", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[NotEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"shapeN", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, the shape function is not compitable with the element\>\
\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rsp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", "ndof", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"constantbf", ",", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ei", "=", 
            RowBox[{"eleB", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", 
           RowBox[{"xyzi", "=", 
            RowBox[{"xyz", "[", 
             RowBox[{"[", "ei", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Ri", "=", 
            RowBox[{"OneElementIntegrateDotConst", "[", 
             RowBox[{
             "wl", ",", "shapeN", ",", "shapedN", ",", "xyzi", ",", "bf"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"NeiI2", "=", 
            RowBox[{"NeiIIndex", "[", 
             RowBox[{"ei", ",", "ndim"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Rsp", "[", 
             RowBox[{"[", "NeiI2", "]"}], "]"}], "+=", "Ri"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "eleB", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ei", "=", 
             RowBox[{"eleB", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", 
            RowBox[{"xyzi", "=", 
             RowBox[{"xyz", "[", 
              RowBox[{"[", "ei", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ri", "=", 
             RowBox[{"OneElementIntegrateDot", "[", 
              RowBox[{"wl", ",", "shapeN", ",", "shapedN", ",", "xyzi", ",", 
               RowBox[{"bf", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
            RowBox[{"NeiI2", "=", 
             RowBox[{"NeiIIndex", "[", 
              RowBox[{"ei", ",", "ndim"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Rsp", "[", 
              RowBox[{"[", "NeiI2", "]"}], "]"}], "+=", "Ri"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "eleB", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "Rsp"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7831411599608135`*^9, 3.783141213333866*^9}, {
  3.7831412440236216`*^9, 3.783141284743951*^9}, {3.7831413149256773`*^9, 
  3.7831413999005375`*^9}, {3.7831414625151186`*^9, 3.7831415434667487`*^9}, {
  3.7831415769096613`*^9, 3.783141842204836*^9}, {3.7831419694341125`*^9, 
  3.783141980946771*^9}, {3.783158842760085*^9, 3.7831588742848883`*^9}, {
  3.7831592018496237`*^9, 3.7831592188155947`*^9}, {3.7831592690834694`*^9, 
  3.7831593058795743`*^9}, {3.7831593572585125`*^9, 3.7831593973348055`*^9}, {
  3.7831594336878843`*^9, 3.783159452645969*^9}, {3.783159781818796*^9, 
  3.7831598750991316`*^9}, {3.7831599598889813`*^9, 3.783160044889843*^9}, {
  3.7831605154397573`*^9, 3.7831605704289026`*^9}, {3.783160863157645*^9, 
  3.7831608722701664`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"23e90bf0-eb52-4dba-b2b6-2512f837ef09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoTableMaxEach", "[", 
    RowBox[{"t_", ",", "t2_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", "t", "]"}], "\[NotEqual]", 
      RowBox[{"Dimensions", "[", "t2", "]"}]}], ",", 
     RowBox[{"Abort", "[", "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"t", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"t2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoArrayMaxEach", "[", 
    RowBox[{"t_", ",", "t2_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", "t", "]"}], "\[NotEqual]", 
      RowBox[{"Dimensions", "[", "t2", "]"}]}], ",", 
     RowBox[{"Abort", "[", "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"t", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"t2", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7835780558220053`*^9, 3.7835781307421103`*^9}, {
  3.7835781731621695`*^9, 3.783578197322203*^9}, {3.783583599482526*^9, 
  3.783583649658396*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"f2ab0fb9-4d41-4697-894d-fc2d5c1e3e08"],

Cell[CellGroupData[{

Cell["Stress strain postprocess", "Subsection",
 CellChangeTimes->{{3.793944385739811*^9, 
  3.7939443964584236`*^9}},ExpressionUUID->"76a45b66-b2f9-42c6-ac40-\
638e383183d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussPointValue2NodeValue", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numNode", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"invShapeN", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ele", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"stressStrain", ",", "_Real", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Nrepeat", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "numNode", "}"}]}], "]"}]}], ",", "Nvalue", ",", 
         RowBox[{"dimE", "=", 
          RowBox[{"Dimensions", "[", "ele", "]"}]}], ",", "ei", ",", 
         RowBox[{"dim", "=", 
          RowBox[{"Dimensions", "[", "stressStrain", "]"}]}], ",", "Nvi"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"Nvalue", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", "numNode", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nvi", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"dimE", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ei", "=", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"Nrepeat", "[", 
             RowBox[{"[", "ei", "]"}], "]"}], "+=", "1"}], ";", 
           RowBox[{"Nvi", "=", 
            RowBox[{"invShapeN", ".", 
             RowBox[{"stressStrain", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Nvalue", "[", 
               RowBox[{"[", 
                RowBox[{"ei", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
              RowBox[{"Nvi", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"dimE", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"dimE", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Nvalue", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*=", 
           RowBox[{"1.", "/", 
            RowBox[{"Nrepeat", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numNode"}], "}"}]}], "]"}], ";", "Nvalue"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7940626061719465`*^9, 3.794062620775782*^9}, {
  3.7940626687125235`*^9, 3.794062769196271*^9}, {3.794062803762248*^9, 
  3.7940628097765923`*^9}, {3.794062856839284*^9, 3.7940630844863048`*^9}, {
  3.7940631192382927`*^9, 3.7940631237895527`*^9}, {3.7940631558263855`*^9, 
  3.7940631959446797`*^9}, {3.794063280291504*^9, 3.7940634689102926`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"47fb7539-e9df-420b-8edd-c60a5a79a5fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Viogt2Tensor2D", "[", 
    RowBox[{"{", 
     RowBox[{
     "a11_", ",", "a22_", ",", "a12_", ",", "s11_", ",", "s22_", ",", 
      "s12_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a11", ",", "a12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a12", ",", "a22"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s11", ",", "s12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s12", ",", "s22"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Viogt2Tensor3D", "[", 
    RowBox[{"{", 
     RowBox[{
     "a11_", ",", "a22_", ",", "a33_", ",", "a23_", ",", "a13_", ",", "a12_", 
      ",", "s11_", ",", "s22_", ",", "s33_", ",", "s23_", ",", "s13_", ",", 
      "s12_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a11", ",", "a12", ",", "a13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a12", ",", "a22", ",", "a23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a13", ",", "a23", ",", "a33"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s11", ",", "s12", ",", "s13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s12", ",", "s22", ",", "s23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s13", ",", "s23", ",", "s33"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.793945682641989*^9, 3.7939458427591476`*^9}, 
   3.7939459824191356`*^9, 3.7939460555693197`*^9, {3.7939461499297166`*^9, 
   3.7939462125893*^9}, {3.793946254927722*^9, 3.7939466870744395`*^9}, {
   3.7939467773056*^9, 3.7939467784346647`*^9}, {3.793948617285841*^9, 
   3.7939486606503215`*^9}, {3.9343674135798244`*^9, 
   3.9343674148909216`*^9}},ExpressionUUID->"b1e8b1b2-82a6-45f6-9ca0-\
20d4eb052abd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleDot", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "=", "0."}], ",", 
         RowBox[{"dim", "=", 
          RowBox[{"Dimensions", "[", "a", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"s", "+=", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
              RowBox[{"b", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", "s"}]}], 
      "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7939483164306335`*^9, 3.7939484687723465`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"76f8d955-57ad-4f92-a56a-e883fd86dbd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StiffnessIndex", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"udim", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NeiI", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NeiI2", ",", "NeiTuple", ",", "k2", ",", "k"}], "}"}], ",", 
       RowBox[{
        RowBox[{"NeiI2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"udim", " ", 
             RowBox[{"Length", "[", "NeiI", "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"k2", "=", 
         RowBox[{"udim", " ", 
          RowBox[{"(", 
           RowBox[{"NeiI", "-", "1"}], ")"}]}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NeiI2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}], ";;", "udim"}], "]"}], "]"}], "=", 
           RowBox[{"k2", "+", "i"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "udim"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NeiTuple", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "NeiI2", "]"}], "^", "2"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NeiTuple", "[", 
            RowBox[{"[", 
             RowBox[{"k", "++"}], "]"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "NeiI2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "NeiI2"}], "}"}]}], "]"}], ";", "NeiTuple"}]}], 
      "]"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResidualIndex", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"udim", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NeiI", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NeiI2", ",", "NeiTuple", ",", "k2", ",", "k"}], "}"}], ",", 
       RowBox[{
        RowBox[{"NeiI2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"udim", " ", 
             RowBox[{"Length", "[", "NeiI", "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"k2", "=", 
         RowBox[{"udim", " ", 
          RowBox[{"(", 
           RowBox[{"NeiI", "-", "1"}], ")"}]}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NeiI2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}], ";;", "udim"}], "]"}], "]"}], "=", 
           RowBox[{"k2", "+", "i"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "udim"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "NeiI2"}]}], "]"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RKextractFEM", "[", 
    RowBox[{
    "RKvalue_List", ",", "Ele_", ",", "Rlen_Integer", ",", "Klen_Integer", 
     ",", "udim_Integer"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Rv2", ",", "Kv2", ",", "iR", ",", "iK", ",", "irk", ",", "lenrk", ",", 
       RowBox[{"len", "=", 
        RowBox[{"Length", "[", "RKvalue", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Rv2", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0.", ",", "Rlen"}], "]"}]}], ";", 
      RowBox[{"Kv2", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0.", ",", "Klen"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"iR", "=", "1"}], ";", 
      RowBox[{"iK", "=", "1"}], ";", 
      RowBox[{"irk", "=", "1"}], ";", 
      RowBox[{"lenrk", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"irk", "=", 
          RowBox[{"udim", 
           RowBox[{"(", 
            RowBox[{"Length", "[", 
             RowBox[{"Ele", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ")"}]}]}], ";", 
         RowBox[{"lenrk", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"RKvalue", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"Rv2", "[", 
           RowBox[{"[", 
            RowBox[{"iR", ";;", 
             RowBox[{"iR", "+", "irk", "-", "1"}]}], "]"}], "]"}], "=", 
          RowBox[{"RKvalue", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"1", ";;", "irk"}]}], "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"Kv2", "[", 
           RowBox[{"[", 
            RowBox[{"iK", ";;", 
             RowBox[{"iK", "+", "lenrk", "-", "irk", "-", "1"}]}], "]"}], 
           "]"}], "=", 
          RowBox[{"RKvalue", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"irk", "+", "1"}], ";;", "lenrk"}]}], "]"}], "]"}]}], 
         ";", 
         RowBox[{"iR", "+=", "irk"}], ";", 
         RowBox[{"iK", "+=", 
          RowBox[{"lenrk", "-", "irk"}]}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "len"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Rv2", ",", "Kv2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RKindexFEM", "[", 
    RowBox[{"Ele_List", ",", "udim_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Rindex", ",", "Kindex", ",", "ii", ",", 
       RowBox[{"nN", "=", 
        RowBox[{"Length", "[", "Ele", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ii", "=", 
       RowBox[{"udim", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Ele", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"Rindex", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"ResidualIndex", "[", 
          RowBox[{"udim", ",", "Ele"}], "]"}], ",", 
         RowBox[{"nN", " ", "ii"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kindex", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"StiffnessIndex", "[", 
          RowBox[{"udim", ",", "Ele"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nN", " ", "ii", " ", "ii"}], ",", "2"}], "}"}]}], "]"}]}],
       " ", ";", 
      RowBox[{"{", 
       RowBox[{"Rindex", ",", "Kindex"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixAssembly", "[", 
   RowBox[{"values_", ",", "pos_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "matrix", "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "pos", "]"}], "\[NotEqual]", 
        RowBox[{"Length", "[", "values", "]"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Error, index and value have different length\>\"", 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
     RowBox[{"System`SetSystemOptions", "[", 
      RowBox[{"\"\<SparseArrayOptions\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<TreatRepeatedEntries\>\"", "\[Rule]", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"matrix", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"pos", "\[Rule]", "values"}], ",", "dim"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"System`SetSystemOptions", "[", 
      RowBox[{"\"\<SparseArrayOptions\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<TreatRepeatedEntries\>\"", "\[Rule]", "0"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "matrix", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.79353212352264*^9, 3.7935321388855186`*^9}, {
  3.7935323284483604`*^9, 3.7935323293074102`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"ab17cfdd-0328-46bf-82d8-33b82beb1c2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"DirichletApply", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"NeumannApply", ",", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pL", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.1", ",", "0.2", ",", "0"}], "}"}]}], "}"}]}], 
    ",", " ", 
    RowBox[{"the", " ", "index", " ", "in", " ", "Ksp", " ", 
     RowBox[{"(", 
      RowBox[{"Sparse", " ", "Stiffness", " ", "matrix"}], ")"}]}], ",", " ", 
    RowBox[{"the", " ", "value", " ", "list", " ", "in", " ", "Ksp"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DirichletApply", "[", 
    RowBox[{"Ksp_", ",", "Rsp_", ",", "pL_", ",", "pen_", ",", 
     RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pi", "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "=", 
          RowBox[{"pL", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{
          RowBox[{"Ksp", "\[LeftDoubleBracket]", 
           RowBox[{"pi", ",", "pi"}], "\[RightDoubleBracket]"}], "*=", 
          "pen"}], ";", 
         RowBox[{
          RowBox[{
          "Rsp", "\[LeftDoubleBracket]", "pi", "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{"Ksp", "\[LeftDoubleBracket]", 
            RowBox[{"pi", ",", "pi"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"pL", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
           "scale"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "pL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "]"}], ";"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SparseDiag", "[", "a_List", "]"}], ":=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "i_"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"a", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Length", "[", "a", "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], ",", 
            RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{"a", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";", "s"}]}], 
     "]"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SparseDiag", "[", 
    RowBox[{"a_List", ",", "ia_List", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ia", ",", "ia"}], "}"}], "\[Transpose]"}]}], ";", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"b", "\[Rule]", "a"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DirichletApply", "[", 
    RowBox[{"Ksp_", ",", "Rsp_", ",", "pL_", ",", "pen_", ",", 
     RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pi", ",", "tk", ",", "tk2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"tk", "=", 
       RowBox[{
        RowBox[{"Diagonal", "[", "Ksp", "]"}], "//", "Normal"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tk2", "=", "tk"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tk2", "[", 
        RowBox[{"[", 
         RowBox[{"pL", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "*=", 
       RowBox[{"(", 
        RowBox[{"pen", "+", "1."}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tk2", "-=", "tk"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ksp", "+=", 
       RowBox[{"SparseDiag", "[", "tk2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "=", 
          RowBox[{"pL", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{
          RowBox[{
          "Rsp", "\[LeftDoubleBracket]", "pi", "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{"tk2", "[", 
            RowBox[{"[", "pi", "]"}], "]"}], " ", 
           RowBox[{"pL", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
           "scale"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "pL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "]"}], ";"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NeumannApply", "[", 
    RowBox[{"Rsp_", ",", "pL_", ",", 
     RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Rsp", "\[LeftDoubleBracket]", 
        RowBox[{"pL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}], "+=", 
       RowBox[{
        RowBox[{"pL", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        " ", "scale"}]}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SparseDiag", "[", 
    RowBox[{"a_List", ",", "ia_List", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ia", ",", "ia"}], "}"}], "\[Transpose]"}]}], ";", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"b", "\[Rule]", "a"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SparseDiag2", "[", 
    RowBox[{"ia_List", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "ia", "]"}], "]"}], ",", "ia"}], "}"}], 
        "\[Transpose]"}]}], ";", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"b", "\[Rule]", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "ia", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "ia", "]"}], ",", "n"}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7828232520485106`*^9, 3.782823252460534*^9}, {
  3.8993797243359857`*^9, 3.8993797252931175`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"5443cd7f-3835-498d-92fd-5331d8284548"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"NLDirichletApply", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NLDirichletApply", "[", 
     RowBox[{"Ksp_", ",", "Rsp_", ",", "pL_", ",", 
      RowBox[{"inc_", ":", "1.0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pi", ",", 
        RowBox[{"tk", "=", 
         RowBox[{"Length", "[", "Rsp", "]"}]}], ",", "tk2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "=", 
           RowBox[{"pL", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
          RowBox[{
           RowBox[{
           "Ksp", "\[LeftDoubleBracket]", "pi", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{"pi", "\[Rule]", "1"}], ",", "tk"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{
           "Rsp", "\[LeftDoubleBracket]", "pi", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            RowBox[{"pL", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
            "inc"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "pL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}]}], "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"NLDirichletApply", "[", 
      RowBox[{"udim_", ",", "uwv_", ",", "Ksp_", ",", "Rsp_", ",", "pL_", ",", 
       RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pi", ",", 
         RowBox[{"tk", "=", 
          RowBox[{"Length", "[", "Rsp", "]"}]}], ",", "tk2", ",", "i3"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "=", 
            RowBox[{"pL", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
           RowBox[{
            RowBox[{
            "Ksp", "\[LeftDoubleBracket]", "pi", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"pi", "\[Rule]", "1"}], ",", "tk"}], "]"}]}], ";", 
           RowBox[{"i3", "=", 
            RowBox[{
             RowBox[{"QuotientRemainder", "[", 
              RowBox[{
               RowBox[{"pi", "-", "1"}], ",", "udim"}], "]"}], "+", "1"}]}], 
           ";", 
           RowBox[{
            RowBox[{
            "Rsp", "\[LeftDoubleBracket]", "pi", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{
             RowBox[{
              RowBox[{"pL", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
              "scale"}], "-", 
             RowBox[{"uvw", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{
               "i3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "i3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
               "\[RightDoubleBracket]"}]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
             "pL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], "}"}]}], "]"}], ";"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1.2", " ", "million", " ", "Dof", " ", "105", " ", "second"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NLDirichletApply", "[", 
    RowBox[{"udim_", ",", "uvw_", ",", "Ksp_", ",", "Rsp_", ",", "pL_", ",", 
     RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pi", ",", 
       RowBox[{"tk", "=", 
        RowBox[{"Length", "[", "Rsp", "]"}]}], ",", "tk2", ",", "i3", ",", 
       "tksp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tksp", "=", 
       RowBox[{"Ksp", "[", 
        RowBox[{"[", 
         RowBox[{"pL", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tksp", "-=", 
       RowBox[{"SparseDiag2", "[", 
        RowBox[{
         RowBox[{"pL", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Length", "[", "Rsp", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ksp", "[", 
        RowBox[{"[", 
         RowBox[{"pL", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-=", "tksp"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "=", 
          RowBox[{"pL", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ";", 
         RowBox[{"i3", "=", 
          RowBox[{
           RowBox[{"QuotientRemainder", "[", 
            RowBox[{
             RowBox[{"pi", "-", "1"}], ",", "udim"}], "]"}], "+", "1"}]}], 
         ";", 
         RowBox[{
          RowBox[{
          "Rsp", "\[LeftDoubleBracket]", "pi", "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"pL", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
            "scale"}], "-", 
           RowBox[{"uvw", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{
             "i3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "i3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "\[RightDoubleBracket]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "pL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}]}], "]"}], ";"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"NLDirichletApply2", ",", "HoldAll"}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"1.2", " ", "million", " ", "Dof", " ", "1.4", " ", "second"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NLDirichletApply2", "[", 
    RowBox[{"udim_", ",", "uvw_", ",", "Ksp_", ",", "Rsp_", ",", "pL_", ",", 
     RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pi", ",", 
       RowBox[{"pl1", "=", 
        RowBox[{"pL", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"tk", "=", 
        RowBox[{"Length", "[", "Rsp", "]"}]}], ",", "tk2", ",", "i3", ",", 
       "tksp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Ksp", "[", 
        RowBox[{"[", "pl1", "]"}], "]"}], "*=", "0."}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ksp", "+=", 
       RowBox[{"SparseDiag", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1.", ",", 
           RowBox[{"Length", "[", "pl1", "]"}]}], "]"}], ",", "pl1", ",", 
         "tk"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rsp", "[", 
        RowBox[{"[", "pl1", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i3", "=", 
           RowBox[{
            RowBox[{"QuotientRemainder", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pl1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ",", "udim"}], 
             "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pL", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
            "scale"}], "-", 
           RowBox[{"uvw", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{
             "i3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "i3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "pl1", "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"NLDirichletApplySym", ",", "HoldAll"}], "]"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Ksp", " ", "is", " ", "required", " ", "to", " ", "be", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"symmetric", ".", " ", "26"}], "/", "7"}], "/", "23."}], " ", 
    "This", " ", "function", " ", "is", " ", "useful", " ", "to", " ", 
    "maintain", " ", "symmetric", " ", 
    RowBox[{"matrix", ".", " ", "It"}], " ", "is", " ", "useful", " ", "in", 
    " ", "eigenvalue", " ", 
    RowBox[{"problems", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NLDirichletApplySym", "[", 
     RowBox[{"udim_", ",", "uvw_", ",", "Ksp_", ",", "Rsp_", ",", "pL_", ",", 
      RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tk", "=", 
         RowBox[{"Length", "[", "Rsp", "]"}]}], ",", "Rsp0", ",", "i3", ",", 
        "tksp", ",", "DeltaList", ",", 
        RowBox[{"dli", "=", "0."}], ",", 
        RowBox[{"pl1", "=", 
         RowBox[{"pL", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"tksp", "=", 
        RowBox[{"Ksp", "[", 
         RowBox[{"[", "pl1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DeltaList", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "pl1", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rsp0", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"{", 
          RowBox[{"tk", "->", "0."}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t1", "=", 
        RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i3", "=", 
              RowBox[{
               RowBox[{"QuotientRemainder", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"pl1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ",", "udim"}], 
                "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dli", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"pL", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
                "scale"}], "-", 
               RowBox[{"uvw", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                 "i3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  ",", 
                 RowBox[{
                 "i3", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DeltaList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "dli"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Rsp0", "+=", 
              RowBox[{
               RowBox[{"tksp", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", "dli"}]}], " ", ";"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "pl1", "]"}]}], "}"}]}], "]"}], ";"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{
          RowBox[{"Rsp", "-=", "Rsp0"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Rsp", "[", 
            RowBox[{"[", "pl1", "]"}], "]"}], "=", "DeltaList"}], ";"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "make", " ", "the", " ", "sparse", " ", "matrix", " ", "to", " ", 
         "1."}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"t3", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Ksp", "[", 
            RowBox[{"[", "pl1", "]"}], "]"}], "*=", "0."}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ksp", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "pl1"}], "]"}], "]"}], "*=", "0."}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Ksp", "+=", 
           RowBox[{"SparseDiag", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"1.", ",", 
               RowBox[{"Length", "[", "pl1", "]"}]}], "]"}], ",", "pl1", ",", 
             "tk"}], "]"}]}], ";"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "NLDirichletApply", ":", "NLDirichletApplySym", ":", 
     "NLDirichletApplySym2"}], "=", 
    RowBox[{"1", ":", "2", ":", "10"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"NLDirichletApplySym2", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NLDirichletApplySym2", "[", 
     RowBox[{"udim_", ",", "uvw_", ",", "Ksp_", ",", "Rsp_", ",", "pL_", ",", 
      RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pi", ",", 
        RowBox[{"tk", "=", 
         RowBox[{"Length", "[", "Rsp", "]"}]}], ",", "tk2", ",", "i3", ",", 
        "tksp", ",", "tksp2", ",", "diagK", ",", "DeltaList", ",", 
        RowBox[{"dli", "=", "0."}], ",", 
        RowBox[{"pl1", "=", 
         RowBox[{"pL", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"tksp", "=", 
        RowBox[{"Ksp", "[", 
         RowBox[{"[", "pl1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tksp2", "=", 
        RowBox[{"Ksp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "pl1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tksp", "-=", 
        RowBox[{"SparseDiag2", "[", 
         RowBox[{"pl1", ",", "tk"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"t1", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{
          RowBox[{"diagK", "=", 
           RowBox[{"SparseDiag3", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Normal", "[", 
               RowBox[{"Ksp", "[", 
                RowBox[{"[", 
                 RowBox[{"pl1", ",", "pl1"}], "]"}], "]"}], "]"}], "]"}], ",",
              "pl1", ",", "tk"}], "]"}]}], ";"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"13", "%"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Ksp", "[", 
            RowBox[{"[", "pl1", "]"}], "]"}], "-=", "tksp"}], ";"}], "]"}]}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{"3.4", "%"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"t3", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Ksp", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "pl1"}], "]"}], "]"}], "-=", "tksp2"}], 
          ";"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"5", "%"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ksp", "+=", "diagK"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DeltaList", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "pl1", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"t4", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "=", 
              RowBox[{"pl1", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", 
             RowBox[{"i3", "=", 
              RowBox[{
               RowBox[{"QuotientRemainder", "[", 
                RowBox[{
                 RowBox[{"pi", "-", "1"}], ",", "udim"}], "]"}], "+", "1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"dli", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"pL", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
                "scale"}], "-", 
               RowBox[{"uvw", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                 "i3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  ",", 
                 RowBox[{
                 "i3", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DeltaList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "dli"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Rsp", "-=", 
              RowBox[{
               RowBox[{"tksp2", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", "dli"}]}], " ",
              ";"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "pl1", "]"}]}], "}"}]}], "]"}], ";"}], 
         "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"78", "%"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Rsp", "[", 
         RowBox[{"[", "pl1", "]"}], "]"}], "=", "DeltaList"}], ";"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "NLDirichletApply", ":", "NLDirichletApplySym", ":", 
     "NLDirichletApplySym2"}], "=", 
    RowBox[{"1", ":", "2", ":", "10"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Test", ":", "A"}], "=", 
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sA", "=", 
     RowBox[{"SparseArray", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sR", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", "5", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pL", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.2"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"udim0", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"uvw0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", "[", "1", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", "[", "2", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", "[", "3", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", "[", "4", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", "[", "5", "]"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NLDirichletApplySym", "[", 
     RowBox[{
     "udim0", ",", "uvw0", ",", "sA", ",", "sR", ",", "pL", ",", "1"}], 
     "]"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SparseDiag3", "[", 
      RowBox[{"a_List", ",", "ia_List", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"ia", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"b", "->", "a"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SparseDiag3", "[", 
    RowBox[{"a_List", ",", "ia_List", ",", "n_"}], "]"}], ":=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{"ia", ",", "2"}], "]"}], "->", "a"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.89935969998862*^9, 3.899359715285739*^9}, {
   3.899360206145689*^9, 3.899360206677089*^9}, {3.899360469771778*^9, 
   3.8993604925679865`*^9}, {3.899360556056644*^9, 3.899360626096058*^9}, {
   3.899361037212027*^9, 3.8993610689827633`*^9}, {3.899361099255724*^9, 
   3.8993611275705547`*^9}, 3.89937971720607*^9, {3.899379791770816*^9, 
   3.8993798292762284`*^9}, {3.8993798648561163`*^9, 3.899379880935912*^9}, {
   3.899381699942692*^9, 3.899381734060547*^9}, {3.8993818305261784`*^9, 
   3.8993818679851665`*^9}, {3.8993821546897755`*^9, 3.899382162349129*^9}, {
   3.8993822886549053`*^9, 3.899382295508451*^9}, {3.8993823621339736`*^9, 
   3.8993823748871775`*^9}, {3.8993824319359026`*^9, 3.899382439455763*^9}, {
   3.8993828031558504`*^9, 3.8993828126904593`*^9}, {3.899383192583681*^9, 
   3.8993832044471188`*^9}, {3.8993834039577246`*^9, 
   3.8993834167880907`*^9}, {3.8993843442499323`*^9, 
   3.8993843965156717`*^9}, {3.8993845552479534`*^9, 
   3.8993845594903803`*^9}, {3.8993846021618075`*^9, 
   3.8993846044118757`*^9}, {3.8993847207901525`*^9, 
   3.8993847665724955`*^9}, {3.8993851654043283`*^9, 
   3.8993851656386976`*^9}, {3.8993855027720413`*^9, 
   3.8993855132106223`*^9}, {3.899385932945037*^9, 3.8993859643880744`*^9}, {
   3.899386000533849*^9, 3.899386006466741*^9}, {3.899386047270012*^9, 
   3.89938605203782*^9}, 3.8993860875370903`*^9, {3.899386339445825*^9, 
   3.899386349467239*^9}, {3.899386726462751*^9, 3.8993867683028526`*^9}, {
   3.8993868367082443`*^9, 3.8993868440695314`*^9}, {3.899386878359172*^9, 
   3.8993869624134555`*^9}, 3.8993869990240173`*^9, {3.8993871887845716`*^9, 
   3.899387202345129*^9}, {3.8993873173851185`*^9, 3.8993873195604544`*^9}, {
   3.8993874637372475`*^9, 3.899387530989234*^9}, {3.89938757354449*^9, 
   3.899387598934447*^9}, {3.899387708070182*^9, 3.899387778875352*^9}, {
   3.8993878730222616`*^9, 3.899387914052301*^9}, {3.8993879849248943`*^9, 
   3.8993880067868557`*^9}, {3.8993880402225685`*^9, 
   3.8993880880540295`*^9}, {3.8993881419264927`*^9, 
   3.8993881730985575`*^9}, {3.8993882607975054`*^9, 3.899388335113442*^9}, {
   3.8993887028496037`*^9, 3.8993887033220444`*^9}, {3.89944448856041*^9, 
   3.8994445016750174`*^9}, {3.8994445481734*^9, 3.899444557074915*^9}, {
   3.899444643929499*^9, 3.899444671933315*^9}, {3.8994447388926635`*^9, 
   3.8994447954212413`*^9}, {3.8994448282475843`*^9, 
   3.8994449244644833`*^9}, {3.899444964855897*^9, 3.8994449692995214`*^9}, {
   3.899445220433529*^9, 3.899445271627247*^9}, {3.8994456922384186`*^9, 
   3.899445730592965*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"073c4501-6a6f-48a5-ae76-1106b9621bee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SparseColumnModify", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vals", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"row", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"val2", "=", "vals"}], ",", 
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"len", "=", 
           RowBox[{"Length", "[", "vals", "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"val2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*=", 
          RowBox[{"s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"row", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "!=", 
               RowBox[{"row", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}]}], "]"}], ";", 
            RowBox[{
             RowBox[{"val2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*=", 
             RowBox[{"s", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "len"}], "}"}]}], "]"}], ";", 
         "val2"}]}], "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
         ",", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
         RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
        "}"}]}], ",", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SparseRspFromKsp", "[", 
    RowBox[{"pK_", ",", "sList_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vals", ",", "rows", ",", "cols"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rows", ",", "cols"}], "}"}], "=", 
       RowBox[{
        RowBox[{"pK", "[", "\"\<NonzeroPositions\>\"", "]"}], 
        "\[Transpose]"}]}], ";", 
      RowBox[{"vals", "=", 
       RowBox[{"pK", "[", "\"\<NonzeroValues\>\"", "]"}]}], ";", 
      RowBox[{"vals", "=", 
       RowBox[{"SparseColumnModify", "[", 
        RowBox[{"sList", ",", "vals", ",", "rows"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"matrixAssembly", "[", 
       RowBox[{"vals", ",", "cols", ",", 
        RowBox[{"Max", "[", 
         RowBox[{"Dimensions", "[", "pK", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"NLDirichletApplySymF", ",", "HoldAll"}], "]"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Ksp", " ", "is", " ", "required", " ", "to", " ", "be", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"symmetric", ".", " ", "26"}], "/", "7"}], "/", "23."}], " ", 
    "This", " ", "function", " ", "is", " ", "useful", " ", "to", " ", 
    "maintain", " ", "symmetric", " ", 
    RowBox[{"matrix", ".", " ", "It"}], " ", "is", " ", "useful", " ", "in", 
    " ", "eigenvalue", " ", 
    RowBox[{"problems", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NLDirichletApplySymF", "[", 
    RowBox[{"udim_", ",", "uvw_", ",", "Ksp_", ",", "Rsp_", ",", "pL_", ",", 
     RowBox[{"scale_", ":", "1.0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tk", "=", 
        RowBox[{"Length", "[", "Rsp", "]"}]}], ",", "i3", ",", "tksp", ",", 
       "DeltaList", ",", 
       RowBox[{"pl1", "=", 
        RowBox[{"pL", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"tksp", "=", 
       RowBox[{"Ksp", "[", 
        RowBox[{"[", "pl1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DeltaList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i3", "=", 
           RowBox[{
            RowBox[{"QuotientRemainder", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pl1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ",", "udim"}], 
             "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pL", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
            "scale"}], "-", 
           RowBox[{"uvw", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{
             "i3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "i3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "pl1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rsp", "-=", 
       RowBox[{"SparseRspFromKsp", "[", 
        RowBox[{"tksp", ",", "DeltaList"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rsp", "[", 
        RowBox[{"[", "pl1", "]"}], "]"}], "=", "DeltaList"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "make", " ", "the", " ", "sparse", " ", "matrix", " ", "to", " ", 
        "1."}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ksp", "[", 
        RowBox[{"[", "pl1", "]"}], "]"}], "*=", "0."}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ksp", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "pl1"}], "]"}], "]"}], "*=", "0."}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ksp", "+=", 
       RowBox[{"SparseDiag", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1.", ",", 
           RowBox[{"Length", "[", "pl1", "]"}]}], "]"}], ",", "pl1", ",", 
         "tk"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"121", "w", " ", "dof"}], ",", 
    RowBox[{"8700", "k"}], ",", 
    RowBox[{"64", " ", 
     RowBox[{"gb", "."}]}], ",", 
    RowBox[{"matrix", " ", 
     RowBox[{"assemble", ":", 
      RowBox[{"27", " ", "s"}]}]}], ",", 
    RowBox[{"BCsym", " ", 
     RowBox[{"apply", ":", 
      RowBox[{"31", " ", "s"}]}]}], ",", 
    RowBox[{
     RowBox[{"solve", ":", "Ax"}], "=", "b"}], ",", 
    RowBox[{"80", " ", 
     RowBox[{"s", "."}]}], ",", 
    RowBox[{
     RowBox[{"78", 
      RowBox[{"s", "."}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2", ",", "t3"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"28.2258", ",", "0.0372954", ",", "2.62024"}], "}"}]}], ";", 
     "\n", 
     RowBox[{"BC", " ", 
      RowBox[{"apply", ":", 
       RowBox[{"1.47", " ", "s"}]}]}]}], ",", 
    RowBox[{"NLDirichletApply2", ";", "\n", 
     RowBox[{
      RowBox[{"solve", ":", "Ax"}], "=", "b"}]}], ",", 
    RowBox[{"176", " ", 
     RowBox[{"s", ".", "BCsymF"}], " ", 
     RowBox[{"apply", ":", 
      RowBox[{"2.96", " ", "s"}]}]}], ",", 
    RowBox[{
     RowBox[{"solve", ":", "Ax"}], "=", "b"}], ",", 
    RowBox[{"80", " ", 
     RowBox[{"s", "."}]}], ",", 
    RowBox[{
     RowBox[{"78", 
      RowBox[{"s", "."}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t1", ",", "t1b", ",", "t2", ",", "t3"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0.0691684", "}"}], ",", 
        RowBox[{"{", "0.177503", "}"}], ",", 
        RowBox[{"{", "0.0371238", "}"}], ",", 
        RowBox[{
         RowBox[{"{", "2.64632", "}"}], " ", "Symmetric", " ", "matrix", " ", 
         "is", " ", "easier", " ", "to", " ", 
         RowBox[{"solve", "."}]}]}]}]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8994497418824577`*^9, 3.8994497499976363`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"106afda1-d8a7-40a1-9aa2-52cd2de9f48d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DofIndexValue", "[", 
    RowBox[{"pL_List", ",", "vl_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "udim", ",", "pi", ",", "pu", ",", "dofIndex", ",", "dofValue", ",", 
       RowBox[{"k", "=", "1"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"udim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"vl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", 
      RowBox[{"dofIndex", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"udim", " ", 
          RowBox[{"Length", "[", "pL", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dofValue", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"udim", " ", 
          RowBox[{"Length", "[", "pL", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pi", "=", 
       RowBox[{"Range", "[", "udim", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pu", "=", 
          RowBox[{"pi", "+", 
           RowBox[{"udim", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "pL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "-", "1"}], ")"}]}]}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vl", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "<", 
              RowBox[{"10", "^", "10"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "dofIndex", "\[LeftDoubleBracket]", "k", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{
               "pu", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
               ";", 
              RowBox[{
               RowBox[{"dofValue", "\[LeftDoubleBracket]", 
                RowBox[{"k", "++"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{"vl", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "udim"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "pL", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dofIndex", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"k", "-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"dofValue", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"k", "-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCValuesFunc", "[", 
    RowBox[{"pL_List", ",", "coord_List", ",", "fun_", ",", "udim_"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "ndim", ",", "fdim"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ndim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{
        "coord", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", 
      RowBox[{"fdim", "=", 
       RowBox[{"fun", "[", 
        RowBox[{"coord", "\[LeftDoubleBracket]", 
         RowBox[{"pL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "\[RightDoubleBracket]"}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"udim", "\[NotEqual]", "fdim"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, the dimension of fun must be the same as the number of \
multiple fields\>\"", "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
      RowBox[{"v", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "pL", "]"}], ",", "udim"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "+=", 
         RowBox[{"fun", "[", 
          RowBox[{"coord", "\[LeftDoubleBracket]", 
           RowBox[{
           "pL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "pL", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "v"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.78282423251359*^9, 3.782824234910727*^9}, {
  3.9343674735924163`*^9, 
  3.9343674743843946`*^9}},ExpressionUUID->"b6cc5df6-906e-4013-bdaa-\
a0b50c3d9638"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NodeToElement", "[", 
    RowBox[{"numNode_", ",", "ele_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ne", ",", "nek", ",", "ei"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ne", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numNode", "}"}], ",", 
         RowBox[{"{", "40", "}"}]}], "]"}]}], ";", 
      RowBox[{"nek", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numNode", "}"}]}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ei", "=", 
          RowBox[{"ele", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nek", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "++"}], ";", 
            RowBox[{
             RowBox[{"ne", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", 
                RowBox[{"nek", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", "i"}]}],
            ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "ei"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"{", 
       RowBox[{"nek", ",", 
        RowBox[{"ne", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", ";;", 
            RowBox[{"Max", "[", "nek", "]"}]}]}], "]"}], "]"}]}], "}"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7830624381129403`*^9, 3.783062494335156*^9}, {
  3.783063216264448*^9, 3.7830632184355717`*^9}, {3.7830632572057896`*^9, 
  3.783063259979948*^9}, {3.783063406384322*^9, 3.7830636370295143`*^9}, {
  3.783064086649231*^9, 3.783064155401163*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"fad018ff-030c-45a1-818c-81701563b77d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindBoundaryElement", "[", 
    RowBox[{
    "nodes_", ",", "eleB_", ",", "eleP_", ",", "xmin_", ",", "xmax_"}], "]"}],
    ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nf", "=", 
        RowBox[{"FindPoints", "[", 
         RowBox[{"nodes", ",", "xmin", ",", "xmax", ",", 
          RowBox[{"Flatten", "[", "eleP", "]"}]}], "]"}]}], ",", 
       RowBox[{"ne", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "eleB", "]"}], "}"}]}], "]"}]}], ",", "ebi",
        ",", "notIn"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ebi", "=", 
          RowBox[{"eleB", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", 
         RowBox[{"notIn", "=", "False"}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"nf", ",", 
                RowBox[{"ebi", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"notIn", "=", "True"}], ";", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "ebi", "]"}]}], "}"}]}], "]"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "notIn"}], ",", 
           RowBox[{
            RowBox[{"ne", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "1"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "eleB", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"eleB", "[", 
       RowBox[{"[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"ne", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.78306689554189*^9, 3.783067001852971*^9}, {
   3.783067206494676*^9, 3.7830672226446*^9}, {3.7830672678721867`*^9, 
   3.7830673823977375`*^9}, {3.783067417885767*^9, 3.7830676338741207`*^9}, {
   3.7830722342472467`*^9, 3.7830722412006445`*^9}, 3.7830731371008873`*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"e17f386c-1d32-4b6e-85ab-02b072928a1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatTransverselyIsotropic", "[", 
    RowBox[{"{", 
     RowBox[{"c11_", ",", "c12_", ",", "c13_", ",", "c33_", ",", "c44_"}], 
     "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c11", ",", "c12", ",", "c13", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c12", ",", "c11", ",", "c13", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c13", ",", "c13", ",", "c33", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "c44", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "c44", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c11", "-", "c12"}], ")"}], "/", "2"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7827417109780817`*^9, 3.782741892398458*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"b16164ef-994e-4c82-922b-d739e9c0ece9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatOrthothropic", "[", 
    RowBox[{"{", 
     RowBox[{
     "c11_", ",", "c12_", ",", "c13_", ",", "c22_", ",", "c23_", ",", "c33_", 
      ",", "c44_", ",", "c55_", ",", "c66_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c11", ",", "c12", ",", "c13", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c12", ",", "c22", ",", "c23", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c13", ",", "c23", ",", "c33", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "c44", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "c55", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "c66"}], 
      "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7827419267404222`*^9, 3.7827420331815104`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"5a001175-f88c-4100-9caa-7e32d98f121e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatIsotropic", "[", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]_", ",", "\[Mu]_"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b6", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "6", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"b6", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", "\[Lambda]"}], ";", 
      RowBox[{
       RowBox[{"b6", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "+=", 
       RowBox[{"2", " ", "\[Mu]"}]}], ";", 
      RowBox[{
       RowBox[{"b6", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "+=", 
       RowBox[{"2", " ", "\[Mu]"}]}], ";", 
      RowBox[{
       RowBox[{"b6", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}], "+=", 
       RowBox[{"2", " ", "\[Mu]"}]}], ";", 
      RowBox[{
       RowBox[{"b6", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "4"}], "]"}], "]"}], "+=", " ", "\[Mu]"}], ";", 
      RowBox[{
       RowBox[{"b6", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "5"}], "]"}], "]"}], "+=", " ", "\[Mu]"}], ";", 
      RowBox[{
       RowBox[{"b6", "[", 
        RowBox[{"[", 
         RowBox[{"6", ",", "6"}], "]"}], "]"}], "+=", " ", "\[Mu]"}], ";", 
      "b6"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7827423673136215`*^9, 3.7827425753175187`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"2baefed6-086d-4c72-b8c0-5fdba0029f09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatIsotropicPlaneStress", "[", 
    RowBox[{"{", 
     RowBox[{"El_", ",", "\[Nu]_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"El", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[Nu]", "^", "2"}]}], ")"}]}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "\[Nu]", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Nu]", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], "/", "2"}]}], "}"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatIsotropicPlaneStrain", "[", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]_", ",", "\[Mu]_"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"b3", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", 
          RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "=", "\[Lambda]"}], ";", 
      RowBox[{
       RowBox[{"b3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "+=", 
       RowBox[{"2", " ", "\[Mu]"}]}], ";", 
      RowBox[{
       RowBox[{"b3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "+=", 
       RowBox[{"2", " ", "\[Mu]"}]}], ";", 
      RowBox[{
       RowBox[{"b3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}], "+=", " ", "\[Mu]"}], ";", 
      "b3"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7827426166268816`*^9, 3.7827427120213375`*^9}, {
  3.782742750441535*^9, 3.782742818147408*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"9d520799-2597-4957-bab4-79104f8c202c"],

Cell[CellGroupData[{

Cell["https://en.wikipedia.org/wiki/Bulk_modulus", "Item",
 CellChangeTimes->{{3.752325136457952*^9, 
  3.7523251373320026`*^9}},ExpressionUUID->"544d2210-363d-4278-8811-\
1ca9fb89f010"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KG2Ev", "[", 
    RowBox[{"K_", ",", "G_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"9.", "K", " ", 
      RowBox[{"G", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", "K"}], "+", "G"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3.", "K"}], "-", 
         RowBox[{"2.", "G"}]}], ")"}], "/", "2"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3.", "K"}], "+", "G"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ev2KG", "[", 
    RowBox[{"el_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"el", "/", "3"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2.", "v"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"el", "/", "2."}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "v"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LG2Ev", "[", 
    RowBox[{"\[Lambda]_", ",", "G_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.", "G", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", "\[Lambda]"}], "+", 
         RowBox[{"2", " ", "G"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Lambda]", "+", "G"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Lambda]", "/", "2."}], "/", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]", "+", "G"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ev2LG", "[", 
    RowBox[{"el_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"el", " ", 
      RowBox[{"v", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "v", "-", 
         RowBox[{"2.", 
          RowBox[{"v", "^", "2"}]}]}], ")"}]}]}], ",", 
     RowBox[{"0.5", " ", 
      RowBox[{"el", "/", 
       RowBox[{"(", 
        RowBox[{"1.", "+", "v"}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KG2LG", "[", 
    RowBox[{"K_", ",", "G_"}], "]"}], ":=", 
   RowBox[{"Ev2LG", "@@", 
    RowBox[{"KG2Ev", "[", 
     RowBox[{"K", ",", "G"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LG2KG", "[", 
    RowBox[{"\[Lambda]_", ",", "G_"}], "]"}], ":=", 
   RowBox[{"Ev2KG", "@@", 
    RowBox[{"LG2Ev", "[", 
     RowBox[{"\[Lambda]", ",", "G"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7523248168119125`*^9, 3.752324952254897*^9}, {
  3.7523249992569532`*^9, 3.752325104651993*^9}, {3.756630003510415*^9, 
  3.7566300118378916`*^9}, {3.756630113107684*^9, 3.7566301426263723`*^9}, {
  3.7566302345266285`*^9, 3.756630363733019*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"870ef738-af1f-4c9f-ba7e-a0b1eb8e1eb6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mesh tools", "Section",
 CellChangeTimes->{{3.8820863456305184`*^9, 
  3.882086350868209*^9}},ExpressionUUID->"f15d1707-b147-429d-a57c-\
a43f92f40c09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", 
    RowBox[{"NOM_tools", ".", "nb"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MergePoints", "[", 
      RowBox[{"XYZ_List", ",", "tot_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nn", ",", "nflag", ",", "ni", ",", "coord"}], "}"}], ",", 
       RowBox[{
        RowBox[{"coord", "=", 
         RowBox[{"N", "[", "XYZ", "]"}]}], ";", 
        RowBox[{"nflag", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "[", "coord", "]"}]}], "]"}]}], ";", 
        RowBox[{"nn", "=", 
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"coord", "\[Rule]", "Automatic"}], ",", "coord", ",", 
           RowBox[{"{", 
            RowBox[{"\[Infinity]", ",", "tot"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"nn", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{"nflag", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"ni", "=", 
              RowBox[{"nn", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nflag", "[", 
                 RowBox[{"[", 
                  RowBox[{"ni", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "=", "i"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "2", ",", 
                 RowBox[{"Length", "[", "ni", "]"}]}], "}"}]}], "]"}]}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "nn", "]"}]}], "}"}]}], "]"}], ";", 
        "nflag"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "MergePointReverse", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MergePoints", "[", 
      RowBox[{"XYZ_List", ",", "tot_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nn", ",", "nflag", ",", "ni", ",", "coord"}], "}"}], ",", 
       RowBox[{
        RowBox[{"coord", "=", 
         RowBox[{"N", "[", "XYZ", "]"}]}], ";", 
        RowBox[{"nflag", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "[", "coord", "]"}]}], "]"}]}], ";", 
        RowBox[{"nn", "=", 
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"coord", "\[Rule]", "Automatic"}], ",", "coord", ",", 
           RowBox[{"{", 
            RowBox[{"\[Infinity]", ",", "tot"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"nn", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{"nflag", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"ni", "=", 
              RowBox[{"nn", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nflag", "[", 
                 RowBox[{"[", 
                  RowBox[{"ni", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "=", "i"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "2", ",", 
                 RowBox[{"Length", "[", "ni", "]"}]}], "}"}]}], "]"}]}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "nn", "]"}], ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "nflag"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MeshMergePoints", "[", 
      RowBox[{"coord_", ",", "ele_", ",", 
       RowBox[{"tot_", ":", 
        RowBox[{"10.", "^", 
         RowBox[{"-", "3"}]}]}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nflag", ",", "c2", ",", "e2", ",", "nc", ",", "nrepeat"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"nflag", "=", 
         RowBox[{"MergePoints", "[", 
          RowBox[{"coord", ",", "tot"}], "]"}]}], ";", 
        RowBox[{"nc", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"nflag", ",", "0"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nrepeat", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "coord", "]"}], "]"}], ",", "nc"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c2", "=", 
         RowBox[{"coord", "[", 
          RowBox[{"[", "nc", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"e2", "=", 
         RowBox[{"ele", "/.", 
          RowBox[{"Dispatch", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"nrepeat", ",", 
              RowBox[{"nflag", "[", 
               RowBox[{"[", "nrepeat", "]"}], "]"}]}], "]"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"e2", "=", 
         RowBox[{"e2", "/.", 
          RowBox[{"Dispatch", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"nc", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "nc", "]"}], "]"}]}], "]"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"c2", ",", "e2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"uv", "=", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"Ksp", ",", "Rsp", ",", 
         RowBox[{"Method", "->", "\"\<Pardiso\>\""}]}], "]"}]}], ";"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"18.988378`", ",", "Null"}], "}"}], 
      RowBox[{"(*", 
       RowBox[{"MergePointReverse", ",", " ", "RCM"}], "*)"}], "\n", 
      RowBox[{"{", 
       RowBox[{"18.621864`", ",", "Null"}], "}"}], 
      RowBox[{"(*", 
       RowBox[{"MergePointReverse", ",", " ", "RCM"}], "*)"}], "\n", 
      RowBox[{"{", 
       RowBox[{"17.8894359`", ",", "Null"}], "}"}], 
      RowBox[{"(*", "MergePointReverse", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"17.6684718`", ",", "Null"}], "}"}], 
      RowBox[{"(*", "MergePointReverse", "*)"}], "\n", 
      RowBox[{"{", 
       RowBox[{"19.3123469`", ",", "Null"}], "}"}], 
      RowBox[{"(*", "MergePoints", "*)"}], "\n", 
      RowBox[{"{", 
       RowBox[{"22.6278841`", ",", "Null"}], "}"}], 
      RowBox[{"(*", "MergePoint", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"23.0831525`", ",", "Null"}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"MergePoint", ",", " ", "RCM"}], "*)"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.759926307681136*^9, 3.759926324629105*^9}, {
  3.7599265186662035`*^9, 3.7599265745644007`*^9}, {3.7599266458084755`*^9, 
  3.7599266480096016`*^9}, {3.7599267840363817`*^9, 3.7599268275308695`*^9}, {
  3.7599268727454557`*^9, 3.7599271045367136`*^9}, {3.7599275690732837`*^9, 
  3.759927597474908*^9}, {3.7599307360044217`*^9, 3.7599307364414463`*^9}, {
  3.7599307906105447`*^9, 3.759930797931964*^9}, {3.877853843128534*^9, 
  3.8778538625991426`*^9}, {3.882086357185299*^9, 3.882086364784292*^9}, {
  3.89999112788198*^9, 3.8999911378918614`*^9}, {3.90003958958882*^9, 
  3.9000396153632565`*^9}, {3.9000408123397765`*^9, 3.900040831259411*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"ddc7fd27-71e5-4a3e-aaa5-706b18f234cc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"r1", "=", "1"}], ";", 
   RowBox[{"r2", "=", "2"}], ";", 
   RowBox[{"\[Theta]1", "=", "0"}], ";", 
   RowBox[{"\[Theta]2", "=", 
    RowBox[{"2", " ", "\[Pi]"}]}], ";", 
   RowBox[{"z1", "=", "0"}], ";", 
   RowBox[{"z2", "=", "3"}], ";", "\[IndentingNewLine]", 
   RowBox[{"rg", "=", 
    RowBox[{"Cuboid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "\[Theta]1", ",", "z1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r2", ",", "\[Theta]2", ",", "z2"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"sc", "=", "1"}], ";", 
   RowBox[{"dx", "=", "0.2"}], ";", 
   RowBox[{"ndim", "=", "3"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ele2", ",", "coord", ",", "ele", ",", "eleB", ",", "eleP"}], 
     "}"}], "=", 
    RowBox[{"Region2Mesh", "[", 
     RowBox[{"rg", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sc", " ", "dx"}], ")"}], "^", "ndim"}], ",", "1", ",", "0", 
      ",", 
      RowBox[{"1", "/", "sc"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fun3", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"y", "/", "2"}], "]"}]}], ",", 
      RowBox[{"x", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"y", "/", "2"}], "]"}]}], ",", "z"}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"c4", "=", 
    RowBox[{"fun3", "@@@", "coord"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot3DField", "[", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "c4", "]"}]}], "]"}], ",", 
      RowBox[{"Abaqus2Mesh", "[", 
       RowBox[{"c4", ",", "ele"}], "]"}]}], "]"}], "\n", 
    TemplateBox[{"", 
      FormBox[
       FormBox[
        TemplateBox[{
          FormBox["", TraditionalForm]}, "BarLegend", 
         DisplayFunction -> (#& ), 
         InterpretationFunction :> (RowBox[{"BarLegend", "[", 
            RowBox[{"{", 
              RowBox[{"\"TemperatureMap\"", ",", 
                RowBox[{"{", 
                  
                  RowBox[{
                   "0.00017719819830119832`", ",", "0.9995350379369445`"}], 
                  "}"}]}], "}"}], "]"}]& )], TraditionalForm], 
       TraditionalForm]},
     "Legended",
     DisplayFunction->(GridBox[{{
         TagBox[
          ItemBox[
           PaneBox[
            TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
            BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
          "SkipImageSizeLevel"], 
         ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
       GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
       AutoDelete -> False, GridBoxItemSize -> Automatic, 
       BaselinePosition -> {1, 1}]& ),
     Editable->True,
     InterpretationFunction->(RowBox[{"Legended", "[", 
        RowBox[{#, ",", 
          RowBox[{"Placed", "[", 
            RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7599320356267557`*^9, 3.759932068383629*^9}, {
   3.7599321442549686`*^9, 3.7599321694794116`*^9}, 3.7599322240225315`*^9, {
   3.8437151797583055`*^9, 3.8437151834077053`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"1fc5034d-ab19-450d-987d-08de8fa66160"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"r1", "=", "1"}], ";", 
   RowBox[{"r2", "=", "2"}], ";", 
   RowBox[{"\[Theta]1", "=", "0"}], ";", 
   RowBox[{"\[Theta]2", "=", 
    RowBox[{"2", "\[Pi]"}]}], ";", 
   RowBox[{"z1", "=", "0"}], ";", 
   RowBox[{"z2", "=", "3"}], ";", "\[IndentingNewLine]", 
   RowBox[{"rg", "=", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "\[Theta]1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r2", ",", "\[Theta]2"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"sc", "=", "1"}], ";", 
   RowBox[{"dx", "=", "0.2"}], ";", 
   RowBox[{"ndim", "=", "2"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ele2", ",", "coord", ",", "ele", ",", "eleB", ",", "eleP"}], 
     "}"}], "=", 
    RowBox[{"Region2Mesh", "[", 
     RowBox[{"rg", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sc", " ", "dx"}], ")"}], "^", "ndim"}], ",", "1", ",", "0", 
      ",", 
      RowBox[{"1", "/", "sc"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fun2", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Cos", "[", "y", "]"}]}], ",", 
      RowBox[{"x", " ", 
       RowBox[{"Sin", "[", "y", "]"}]}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"c2", "=", 
    RowBox[{"fun2", "@@@", "coord"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c3", ",", "e3"}], "}"}], "=", 
    RowBox[{"MeshMergePoints", "[", 
     RowBox[{"c2", ",", "ele"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ShowMesh", "[", 
    RowBox[{"Abaqus2Mesh", "[", 
     RowBox[{"c3", ",", "e3"}], "]"}], "]"}]}], "\n", "*)"}]], "Input",
 CellChangeTimes->{{3.75993210213056*^9, 3.7599321381596203`*^9}, 
   3.759932181360091*^9, 3.7599322135519323`*^9, 3.8437152502988663`*^9},
 CellLabel->
  "In[140]:=",ExpressionUUID->"bc3d396f-c7c9-4681-8994-f1478eeb3dbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FindPointsByFunction", "[", 
   RowBox[{"v1_List", ",", "fun_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ilist", "=", 
       RowBox[{"{", "}"}]}], ",", "y", ",", "r", ",", 
      RowBox[{"ndim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"v1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"len", "=", 
       RowBox[{"Length", "[", "v1", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fun", "[", 
           RowBox[{
           "v1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "]"}], "\[LessEqual]", "0."}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"ilist", ",", "i"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "len"}], "}"}]}], "]"}], ";", "ilist"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPointsByFunction2", "[", 
   RowBox[{"v1_List", ",", "boolfun_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "t1", "}"}], ",", 
    RowBox[{
     RowBox[{"t1", "=", 
      RowBox[{"boolfun", "@@@", "v1"}]}], ";", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"t1", ",", "True"}], "]"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPointsByFunction2", "[", 
   RowBox[{"v1_List", ",", "boolfun_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"boolfun", "@@@", "v1"}], ",", "True"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPointsByRule", "[", 
   RowBox[{"v1_List", ",", "boolfun_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"boolfun", "@@@", "v1"}], ",", "True"}], "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"boolfun", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"x", ">", "y"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.882086776287633*^9, 3.882086813715846*^9}, {
   3.8820869402505856`*^9, 3.8820869435233164`*^9}, {3.8820871283742175`*^9, 
   3.882087211421178*^9}, {3.882087249850662*^9, 3.8820872541275516`*^9}, {
   3.8820876104659166`*^9, 3.882087628423627*^9}, 3.8820886202068434`*^9, {
   3.8820973302886868`*^9, 3.8820974091470833`*^9}, 3.8952039906163225`*^9, {
   3.8958019453836794`*^9, 3.895801956581868*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"89934523-16a4-4bd2-923c-84db888ce004"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindElementByRule", "[", 
   RowBox[{"coord_", ",", "ele_", ",", "boolfun_"}], "]"}], ":=", 
  RowBox[{"FindPointsByRule", "[", 
   RowBox[{
    RowBox[{"ElementCenter1", "[", 
     RowBox[{"coord", ",", "ele"}], "]"}], ",", "boolfun"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.895204192436163*^9, 3.8952042393457627`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"5e28e5ff-ccdb-436a-84eb-2d83f13ce5d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "RemoveElementByFunctions", "]"}], ";", 
  RowBox[{
   RowBox[{"RemoveElementByFunctions", "[", 
    RowBox[{"ele0_List", ",", "coord0_List", ",", "funs_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xc", ",", "fe1", ",", "feRemain", ",", 
       RowBox[{"ele", "=", "ele0"}], ",", 
       RowBox[{"coord", "=", "coord0"}], ",", "nodeDelete", ",", "nodeRedex", 
       ",", "k", ",", "nodeRemain", ",", "nodeRule", ",", 
       RowBox[{"fun1", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "funs", "}"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xc", "=", 
       RowBox[{"ElementCenter1", "[", 
        RowBox[{"coord0", ",", "ele0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Test", " ", "funs", " ", "function"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"BooleanQ", "[", 
            RowBox[{"fi", "@@", 
             RowBox[{"coord0", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Error, the function \\\"\>\"", ",", " ", 
             RowBox[{"ToString", "[", "fi", "]"}], ",", 
             "\"\<\\\" should be defined as f[x_,y_,..] with returned value \
being True or False\>\""}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"fi", ",", "fun1"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fe1", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fun1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "@@@", "xc"}], ",", "True"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "fun1", "]"}]}], "}"}]}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "fe1", "]"}], "==", "0"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Warning, no element is to be removed.\>\"", "]"}],
          ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"Length", "[", "fe1", "]"}], "]"}], "<>", 
          "\"\< are to be removed.\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"fe1", "=", 
         RowBox[{"FindElement", "[", 
          RowBox[{"coord", ",", "ele", ",", "holeXmin", ",", "holeXmax"}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"feRemain", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "ele", "]"}], "]"}], ",", "fe1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nodeDelete", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"ele", "[", 
            RowBox[{"[", "fe1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"ele", "[", 
              RowBox[{"[", "fe1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"ele", "[", 
              RowBox[{"[", "feRemain", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nodeRedex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "coord", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nodeRedex", "[", 
        RowBox[{"[", "nodeDelete", "]"}], "]"}], "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", "1"}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"nodeRedex", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
           RowBox[{
            RowBox[{"nodeRedex", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"k", "++"}]}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "coord", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodeRemain", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "coord", "]"}], "]"}], ",", "nodeDelete"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nodeRule", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"ListRule", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "coord", "]"}], "]"}], ",", "nodeRedex"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ele", "=", 
       RowBox[{"ele", "/.", "nodeRule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ele", "=", 
       RowBox[{"ele", "[", 
        RowBox[{"[", "feRemain", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coord", "=", 
       RowBox[{"coord", "[", 
        RowBox[{"[", "nodeRemain", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ele", ",", "coord"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.882086474457405*^9, 3.8820865485196404`*^9}, {
   3.8820866031160703`*^9, 3.8820866250016356`*^9}, {3.882086659800207*^9, 
   3.8820866907440968`*^9}, {3.8820868370922976`*^9, 3.882086894782778*^9}, {
   3.882087645468241*^9, 3.882087747437474*^9}, {3.8820877791852283`*^9, 
   3.882087853517127*^9}, {3.8820879161296167`*^9, 3.8820879731259613`*^9}, {
   3.882088048926548*^9, 3.8820880747136364`*^9}, {3.882088117066742*^9, 
   3.882088120350279*^9}, {3.882088202170992*^9, 3.882088202370299*^9}, {
   3.8820882391739426`*^9, 3.88208826793106*^9}, 3.8820883190809107`*^9, {
   3.882088359379349*^9, 3.882088419252412*^9}, {3.882088461899906*^9, 
   3.8820885009447265`*^9}, {3.882088552692645*^9, 3.882088552853056*^9}, {
   3.8820885906402984`*^9, 3.8820885968761683`*^9}, {3.882088878684469*^9, 
   3.8820888979943867`*^9}, 3.8820956405208344`*^9, {3.8820959123123837`*^9, 
   3.882095913814474*^9}, {3.8820971417447743`*^9, 3.882097146665269*^9}, {
   3.9001284065523567`*^9, 3.900128475707123*^9}, 3.9001285132852497`*^9, {
   3.934367498463516*^9, 3.934367498924485*^9}, 
   3.934370065624257*^9},ExpressionUUID->"65757453-ee34-4a08-a288-\
68b50a46a078"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    GraphicsBox[{
      {EdgeForm[GrayLevel[0]], FaceForm[None], 
       GraphicsComplexBox[{{0., 0.}, {0., 1.}, {1., 0.}, {1., 1.}, {0.5, 
        0.}, {1., 0.5}, {0.5, 1.}, {0., 0.5}}, {PolygonBox[{{1, 3, 4, 2}}], 
         {GrayLevel[0], InsetBox["1", {0.5, 0.5}, {-1, -1}]}}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[None], 
       GraphicsComplexBox[{{0., 0.}, {0., 1.}, {1., 0.}, {1., 1.}, {0.5, 
        0.}, {1., 0.5}, {0.5, 1.}, {0., 
        0.5}}, {PointBox[{1, 2, 3, 4, 5, 6, 7, 8}], 
         {RGBColor[1, 0, 0], InsetBox["1", {0., 0.}, {-1, -1}], 
          InsetBox["2", {0., 1.}, {-1, -1}], 
          InsetBox["3", {1., 0.}, {-1, -1}], 
          InsetBox["4", {1., 1.}, {-1, -1}], 
          InsetBox["5", {0.5, 0.}, {-1, -1}], 
          InsetBox["6", {1., 0.5}, {-1, -1}], 
          InsetBox["7", {0.5, 1.}, {-1, -1}], 
          InsetBox["8", {0., 0.5}, {-1, -1}]}}]}}], 
    Graphics3DBox[{
      {EdgeForm[GrayLevel[0]], FaceForm[None, None], 
       GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGAQAWJmBhj4sB8HbU9AnJA8IXPR1aGLE6kOpz9wyMP5ONyJ
Uz0h+3Hw0e0h2n5C+nD5Hy4OAMhKRpM=
        "], {
         Polygon3DBox[{{1, 2, 3, 4}, {8, 7, 6, 5}, {1, 5, 6, 2}, {2, 6, 7, 
          3}, {3, 7, 8, 4}, {4, 8, 5, 1}}], 
         {GrayLevel[0], Text3DBox[
           FormBox["1", StandardForm], {0., 0., -1.}, {-1, -1}], Text3DBox[
           FormBox["2", StandardForm], {0., 0., 1.}, {-1, -1}], Text3DBox[
           FormBox["3", StandardForm], {0., -1., 0.}, {-1, -1}], Text3DBox[
           FormBox["4", StandardForm], {1., 0., 0.}, {-1, -1}], Text3DBox[
           FormBox["5", StandardForm], {0., 1., 0.}, {-1, -1}], Text3DBox[
           FormBox["6", StandardForm], {-1., 0., 0.}, {-1, -1}]}}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[None, None], 
       GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGAQAWJmBhj4sB8HbU9AnJA8IXPR1aGLE6kOpz9wyMP5ONyJ
Uz0h+3Hw0e0h2n5C+nD5Hy4OAMhKRpM=
        "], {
         Point3DBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 
          17, 18, 19, 20}], 
         {RGBColor[1, 0, 0], Text3DBox[
           FormBox["1", StandardForm], {-1., -1., -1.}, {-1, -1}], Text3DBox[
           FormBox["2", StandardForm], {1., -1., -1.}, {-1, -1}], Text3DBox[
           FormBox["3", StandardForm], {1., 1., -1.}, {-1, -1}], Text3DBox[
           FormBox["4", StandardForm], {-1., 1., -1.}, {-1, -1}], Text3DBox[
           FormBox["5", StandardForm], {-1., -1., 1.}, {-1, -1}], Text3DBox[
           FormBox["6", StandardForm], {1., -1., 1.}, {-1, -1}], Text3DBox[
           FormBox["7", StandardForm], {1., 1., 1.}, {-1, -1}], Text3DBox[
           FormBox["8", StandardForm], {-1., 1., 1.}, {-1, -1}], Text3DBox[
           FormBox["9", StandardForm], {0., -1., -1.}, {-1, -1}], Text3DBox[
           FormBox["10", StandardForm], {1., 0., -1.}, {-1, -1}], Text3DBox[
           FormBox["11", StandardForm], {0., 1., -1.}, {-1, -1}], Text3DBox[
           FormBox["12", StandardForm], {-1., 0., -1.}, {-1, -1}], Text3DBox[
           FormBox["13", StandardForm], {0., -1., 1.}, {-1, -1}], Text3DBox[
           FormBox["14", StandardForm], {1., 0., 1.}, {-1, -1}], Text3DBox[
           FormBox["15", StandardForm], {0., 1., 1.}, {-1, -1}], Text3DBox[
           FormBox["16", StandardForm], {-1., 0., 1.}, {-1, -1}], Text3DBox[
           FormBox["17", StandardForm], {-1., -1., 0.}, {-1, -1}], Text3DBox[
           FormBox["18", StandardForm], {1., -1., 0.}, {-1, -1}], Text3DBox[
           FormBox["19", StandardForm], {1., 1., 0.}, {-1, -1}], Text3DBox[
           FormBox["20", StandardForm], {-1., 1., 0.}, {-1, -1}]}}]}},
     Boxed->False,
     ImageSize->{228.40968152940275`, 256.},
     SphericalRegion->True,
     ViewAngle->0.49148558777104734`,
     ViewPoint->{1.434532039290374, -2.3510128294209216`, 1.965923829691179},
     ViewVertical->{0.04373140751891234, 0.011335857426881932`, 
      0.9989790099560713}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Q1EdgePair", "[", 
      RowBox[{"{", 
       RowBox[{"i1_", ",", "i2_", ",", "i3_", ",", "i4_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i1", ",", "i2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", "i3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i3", ",", "i4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i4", ",", "i1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H1EdgePair", "[", 
      RowBox[{"{", 
       RowBox[{
       "i1_", ",", "i2_", ",", "i3_", ",", "i4_", ",", "i5_", ",", "i6_", ",",
         "i7_", ",", "i8_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i1", ",", "i2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", "i3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i3", ",", "i4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i4", ",", "i1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i5", ",", "i6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i6", ",", "i7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i7", ",", "i8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i8", ",", "i5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "i5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", "i6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i3", ",", "i7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i4", ",", "i8"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q1EdgePairS", "[", 
      RowBox[{"{", 
       RowBox[{"i1_", ",", "i2_", ",", "i3_", ",", "i4_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "i3"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "i4"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i4", ",", "i1"}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H1EdgePairS", "[", 
      RowBox[{"{", 
       RowBox[{
       "i1_", ",", "i2_", ",", "i3_", ",", "i4_", ",", "i5_", ",", "i6_", ",",
         "i7_", ",", "i8_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "i3"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "i4"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i4", ",", "i1"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i5", ",", "i6"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i6", ",", "i7"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i7", ",", "i8"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i8", ",", "i5"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "i5"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "i6"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "i7"}], "}"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"i4", ",", "i8"}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q1H1ToQ2H2", "[", 
      RowBox[{"ele_List", ",", "coord_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndim", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"coord", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "len", ",", "ep", 
         ",", "ep0", ",", "asoci", ",", "singleK", ",", "newCoord", ",", 
         "newEle"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"ele", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[NotEqual]", 
            RowBox[{"2", "^", "ndim"}]}], ")"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Error, only first order Q1 or H1 element is supported!\>\"", 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ndim", "\[Equal]", "2"}], ",", 
          RowBox[{"ep", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Q1EdgePairS", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "ele"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"ep", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"H1EdgePairS", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "ele"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ep", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ep", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ep0", "=", 
         RowBox[{"DeleteDuplicates", "[", "ep", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"asoci", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"ep0", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "ep0", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newCoord", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"0.5", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"coord", "[", 
               RowBox[{"[", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"coord", "[", 
               RowBox[{"[", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "ep0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"ep0", ",", 
            RowBox[{"ListPlot", "[", "coord", "]"}], ",", 
            RowBox[{"ListPlot", "[", "newCoord", "]"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"singleK", "=", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{"asoci", ",", "ep", ",", "0"}], "]"}], "+", 
          RowBox[{"Length", "[", "coord", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"singleK", "=", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"singleK", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "ele", "]"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "singleK", "]"}], "/", 
              RowBox[{"Length", "[", "ele", "]"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newEle", "=", 
         RowBox[{"ArrayPad", "[", 
          RowBox[{"ele", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ndim", "\[Equal]", "2"}], ",", "4", ",", "12"}], 
                "]"}]}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "newEle", "]"}], ",", 
            RowBox[{"Dimensions", "[", "singleK", "]"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newEle", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"ele", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", "1"}], ";;", 
             RowBox[{"-", "1"}]}]}], "]"}], "]"}], "=", "singleK"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"newEle", ",", 
          RowBox[{"Join", "[", 
           RowBox[{"coord", ",", "newCoord"}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Test", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rg", "=", 
      RowBox[{"Cuboid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", "coord", ",", "ele", ",", "eleB", ",", "eleP"}], 
       "}"}], "=", 
      RowBox[{"Region2Mesh", "[", 
       RowBox[{"rg", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cN", ",", "eN"}], "}"}], "=", 
      RowBox[{"MeshLayerGrow", "[", 
       RowBox[{"ele", ",", "coord", ",", "eleB", ",", "eleP", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}], ",", "2", ",", 
        "0.1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ShowMesh", "[", 
        RowBox[{"m1", ",", "True"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"ShowMesh", "[", 
        RowBox[{
         RowBox[{"Abaqus2Mesh", "[", 
          RowBox[{"cN", ",", "eN"}], "]"}], ",", "True"}], "]"}], 
       "\[IndentingNewLine]", "ele", "\[IndentingNewLine]", "eN", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ele2", ",", "cN2"}], "}"}]}], "=", 
      RowBox[{"Q1H1ToQ2H2", "[", 
       RowBox[{"eN", ",", "cN"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ShowMesh", "[", 
      RowBox[{
       RowBox[{"Abaqus2Mesh", "[", 
        RowBox[{"cN2", ",", "ele2"}], "]"}], ",", "True"}], "]"}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.8411094567468004`*^9, {3.841109491172741*^9, 3.841109546064158*^9}, {
   3.841109626534169*^9, 3.8411097916707315`*^9}, 3.841110100893733*^9, {
   3.841110239147751*^9, 3.8411102411465645`*^9}, {3.841110407510326*^9, 
   3.8411104291143727`*^9}, {3.8411105509296618`*^9, 3.841110676909001*^9}, {
   3.841110757994624*^9, 3.841110872875515*^9}, {3.8411109207103353`*^9, 
   3.8411109948198633`*^9}, {3.841111080771901*^9, 3.8411112724281387`*^9}, {
   3.841111306156042*^9, 3.8411113074026694`*^9}, {3.8411114142698045`*^9, 
   3.841111463812845*^9}, {3.8411115774944744`*^9, 3.841111772656584*^9}, {
   3.8411119249584303`*^9, 3.8411119763510466`*^9}, {3.8411120106230106`*^9, 
   3.84111207202977*^9}, {3.8411474364787173`*^9, 3.841147448269495*^9}, {
   3.8411475815310345`*^9, 3.8411475973055277`*^9}, {3.8411476761068487`*^9, 
   3.841147683386697*^9}, {3.8411477591559258`*^9, 3.8411477654996758`*^9}, 
   3.841147799202836*^9, {3.841148104960681*^9, 3.841148114991928*^9}, {
   3.841148186872834*^9, 3.841148187856897*^9}, {3.8411488524443254`*^9, 
   3.8411488960620117`*^9}, {3.84114899251893*^9, 3.841148996003312*^9}, {
   3.84114904487638*^9, 3.841149077699542*^9}, {3.8411492702368026`*^9, 
   3.8411493061901646`*^9}, {3.841149339981105*^9, 3.841149343987002*^9}, {
   3.8411493835080533`*^9, 3.841149425793713*^9}, 3.8411495392472725`*^9, {
   3.8411559967099447`*^9, 3.8411559968674235`*^9}, {3.8412001058805723`*^9, 
   3.841200121510975*^9}, {3.8412002517664804`*^9, 3.8412002968002844`*^9}, {
   3.8412005096615076`*^9, 3.8412005104902368`*^9}, {3.8412006825941153`*^9, 
   3.8412007252717695`*^9}, {3.841200768012621*^9, 3.8412007898957677`*^9}, {
   3.8821140123453255`*^9, 3.8821140361344647`*^9}, {3.9343700968999186`*^9, 
   3.9343701025701246`*^9}},ExpressionUUID->"0da5cded-a08a-46ce-9f98-\
14e2be28912b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot stream or vector", "Section",
 CellChangeTimes->{{3.8922768382622643`*^9, 
  3.8922768452509885`*^9}},ExpressionUUID->"8e7469ff-6891-4301-9a16-\
7bfdac6ff7b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlotVectorField", "[", 
   RowBox[{"xyz_", ",", "vec_"}], "]"}], ":=", 
  RowBox[{"ListVectorPlot", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xyz", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "vec", "]"}]}], "}"}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"VectorPoints", "\[Rule]", "All"}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotTensorField", "[", 
    RowBox[{"xyz_", ",", "tensor_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "vec", "}"}], ",", 
     RowBox[{
      RowBox[{"vec", "=", 
       RowBox[{"TensorAxis2D", "[", "tensor", "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PlotVectorField", "[", 
         RowBox[{"xyz", ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"PlotVectorField", "[", 
         RowBox[{"xyz", ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"3", ";;", "4"}]}], "]"}], "]"}]}], "]"}]}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorAxis2D", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real", ",", "1"}], "}"}], 
      RowBox[{"(*", 
       RowBox[{"m11", ",", "m12", ",", "m22"}], "*)"}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "em", ",", "el", ",", "ev", ",", "a$", ",", "b$", ",", "c$", ",", 
         "em0"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a$", ",", "b$", ",", "c$"}], "}"}], "=", 
         RowBox[{"Chop", "[", "m", "]"}]}], ";", 
        RowBox[{"em", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a$", "^", "2"}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"b$", "^", "2"}]}], "-", 
           RowBox[{"2", " ", "a$", " ", "c$"}], "+", 
           RowBox[{"c$", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"em0", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"em", "<", 
            RowBox[{"10", "^", 
             RowBox[{"-", "14"}]}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "14"}]}], ",", "em"}], "]"}]}], ";", 
        RowBox[{"el", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.5", " ", 
            RowBox[{"(", 
             RowBox[{"a$", "+", "c$", "-", "em0"}], ")"}]}], ",", 
           RowBox[{"0.5", " ", 
            RowBox[{"(", 
             RowBox[{"a$", "+", "c$", "+", "em0"}], ")"}]}]}], "}"}]}], ";", 
        RowBox[{"ev", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a$", "-", "c$", "-", "em", "+", 
             RowBox[{"10.", "^", 
              RowBox[{"-", "30"}]}]}], ",", 
            RowBox[{"2", " ", "b$"}]}], "}"}], " ", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"10.", "^", 
             RowBox[{"-", "60"}]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"b$", "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a$", "-", "c$", "-", "em"}], ")"}], "^", "2"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ev", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
          RowBox[{"ev", "*=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"el", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"ev", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"el", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"ev", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"el", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], 
           RowBox[{"ev", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"el", "[", 
            RowBox[{"[", "2", "]"}], "]"}], 
           RowBox[{"ev", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}], "]"}], ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}], 
     ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotVectorField", "[", 
   RowBox[{"xyz_", ",", "vec_", ",", "range_"}], "]"}], ":=", 
  RowBox[{"ListVectorPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xyz", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"vec", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vec", "]"}]}], "}"}]}], "]"}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"VectorPoints", "\[Rule]", "All"}]}], "*)"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
    RowBox[{"VectorPoints", "->", "All"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotTensorField", "[", 
     RowBox[{"xyz_", ",", "tensor_", ",", "range_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "vec", "}"}], ",", 
      RowBox[{
       RowBox[{"vec", "=", 
        RowBox[{"TensorAxis2D", "[", "tensor", "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PlotVectorField", "[", 
          RowBox[{"xyz", ",", 
           RowBox[{"vec", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"PlotRange", "->", "range"}]}], "]"}], ",", 
         RowBox[{"PlotVectorField", "[", 
          RowBox[{"xyz", ",", 
           RowBox[{"vec", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"3", ";;", "4"}]}], "]"}], "]"}], ",", 
           RowBox[{"PlotRange", "->", "range"}]}], "]"}]}], "}"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyStreamPlot0", "[", 
    RowBox[{"xVel_", ",", "yVel_", ",", "mesh_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xfun", ",", "yfun"}], "}"}], ",", 
     RowBox[{
      RowBox[{"xfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", "xVel"}], "]"}]}], ";", 
      RowBox[{"yfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", "yVel"}], "]"}]}], ";", 
      RowBox[{"StreamPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"yfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}], ",", 
        RowBox[{"Sequence", "[", 
         RowBox[{
          RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", "All"}], ",", 
          RowBox[{"StreamStyle", "->", "Orange"}], ",", 
          RowBox[{"StreamScale", "->", "True"}], ",", 
          RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"uxfun", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "m1", "}"}], ",", 
        RowBox[{"uvwN", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8922768683178964`*^9, 3.8922768697581663`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"d16073cc-9bb4-4e0d-b3b8-c765c9580839"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PlotTensorField", "[", 
    RowBox[{"xyz_", ",", "tensor_", ",", "mesh_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "vec", "}"}], ",", 
     RowBox[{
      RowBox[{"vec", "=", 
       RowBox[{"TensorAxis2D", "[", "tensor", "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MyStreamPlot0", "[", 
         RowBox[{
          RowBox[{"vec", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "mesh"}], "]"}], 
        ",", 
        RowBox[{"MyStreamPlot0", "[", 
         RowBox[{
          RowBox[{"vec", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", "mesh"}], "]"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotVectorField", "[", 
   RowBox[{"xyz_", ",", "vec_", ",", "mesh_"}], "]"}], ":=", 
  RowBox[{"MyStreamPlot0", "[", 
   RowBox[{
    RowBox[{"vec", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"vec", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "mesh"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyVectorPlot0", "[", 
    RowBox[{"xVel_", ",", "yVel_", ",", "mesh_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xfun", ",", "yfun"}], "}"}], ",", 
     RowBox[{
      RowBox[{"xfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", "xVel"}], "]"}]}], ";", 
      RowBox[{"yfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", "yVel"}], "]"}]}], ";", 
      RowBox[{"VectorPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"yfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}], ",", 
        RowBox[{"Sequence", "[", 
         RowBox[{
          RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", "All"}], ",", 
          RowBox[{"VectorScaling", "->", "True"}], ",", 
          RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyVectorPlot0", "[", 
    RowBox[{"vec_", ",", "mesh_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xfun", ",", "yfun"}], "}"}], ",", 
     RowBox[{
      RowBox[{"xfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", 
         RowBox[{"vec", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"yfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", 
         RowBox[{"vec", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"VectorPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"yfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}], ",", 
        RowBox[{"Sequence", "[", 
         RowBox[{
          RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", "All"}], ",", 
          RowBox[{"VectorScaling", "->", "True"}], ",", 
          RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"uxfun", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "m1", "}"}], ",", 
        RowBox[{"uvwN", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], "]"}], 
   "*)"}], 
  RowBox[{"(*", 
   RowBox[{"very", " ", 
    RowBox[{"fast", "."}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.892276905821608*^9, 3.892276923209299*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"c086a0b0-77f3-4985-bc6b-32b5bd8f5df5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"pts", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"1000", ",", "2"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"nF", "=", 
    RowBox[{"Nearest", "[", 
     RowBox[{"pts", "->", "\"\<Index\>\""}], "]"}]}], ";", "\n", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"pts", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
     RowBox[{"Epilog", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Tooltip", "[", 
          RowBox[{
           RowBox[{"Point", "[", 
            RowBox[{"{", "#", "}"}], "]"}], ",", 
           RowBox[{
            RowBox[{"nF", "[", "#", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", "pts"}], 
       ")"}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{3.8923539050991077`*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"93006866-db6f-4b62-9e24-8fb85b9c37d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyPlot0", "[", 
    RowBox[{"xVel_", ",", "yVel_", ",", "mesh_", ",", 
     RowBox[{"plotFun_", ":", "StreamPlot"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xfun", ",", "yfun"}], "}"}], ",", 
     RowBox[{
      RowBox[{"xfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", "xVel"}], "]"}]}], ";", 
      RowBox[{"yfun", "=", 
       RowBox[{"ElementMeshInterpolation", "[", 
        RowBox[{
         RowBox[{"{", "mesh", "}"}], ",", "yVel"}], "]"}]}], ";", 
      RowBox[{"plotFun", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"yfun", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}], ",", 
        RowBox[{"Sequence", "[", 
         RowBox[{
          RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", "All"}], ",", 
          RowBox[{"StreamStyle", "->", "Orange"}], ",", 
          RowBox[{"StreamScale", "->", "True"}], ",", 
          RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892276992262765*^9, 3.892276992690611*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"05cf5322-9abf-42be-b167-af1d7639d813"],

Cell[CellGroupData[{

Cell["Plot damage field partially.", "Subsection",
 CellChangeTimes->{{3.904726847715288*^9, 
  3.904726855805978*^9}},ExpressionUUID->"6f129ac9-e7c1-4fb9-8292-\
dbcc785ff197"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "DamageVaribleField", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DamageVaribleField", "[", 
    RowBox[{"Hdirect_", ",", "ele_", ",", "coord_", ",", "mat0_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "HnodeValue", "}"}], ",", 
     RowBox[{
      RowBox[{"HnodeValue", "=", 
       RowBox[{"MeanGaussPointToNode", "[", 
        RowBox[{"Hdirect", ",", "ele", ",", "coord"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", "mat0", "]"}], "==", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"HnodeValue", "/", 
         RowBox[{"(", 
          RowBox[{"HnodeValue", "+", 
           RowBox[{
            RowBox[{"mat0", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "/", 
            RowBox[{"mat0", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}], ",", 
        RowBox[{"HnodeValue", "/", 
         RowBox[{"(", 
          RowBox[{"HnodeValue", "+", 
           RowBox[{
            RowBox[{"mat0", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}], "/", 
            RowBox[{"mat0", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "5"}], "]"}], "]"}]}]}], ")"}]}]}], "]"}]}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", "DamageVaribleFieldOrder", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DamageVaribleFieldOrder", "[", 
     RowBox[{"Hdirect_", ",", "ele_", ",", "coord_", ",", "mat0_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "HnodeValue", "}"}], ",", 
      RowBox[{
       RowBox[{"HnodeValue", "=", 
        RowBox[{"MeanGaussPointToNode", "[", 
         RowBox[{"Hdirect", ",", "ele", ",", "coord"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "mat0", "]"}], "==", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"HnodeValue", "/", 
          RowBox[{"(", 
           RowBox[{"HnodeValue", "+", 
            RowBox[{
             RowBox[{"mat0", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "/", 
             RowBox[{"mat0", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"HnodeValue", "/", 
          RowBox[{"(", 
           RowBox[{"HnodeValue", "+", 
            RowBox[{
             RowBox[{"mat0", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "4"}], "]"}], "]"}], "/", 
             RowBox[{"mat0", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "5"}], "]"}], "]"}]}]}], ")"}]}]}], 
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPointsIndex1D", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xmin", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xmax", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", "r", ",", 
         RowBox[{"vt", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "v1", "]"}], "}"}]}], "]"}]}]}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ">", "xmin"}], "&&", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "<", "xmax"}]}], ",", 
             RowBox[{
              RowBox[{"vt", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "1"}]}], "]"}], ";"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "v1", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Position", "[", 
         RowBox[{"vt", ",", "1"}], "]"}]}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectData", "[", 
    RowBox[{"coord_", ",", "nodeValue_", ",", "xmin_", ",", "xmax_"}], "]"}], 
   ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "set1", "}"}], ",", 
     RowBox[{
      RowBox[{"set1", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"FindPointsIndex1D", "[", 
         RowBox[{"nodeValue", ",", "xmin", ",", "xmax"}], "]"}], "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coord", "[", 
         RowBox[{"[", "set1", "]"}], "]"}], ",", 
        RowBox[{"nodeValue", "[", 
         RowBox[{"[", "set1", "]"}], "]"}]}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"My3DpointPlot2", "[", 
    RowBox[{"coord_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ri", "=", 
        RowBox[{"Min", "[", "f", "]"}]}], ",", 
       RowBox[{"rx", "=", 
        RowBox[{"Max", "[", "f", "]"}]}], ",", "data"}], "}"}], ",", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"coord", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"coord", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"coord", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", "f"}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
                RowBox[{"Rescale", "[", 
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ri", ",", "rx"}], "}"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"Most", "[", "#1", "]"}], "]"}]}], "}"}], "&"}], ")"}],
           "/@", "data"}], "}"}], ",", 
        RowBox[{"Boxed", "->", "False"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"My3DpointPlot2", "[", 
    RowBox[{"coord_", ",", "f_", ",", "box1_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ri", "=", 
        RowBox[{"Min", "[", "f", "]"}]}], ",", 
       RowBox[{"rx", "=", 
        RowBox[{"Max", "[", "f", "]"}]}], ",", "data"}], "}"}], ",", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"coord", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"coord", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"coord", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", "f"}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
          RowBox[{"Cuboid", "[", 
           RowBox[{
            RowBox[{"box1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"box1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
                 RowBox[{"Rescale", "[", 
                  RowBox[{
                   RowBox[{"Last", "[", "#1", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"ri", ",", "rx"}], "}"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Most", "[", "#1", "]"}], "]"}]}], "}"}], "&"}], 
            ")"}], "/@", "data"}]}], "}"}], ",", 
        RowBox[{"Boxed", "->", "False"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"PlotDamageField", "[", 
   RowBox[{"Hdirect_", ",", "ele_", ",", "coord_", ",", "mat0_", ",", 
    RowBox[{"{", 
     RowBox[{"xmin_", ",", "xmax_"}], "}"}], ",", "box1_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dvalue", ",", "cd2", ",", "dv2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"dvalue", "=", 
      RowBox[{"DamageVaribleField", "[", 
       RowBox[{"Hdirect", ",", "ele", ",", "coord", ",", "mat0"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cd2", ",", "dv2"}], "}"}], "=", 
      RowBox[{"SelectData", "[", 
       RowBox[{"coord", ",", "dvalue", ",", "xmin", ",", "xmax"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"My3DpointPlot2", "[", 
      RowBox[{"cd2", ",", "dv2", ",", "box1"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"PlotDamageField0", "[", 
   RowBox[{"Hdirect_", ",", "ele_", ",", "coord_", ",", "mat0_", ",", 
    RowBox[{"{", 
     RowBox[{"xmin_", ",", "xmax_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dvalue", ",", "cd2", ",", "dv2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"dvalue", "=", 
      RowBox[{"DamageVaribleField", "[", 
       RowBox[{"Hdirect", ",", "ele", ",", "coord", ",", "mat0"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cd2", ",", "dv2"}], "}"}], "=", 
      RowBox[{"SelectData", "[", 
       RowBox[{"coord", ",", "dvalue", ",", "xmin", ",", "xmax"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"My3DpointPlot2", "[", 
      RowBox[{"cd2", ",", "dv2"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.904726810102808*^9, 3.904726810772893*^9}, {
   3.9047268620830097`*^9, 3.9047268666579466`*^9}, 3.9047903010864706`*^9, {
   3.907229240707706*^9, 3.9072292962031975`*^9}, {3.907229330103326*^9, 
   3.9072293307533293`*^9}, {3.9072301001966743`*^9, 3.907230100680133*^9}, {
   3.9343675242221932`*^9, 
   3.934367529143837*^9}},ExpressionUUID->"86d1868a-87c4-4892-8869-\
e712e9986486"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "DamageVaribleFieldOrder", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DamageVaribleFieldOrder", "[", 
    RowBox[{"Hdirect_", ",", "ele_", ",", "coord_", ",", "mat0_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"HnodeValue", ",", "gc", ",", "lp", ",", "vdT"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HnodeValue", "=", 
       RowBox[{"MeanGaussPointToNode", "[", 
        RowBox[{"Hdirect", ",", "ele", ",", "coord"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", "mat0", "]"}], "==", "2"}], ",", 
        RowBox[{
         RowBox[{"gc", "=", 
          RowBox[{"mat0", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ";", 
         RowBox[{"lp", "=", 
          RowBox[{"mat0", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ";", 
         RowBox[{"vdT", "=", 
          RowBox[{"mat0", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"gc", "=", 
          RowBox[{"mat0", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";", 
         RowBox[{"lp", "=", 
          RowBox[{"mat0", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "5"}], "]"}], "]"}]}], ";", 
         RowBox[{"vdT", "=", 
          RowBox[{"mat0", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "7"}], "]"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DamageValueSRCompile", "[", 
       RowBox[{"HnodeValue", ",", "lp", ",", "gc", ",", "vdT"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DamageValueSRCompile", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HmaxI", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lp", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"gc", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vdT", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sValue", ",", 
         RowBox[{"(*", 
          RowBox[{"rValue", ","}], "*)"}], "tempValue"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempValue", "=", 
         RowBox[{"HmaxI", " ", 
          RowBox[{"lp", "/", "gc"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Abs", "[", "vdT", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vdT", "<", "0"}], ",", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{
            "damage", " ", "model", " ", "without", " ", "treshold", " ", 
             "value"}], ")"}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sValue", "=", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"lp", " ", 
                 RowBox[{"HmaxI", "/", "gc"}]}], ")"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"lp", " ", 
                  RowBox[{"HmaxI", "/", "gc"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ")"}]}]}], 
           ";"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"rValue", "=", 
             RowBox[{"1", "/", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"Power", "[", 
                  RowBox[{
                   RowBox[{"lp", " ", 
                    RowBox[{"HmaxI", "/", "gc"}]}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}], ",", 
                RowBox[{"1", "-", "vdT"}]}], "]"}]}]}], ";"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{
            "damage", " ", "model", " ", "with", " ", "treshold", " ", 
             "value"}], ")"}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sValue", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"tempValue", "<=", "1."}], ",", "0.", ",", 
              RowBox[{"1", "-", 
               RowBox[{"Power", "[", 
                RowBox[{"tempValue", ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "vdT"}]}], "]"}]}]}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"rValue", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"tempValue", "<=", "1."}], ",", "1.", ",", 
              RowBox[{"Power", "[", 
               RowBox[{"tempValue", ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"vdT", "+", "1"}], ")"}]}], "/", "vdT"}]}], 
               "]"}]}], "]"}]}], ";"}], "*)"}], "]"}], ";", 
        "\[IndentingNewLine]", "sValue"}]}], "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}]}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   TemplateBox[{
     RowBox[{"\"Wed 25 Oct 2023\""}], 
     RowBox[{"DateObject", "[", 
       RowBox[{
         RowBox[{"{", 
           RowBox[{"2023", ",", "10", ",", "25"}], "}"}], ",", "\"Day\""}], 
       "]"}]},
    "DateObject",
    Editable->False], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.934367633880061*^9, 
  3.9343676354345417`*^9}},ExpressionUUID->"ad3a4e0f-87a2-40bf-bc87-\
6fddc26ad6af"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Q1 H1 mesh refinement. 1:3.", "Section",
 CellChangeTimes->{{3.8995436573429613`*^9, 
  3.899543668607149*^9}},ExpressionUUID->"5a766905-a619-46cb-b032-\
9d1c31ae4d9c"],

Cell[CellGroupData[{

Cell["There are several cases should be considered. In 2D, ", "Subsubsection",
 CellChangeTimes->{{3.8995436757253275`*^9, 
  3.899543688702545*^9}},ExpressionUUID->"3ba68173-efc5-4315-8ff1-\
2e7100099934"],

Cell[TextData[{
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt2U+uY1cVhfEHdGgyADogBkGXJt2gDCARIaITpAQJMRFmyRhMRSWVHvZ7
fr6++/zZe/8+3URJKeV1vOqsz67K7779x1d/++XLy8tPv/70t6+++deffvzx
m3//5Tef/uXrH376+/c/fPfXP//wz+++/+7HP377q08/+PtfvLz859NfP//z
BQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABa8oLB
/Pe3f/j8rP6lBgryemKrt16QL92SGDCCq4mtXnw11DuZ1XvCbK4mZmWB6HYC
V92u3hNmY2WDuC1Wt+Hc1rt6T5jN7TXwxzUhMNgEGAxv3gQSO8mb+iKxWN7s
dvWvPGbz3mVYfa7E3NGXbqN476Nh9bkwmzufaKuPlhUGmwCD4TP3v5avPl0+
3lyWYmO583vz1UfDbO4bzNYOcWdZig3kzh8trj4aZvPhn46uPmAmDhlMt89x
/3+OrD4dZnNlsMtbN2T1GXNwf1k+HUL4sOTVB8Rs3rwAtnaUNxt7uUGxJ/mw
5NUHxGweNJit3edBg733X+IRHil59Rkxm/cugKE9zntdMVggD5a89pCYz50L
YGuPcKelNw12/6fgPRgMb3LIYLZ2yxMGu/+zcMvjJS88JJZw/wIY2n3u93PI
YLq9w+MlrzohVvHhBTC09/iwmTsGe+Sn4zOHPiZWHRKreOQC2NqbnDTYI6+A
oyUvOSQW8pzBbO2RQj402IOv0xkGw30evACG9poH22CwkzzxMTH/kFjL4xfA
1r4QaLDHX60bz5U8+ZBYzqELYGuXIyU8aLBDr9kHBsMjMNghDjVwxmANu33N
0x8TMw+JHTh6AZoPbZDBjr5yeZ4uedoJsQlPXIC2Wzv6xg8Z7InXr8qZj4lp
h8QmhBisw9aeeMtHDfZcSjFOfkzMOST24bkL0HBoqwzWodvXMBgO8fQFaDW0
597sEwZ7OqsG5z8mJhwSW3HmAjTZ2tNv8zmDnUlMTcjHxOhDYjcY7EN2MFjV
bl/DYHiCkxeg/NDOvMGnDXYyNyNRHxNDD4kNOX8BCm/t5Fs7Y7Dz6bmI+pgY
d0LsyQiDldnaWoOdP0AWAr/ojjsk9iTkApQc2vk3NcJgNbp9TezHxKBDYlui
LkCxoYW8nfMGizrJzjAYzhB4ASptbR+DRR1mT8K/6I44JHaGwW6JeiNRBgs8
0laM+JgIPyQ2J/YCFBha4FtgsPswGM4TfgGyb21Pg8UebAcGfdGNPST2Z4LB
Em0t9uSxBgs/3loGfUwEnhApGHEBkg4t/NgTDJal2yvGfdENPCRSMOgCZBza
/gYbccj5DP2iG3VIZGHcBci1tRGnHWGwS7Zib2EwBDLTYNtubdA5Bxnsklli
o7/ohhwSiRh6AbIMjcHmMOGL7vkXRC5GX4D9tzbuhOMMdslQ7C0MhnAmXICd
tzb0t7pDDXbZu9hb5nzRDXlNJILBxp1tvsG26vaKOR8TUS+LLMy5AHsObfSp
Rhvssmuxt0z7ohv1ssjCtAuw29YmfIGZYLDLfsXeMvOLbuArIwULDbZ2axMO
M8dgl+0lxmAYx8wLsM/Q5pyEwS7Tf6se++LYn8kXYIdvYtPOMM1gl50k9ma9
077ohr8+Nmf+BQi/2Pcn88gT9daumGmwywCJnS92QtsM1pxNDLb8GfFO9zHY
8noZDINYcgGWj6iYwZa3x2BYxaoLsHxHZQy2vLq1PTNYcxhskL4uXQ323sFG
vPcLg7WngMFOJo57j9kNFnuwkDd7C4M1ZxODzU8sY7DLAxIblHvoVINSGKw5
fQx2G1rGYJ/ZwVrzz8NgzWllsMnRDMZgGA2DjQtiMAbDaBZeAAYLZyuJMRgm
sInBZs6NwebAYJgAg40LYjAGw2gYbFxQZ4OtKnlcEPaEwcYFMRiDYTQMNi6I
wRgMo2GwcUEMxmAYDYONC2IwBsNoGGxcEIMxGEbDYOOCGIzBMBoGGxfEYAyG
0TDYuCAGYzCMhsHGBTEYg2E0DDYuiMEYDKNhsHFB8w122UZiDIY5MNi4IAZj
MIyGwcYFMRiDYTQMNi6IwRgMo2GwcUEMxmD78/X/s/o4h1l7AZbMjcEqHYPB
TvLFWklVxmDjghiMwfbntcFuf3B/GhpsWm5bg808A4OdhMHOwGDhMBgO8ebv
HBnsQRgsHAbDc/hzsCdgsHAYDK1gMAZLfQYGaw6DMVjqMzBYcxiMwVKfgcGa
w2DFDHbZQGIMhmkwGIOlPgCDNYfBGCz1ARisOQzGYKkPwGDNYTAGS30ABmsO
gzFY6gMwWHMYjMFSH4DBmsNgDJb6AAzWHAZjsNQHYLDmLL8ADBYOg6EPyy/A
krkxWJkDLL/AWMvyC8Bg4aw12OT05RcYa1l+ARgsHAZDH5ZfAAYLh8HQh+UX
gMFGsFBiDIaZ3K5sMlcXfn7inNDJLHyDa7tdvSfMZvIFu2Xyhb/VF4OViX5h
sH5MvmC3MNgI2hoMUaw206Os7onBhsBgOMlqMz3K2pbmy4TBCkcjkNVmOsaq
lhhsBAvfYPlu+7DaScdYdfir2z4/cUTokvv2mlUaoa9KhO9iKKsOv9xgIyKW
X4kJln4kd0Ji9t1tReomN9lajcTdDFY4l8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60xWKVcBgskdZN9tsZg
lXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd3k1d3zeBI9eXe3FXkNtvwG
ejwnn4y72w0G83hWPRl3txsM5vGsejLubjfyGuxCYp7MT97dbUVqg606/NVV
rJH48g4jst5kfqurcheWXI/UTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60x
WKVcBgskdZN9tsZglXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60x
WKVcBgskdZN9tsZglXIZLJDUTfbZGoNVymWwQFI32WdrDFYpl8ECSd1kn60x
WKVcBgskdZN9tsZglXIZLJDUTfbZGoNVymWwQFI32Wpro0MZjMEykrrJVltj
sDK5DBZI6iZbbY3BykQzWCCpm2y1NQYrE81ggaRustXWGKxMNIMFkrrJVltj
sDLRDBZI6iZbbY3BykQzWCCpm2y1NQYrE81ggaRustXWGKxMNIMFkrrJVltj
sDLRDBZI6iZbbY3BykQzWCCpm2y1NQYrE81ggaRustXWGKxMNIMFkrrJVltj
sDLRDBZI6iZbbY3BykQzWCCpm2y1NQYrE81ggaRustXWGKxMNIMFkrrJVltj
sDLRDBZI6iZbbY3BykQzWCCpm2y1NQYrE81ggaRu8suxr26gJ/CZ9qvJYHiC
1E3Slyf1k3R3W8FgHs/CJ+PutoLBPJ6FT8bdbUUBg5GYJ++TcXdbUcNgkw9/
dQlrhL68w/KNF36S7m4rGOwJWhksPOg9lrS6JHphyfVI3WSrrTFYmWgGCyR1
k622xmBlohkskNRNttoag5WJZrBAUjfZamsMViaawQJJ3WSrrTFYmWgGCyR1
k622xmBlohkskNRNttoag5WJZrBAUjfZamsMViaawQJJ3WSrrTFYmWgGCyR1
k622xmBlohkskNRNttoag5WJZrBAUjfZamsMViaawQJJ3WSrrTFYmWgGCyR1
k622xmBlohkskNRNttoag5WJZrBAUjfZamsMViaawQJJ3WSrrTFYmWgGCyR1
k622xmBlohkskNRNttoag5WJZrBAUjfZamsMViaawQJJ3WSrrTFYmWgGCyR1
k622xmBlohkskNRNttoag5WJZrBAUjfZamsMViaawQJJ3WSrrTFYmWgGCyR1
k622xmBlohkskNRNttoag5WJZrBAUjfZamsMViaawQJJ3WSrrTFYmWgGCyR1
k622xmBlohkskNRNvje60Vxd+MKhM1n4Bpd3u3pJiUnd5Pyb9hkGG8HaN1i4
2FasdtIxVrW0amvlV1b+DWI0q510jIVF2RqwIauddIzVbQHYi9VOAlqweuhl
Wf0LCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAD4mf8BmJrNZA==
     "], {{0, 217.5}, {304.5, 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{96., 96.},
     SmoothingQuality->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{304.5, 217.5},
   PlotRange->{{0, 304.5}, {0, 217.5}}]], "Input",ExpressionUUID->
  "c6dab034-cd80-4418-ba45-7990af24fe5a"],
 "2D.\n3D: ",
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJztnQlcTtn/xydrZYk2tGkTUlLZl7QviCwVI2tSGmsjlBFCVENmQvZ+RJai
mEHJkjUZW4xSEZO1heyRqf6fec5rnn+vlme9z9ac9+s188rz3Oec7z3ne77L
ved+r970eWNmNvnuu+9+lMf/xkxbbBMQMC1obDv8w33uj7N85/rMcJm70MfX
J6D/9Kb48Cz++xP//fN3NYUiIaooFAkhad2nUCgUCoVCoVAoFAqFQqFQKBQK
hUKhUCgUCoVCoVAoFAqFQqFQKBQKhSK9FBYW9u7de9SoUcXFxZKWhfJfYf/+
/WvXrrWyspKXlx85cuTo0aNjYmIkLRSlkVNVVbVv37727dvD4qWlpaWnp796
9Qp/6Onp2dnZnT9/nj6HRWEceNjTp08rKirq6ureunWr1rfPnj2zt7dXV1fv
0qVLXl6eRCSkNEoQ0Tk4OHz33XcrVqyArWvosKSkpNmzZ/fr12/RokXiFI/S
+KisrHz9+nVwcPDAgQMnT55848aNv//+m/NPPn78iMNsbW2HDh26efPmN2/e
iEdUSiMjISEBtg6hnQCZbFZWVrdu3eCjr1y5IgrZKI2Vu3fv+vj46OjobNu2
LScnR7BGMjMzo6KikIagqaKiImYlpDQyysvLHz58OGrUKCiMvr7+2bNnhWwQ
Pjo2NhZNoUF/f380ztVrU/6bLF26FE7W1dX1l19+YbxlKysrNP6///2P2ZYp
ss7JkyfHjRuHCO3w4cMi8o+PHj0aMGBAu3bt0NHt27dF0QVFhigtLf3jjz9O
nDgxZMgQS0vLV69eibQ7ZMHXr19HR506dbp27Rq6xici7ZEinezYscPDwwN+
MCQkRMxd79y5c/z48eh6wYIFYu6aIlmqqqo2b97cqlUrW1vbtLQ0pBjil+H1
69cTJkxo1qyZnZ1dcnIyvRnX6EGmefr06VWrVhkZGSHukrQ4/3hhe3t7LS2t
3bt3Q7AXL15IWiKKSHj8+PGgQYOaNm26bt06xF2SFuf/SU1NXbJkCVzwiBEj
Pnz4IGlxKEwCr+rv729sbDxnzpy6OwGkgS9fvty4cWPMmDFmZmZr1qz5+vWr
pCWiMMCxY8emTp0Kq9KlS5d79+5JWhxOXL16tU2bNhAVZvDcuXOSFociOJhK
Hx8fAwODbSwWLVpkbm7u5+cnabnqobS0FKLq6+uvX7+eSKupqYlPHj16JGnR
KPxRUlIydOhQPT29rVu3Pn36lHwIz1tQUDBq1ChdXd3w8HC4OckKSUCAh0iA
3HSDeOybbklJSVg1+Pz7779/+/atZIWk8MK3b99iYmJsbGzc3d137dpV94CK
igpfX19TU9Nly5adOXNG/BLW5MiRIzNnzhw8eDCcbL0HhIaGwgV7enrGxcWJ
WTYKXxw6dMjNzQ2ThQCPs624ffu2NouxY8fCSIpNQjZ3795F1+3bt+/Xr9/D
hw8bOgwrJSEhwcnJSUFBAcdfuHBBnEJSeCEvL09NTQ0e6tKlS2VlZbz403fv
3iUmJvbu3btXr17Xr18X2z7PFy9e2NnZderUCV1nZGTwclvt06dPubm5OF5L
SwvS/vXXX2KQk8KV4uLisLCwrl27Lly4MC0tTYAW8EOYSi8vLzFsMomKinJ2
dvbw8Ni+fbsAPz9w4MD06dMHDRqEU0Z0wbh4FF6oqqqqZOHi4iInJ7d69WqB
t8bB8iDww4QqKSkhRESbjN/hQoO//fYbzF3z5s2heMhqBW4KucmsWbNwyshQ
RCEqhSvJyckwVj169JgxYwZTbWZnZzs4OJBHIB8/fsxUs/fv34eH1dTUPH/+
PFNtAiw6xBgwpNJ5tbxR8ueffwYGBiorK1taWuJvxtuPj4+fNm2atbX1ihUr
hGwKcRpENTMzw/9PnTrFiHg1uXjxoo6OjoGBAaJcxhsXEZJ7g6XgIOODq3r2
7BlCOyheUlISTJOI+kKO7OPjo6qqGhAQgE7hzfltgUjr7u4OUVeuXFleXi4K
OcGDBw+io6MNDQ3t7e1LWRBHLLVIWvcFAVYITtbW1jY8PFw8PSIRRmwGv7Zp
06YbN27w/kP41qVLl5qamk6dOlV04tVk9+7dELVv374Yov3794un0/8Cp0+f
RlAHc4fcUNRbi+uSnp4O29W9e3de1A+mGKJqaGh069ZN/Bvjc3Nz+/Xr165d
O8hw584dMffeyICmQfFgeRDSSPCiVmFh4caNGyGGk5NTfn4+ori6x8BN4ysT
ExOImpiYKKmdeMXFxefOnSM345DjvH79WiJiyDTv37+PiYlBvjl58uTDhw9L
Wpx/2Lp1q6+vb58+febPn//777/X/Grfvn3ff/89Iq41a9ZISrxaIE4YOXLk
8OHDBbuQ+J8Fw+Xi4oLQZe7cuRLZ0M6B7OzsHj16dOjQYezYsY8ePbp8+TL+
0NfXT0hIYG9akBJKSkqQ7DRp0iQsLEzSssgAcBNRUVEtWrSwsbEpKyuTzi2U
Hz58SEtLg/q1bt1aUVGxc+fOCLQkLVT9YOUWFRUhWFVSUkpKSpK0OFLKkydP
sDy1tLS6dOlibm4eEBCAf4ri8p3wIJGEbEOGDPmOhTTXfrx48SJERdxiZ2en
q6sbxgL5u6TlkhaqqqoWLVpkYWEhJycXHR2dlZWVk5MTHx9PbltIVbRcWVnJ
rv14pgYI7G1tbaWq9iMkwUhCMDgRSIhMLSMjY8mSJRjk8ePH05txAEmZj48P
DN2PP/5Y66tTp045ODgYGRmlpqZKQ03jO3fucKj9CFGlp/YjnAi52AKp7t69
W+tbV1dXUkvw2rVrEhFPGoANkZeXh/PisDM8ODgYA4V4XoLbNqD5gYGB0KuV
K1dy2EGXnJw8Z86cvn374mBxileLVatWwQhj0GJjY+s9oLS0NDw8HEFgp06d
UlJSxCudhPn48eOIESP69++/a9eumzdvck4PP3/+fJMFsg+YR3HeuIRjwjQF
BQUNHDhwypQpkIGX2o84DMHV0KFDN23aJM6AAanZgQMHMESIB8iIQX4Oxz98
+DAuLs7Y2BiLxdfXF+MsNlElAvLWgwcP2tvbu7i48BufIwX28PDAUkUL4vFr
hw8fFrj2IzydOGs/QtM0NTWRcWOI+FX45cuXw/VMmjSpcSfCy5Ytw2wK8/DL
oUOH0MKAAQNE6tegOTNmzFBWVu7Tp48wtR91dHQQ7aMp0dV+/PLlC9pHUob4
TeA9WshEYBAQ/zS+C9HPnz/HFFhaWiLGmDp1qjA5PvxIQUFBQECAvr4+wn4Y
TwbvtZWXl+fn548cOZLcxUtLSxNSZ5CDIOhCUxDV39///fv3TIlazXKaP/30
E+IBtL9+/Xohr4UiuoD69WQBWy0NyZ2Q4BSgHlA5DQ0NZjewvXnzBlEK4n94
4cuXLzPSJrv246+//spIg2ygJFZWVt7e3gkJCYw0eOLEiaZNmyIe4PCckWDs
2bOnVatWiFexxpltWczAhmA2MfIiesAKfg1L3tDQEImwMAv/5MmTaAERGnRD
REueXfsRHQmzxeXJkydooWPHjvHx8YiBGZSQze+//45lAmkXL14sivZFSlZW
FiJYCwsLhHbIvyoqKkTXF3JP5MuwAIMHD75+/Tpffg2OBj8htR/RgqgrcpPa
j+iI1H7E37xX/sHKus7CyMgILaSkpIj04jDCyHnz5vXr1w+JMIJAqb1pWJPs
7OywsDDES0uWLIEGirNrWNdBgwbNnDmTx30v0ARS+xHLRMSi1QaLZcKECeh6
/vz5PP4kPDycxANRUVEila0W586dQ8aE2AbT+vLlS3F2zTtVrK3mJiYmcnJy
TEU1/AK/BgFUVVUTExM5XN2CqJs2bYKdtLOzO3PmjKRqP8IpNGvWzNbWNikp
qSEjhs8vXryIYxCDOTk5SWT2b968uXbtWkwrkhFpuxkHYVJTU93d3TGSq1at
krQ4/5QA0tbWVlZWhlRIsWt9C7cVGhoKzwWBJSJeTWB7HRwctLS0YAlrbZyA
ckL+5ORkNTU1HCMNz4NPnz6d2GrpeTRp69atEMnFxYXxVwMIDKwZnJSnpyek
ioyMJB8+fvw4MDCwc+fO+EoKaz+amppCPHYECKuIUf3hhx+OHDkiWfHYfPr0
CUPXp08fZEwSlwoWxtzcXENDA2ZZCoMBpBJQvw4dOpizQNgMY7hnzx5Jy1UP
iO1Xr14N8UaPHo21DGltbGwwqlJYiB6J9vHjx7GEIeSzZ88kIsPly5cVFBSw
NiVezYkzmzdvJhvtEDDX3dQhVbBrP4LTp09LWhxObNmyhdxwlEjvY8eOhfJj
nQ4bNmz9+vUSkYEzmMoZM2YYGBhsZ7F48WJprv0IUUntRyKtpqYmPpHO2o8Y
yUGDBvn6+g4ZMkQiAkD3oPZlZWXkgQVdXV3p2ZBTXFxcb+1HZBlQRQ8Pj/z8
fOmp/QhhMJUQDBkHe6sMsgx27UcMsmSFJBQWFmJRYKKhcgUFBYgH7OzsJCIJ
0T3yd3Z2NlaBjo5OTEyMiC628wi79iMUbPfu3XUPqKioIA8iScMzZaT2I4SZ
NWtWvQewaz/u3btXzLLVAk4E+TiWAyaaXbFQGnSPkJSUhIGysLBoaCRFzcGD
B3mp/fjixYuEhARyJ04aaj9CmIZux0hD7ceQkBB0jWi5devWGRkZNb+SHt2r
rKyEd4CoZmZmSkpKkZGRYnvYJzc3Fw4LHmrgwIE81n7EdEuq9qOtrW3Hjh15
r/34+fPnvLw8UvsxNTVVbNf6kGjPnz+/WbNm6Bretu5ylh7dY/P69WtnZ2fY
Hw0NDVHX6mfXfsS8SH/txw0bNghZ+1FRURHBIUJExmWrBRZmixYtMDITJ05s
6Bgp1L1q1ta1M2fOtG3bFrkwljnCMGbvxVT9W/sRU0lqP/JVrqcmNWs/7ty5
kzTLoKjVLI8AVq5cidlE8CZM7ceLFy8ipIGtnjdvnojKVD558gRTpqam1r17
d4wMB48gnbrHBjGYg4MDls+0adMYrNVPYksTExMZqv2Ixhl8NhYZk76+PrO1
HxEPODo6wrRCVF52RUq57hF8fHygKpMmTRI+XxN17ce4uDiIam1tXfdesABk
ZWX17NkT+iyK2o+XLl1isPbj+vXrhw8fPm7cuB07dvD4E5nQPQT2CFz79++P
qCw2NhZOh9+X1tWt/QjXwL/U3IHTgagzZ87s0aPHggULSO1Hfhsh0iKug7Sh
oaGie5fWgwcPNm3aVKv2I18twBmdPHnS3NycFJnhKx6QCd1jg8wOM4Js3cbG
hq98jdR+xMlGRETw26lgwLqS2o/R0dGC1X7Ez5FciE5CNoLVfiwpKUFE1K1b
NyTd+LkAa1m2dI+AU4b/hfoh/OZ6cGpqqgRrP164cIH32o/VrO33slL7ETMI
XUWaL3A8IIu6V83ywt7e3vLy8jj3/Pz8evO1ly9fQvEQLCFWLywsFEJYoeCl
9mM1S1qEoBiTxMRESe3qKS4uhtVVVVVVV1dv6DGir1+/RkZG6urqKigohISE
CLN1VkZ1jxAQEODr64sgEEFLTEwM26zVrP2IA6Th3aOk9iP82vz583/77bea
XyFkgrSLFi2Shvt04OzZsxAVYwupal5IhGHEJ8uXL0coiwPWrVsnZEcyrXuE
ixcvNmnSBPZ/2LBh1TVqP86bN0/aaj/m5ORg4mBVatZ+nDJlijTXfiQr4s2b
N5gvcsGfqcsyjUD3qlnlRBCWt2rVSklJSSZqPyI+RySAaZWV2o+IWjFfhw4d
YvAR9cahewSoH9k5uWDBglo1jaWHurUft2zZImmhGmTv3r2IWyAnFgvjjTcm
3Xv37h1Gac6cOdra2nANtra20lb7MS4ujtRpqVn7UV9fH6KeO3eO8ZtxAgNJ
srKyIBXCA0g4ZswYqnucIbqHvKOaVfsRw4V0TEpqP96+fVtRURHZbt2LJzVr
P0qD/61b+xGRM9U9ztTUPXD8+HEklbT2I1+EhoaS2o81t+VQ3eNKLd2r/rf2
o7Ozs5WVlZhrP1azHh8LCgoyMTHht/YjRMVZiHO9IDWLj49Hv2pqat7e3rVq
P1Ld40pd3WNz//59Y2NjpMAHDx4Uj19LSUmBHUNoh4nj97ceHh7dunVDFsxU
jSzOkNqPGDq42nojZKp7XOGge+CPP/7AV6T248KFC5ntuiY1az8+ePBAsEbY
tR/T09OZFa8mpPYjVqWSktL27dsbqshKdY8rnHWv+t+3DBiwQBqyZcsWBv0a
47Ufnz9/jqALtgix4qxZs5it/YhoZOnSpRgEiLphwwbO9xyp7nGFq+6xefPm
jbW1NQ5et24dU36N1LSXldqPAQEBGH9EBbwcT3WPK7zrXjWrvgqmsl27doaG
hnDHwvQrhtqPBQUFCBXgGYWs/VjNSv+hSN27d+f9cVSqe1zhS/cId+7cgRhD
hw4VoPZjNUslEhMTEZiJp/Yj1gip/ZiRkcHXvmjEdaT2IxbIkCFDkAfxtfmW
6h5XBNA9NlOmTMFv+ar9GBYWZmFh8cMPPxw7dkyAHgWG1H50cHD4+eefefwJ
qf0o8CPtVPe4IozulZWVnTlzxtTUVEVFBa6Tc+1HfOvl5SUnJxcYGCjB2o/N
mzcPCQnh8LgZu/ajoqKis7MzTlCw/RVU97gijO4R4JtgT+BDSe3HukW6MjMz
SaEJFxcX4YRlANheMzMzCANLWHePYl5eHnkcD34WiipMR1T3uCK87hFgH8gL
Cxqq/Qik4R5xNethHwijqqpaq/bj4sWL+/fv36JFC3x78+ZNIXuhuscVpnSv
mrUzHFPm6empoKCwcuXKWbNmSXPtR2SsCOQgnpubW2lpqY+PD9xxQEAAL49d
8ALVPa4wqHts/Pz8zM3Nyd0QBpsVETCAENXKymrFihUMNkt1jyui0D3wyy+/
IJkl1RR9fX2ZbZwRSO1HEBQUhBE4efIks+1T3eOK6HTv2LFjT548QZYBFyzN
tR9v3LhBdY8rMqd75O+ff/5Zemo/JiYmkmoh/v7+5JPbt29T3eOKjOpeNavi
zfDhw1u2bCkNtR9xvnC17NsxVPd4QXZ1r5q1CaSsrOzIkSMqKirdu3fPzMwU
c+3HVq1aIf68du1arUqVVPd4QaZ1j01CQgKpeDxx4kTx1H50cnJCd4sXL663
KibVPV4Qhe7BCIhZ96pZNxfmzJnTpEkTUvtRgKpTXKmqqkKzpPYjOlq3bl1D
N9Go7vECs7qXmpqakpLStWtX8iInZt+nw1n32GRnZyPZhG5AEgZrP/755597
9uzBefXs2ZNr7UfGdQ86j9Nxc3NDbJnCgsFnXmRa9549e7aQhZycHMYc8X9E
RMSAAQO8vb0PHTrEiJzVPOteNauS/9q1axms/Xjnzh1S+xHnlZOTw/V4xnUP
5042xP70009kJ4yysjIZc+HLPsiW7iGuLmGxd+/eXr16wdDJy8sj4Ef4fevW
LXILqbCwEPOlo6ODA/Lz84W3gbzrXjXLP27duhUikdqPEFUAL4xpxQ89PDyM
jIxCQ0N5r4/KlO7BwJ4/fx4DqKGhMWzYsKKiooqKilssIBLOrnnz5hjkyMjI
kn8R4OkDmdC9V69eHWBBnrdVVFT0/JeGquAiFMe3sIQYOvxQmDCML91js2jR
ov79+0Pa6OhovvZFQ3Kyk8HBwYHf2o/C697bt28xXBYWFqqqqhhABBL1HgY7
TMbf3d2d2MPw8HD8kK+3aEm57mEY4UDJ5Vzy5pcdO3bgHHnsJS4ujgwOXKHA
ogqme+Dhw4eQlvfaj4gScbKk9iN+KMBWGSF1D52Sio6zZ88+fvw4Lz/Bot7B
gjxlOWTIEG8WvGyekULdwxTk5eVNnjy5c+fOCHUwF4aGhmFhYfhcgH3pWMgT
JkzQ19dHazyOZy0E1j0CgkDIr6en5+joiPOqt/YjhMRXXbp0Ic+PCFz7UWDd
g8fcvHlzq1atdHV1Ecs1VKCSA4i9MUFI9CA/bKaamhoGPCgoCOfV0LtKpUf3
EhIStrCA5DAUfv/CyBvWcnNz0ZSWlhbpgq9LwULqHgFB4JgxY0hVwFq1H2Gc
sTrIexyOHj0qTC8C6B4UBgOCpY1ADkPEyIv/ECuypw+mw9jYmAx7rTerSlz3
li9fPoYFljzGzdfXNzExUeA3rXAGk0J8NwIV3n/FiO5Vsza6Ex1TV1dPSkoi
H2JGEL7a29vjrIXPHPnVPeRuAwYMwE+ioqJE9DL09PR0nBoyZfSCtY+Jhm0k
X0lQ95o2bdq2bVv8vw8LnDtcj0gLNiIJRRerV69GBoeu16xZw0t3TOleNev5
cWggThaurS0L+NmRI0d+/vyZkfZ5173379/7+/tjvUOY2NhYUVwSrwlOECOP
FYfuzMzMyLlL6t3N+/btQxJKrJD4e8c4DB8+HF0vWbKE6yu2GdQ9NlCPDh06
IKfIzMxksFledA89YtH5+PggL1i2bBmDvfPIypUrybxLSveqWfX/z549i9TV
xsZm//79jL/bizMvXrxA7zt37tTW1oYAWJgNPZsmCt0D5ubmHh4ezLbJWfdw
gvn5+cgF5OTkUlJSCgoKmO2dM+TOYEREhLy8PEw9Bl9EXp4vkZAAwgdFR0cz
9XwBXxw5cgQCYDq8vLzqzUEage7B10PZsMRat26Nk7127Rqz/fLCqVOnIBvy
jqlTp4q/dw4gItXU1ESqhQRfmPckCszs2bMxMsgFdu3aVeurRqB77DtiOBdm
e+SFnJwcTKuamhoivaysLPELwBVIiGxLRUXFxMQkODi4pKREnPWHP3z4cOvW
LSsrKywBZCJItNkbMmVX98rKyiA5TgexJZYVTrCiooLZHjmAvjCJU6ZMQViL
aT18+LCYvbwATJs2jSxSeEPx9w6tQ+6J3gcPHkzGSkZ1DxYGoR2WkqenZ0NX
d0XKunXrIAwcvTQ8X8Aj796927Fjh6WlJRaLt7e32N5cz+bq1auRkZHkYUN4
K1nUvZkzZ8LctWzZkmsWLwqQR2DimjdvPmzYMEb284iZoqIijB5WLtIQNzc3
Mb+t4Nu3b48fP541a5aBgYGysrJs6Z66ujrGbfXq1SJ6T2tDIErJy8vr3bu3
np4eBLh//77YHiUQEWQL2ahRo3bu3Cn+3l+8eOHn5wf3wXikJArdCw0N7dmz
JwQW9bXiunz+/JkES15eXvHx8WLuXXQkJiaOHj26WbNmYnv7bS1cXV0Zf/WA
KHRPVVU1ICCA2TZ5ITY2llyr9/f3F2AfgpRTXl6OgHngwIEw5kePHhVzxoQJ
RfSCgWWw6DGzuldcXAzXMG7cOKZuz/ECZiQzMzM6OhqRib29vahviUqcpKSk
9u3bIxNB9iTOJTZ9+nSsaw4vZ+EXZnUPAQnEE2d1rKdPn0Lf0Km+vr6YX1wi
QZCHLly4kFwG2bx5s3huxmFRT506tW/fvkw1yKDuISjt3r07UnLxmJ3Kysrg
4GALCws5ObmoqCiJ3I2SLLB7ZFM6Ejqx3Rm0sbERvpwdgUHd69KlC8wyI01x
JT09Hek/ht3Ozk4MjyRLLa9evUL2YWRkpK2tDUv4119/ibrHvXv36unpMeJ5
mdK9I0eOQKRTp04J3xRnbty4gUGGh41g0bhDOx7Jz8/fvXu3goKCmZlZSUmJ
SIPtL1++tGnTRlNTs6FX8PAOI7qXlpaG3PbEiRNCtsOZjx8/5ubmwrqqqKgw
GPE2Gg4cOEA2pU+bNo3rM9TCAJ8LSyv8TXnhdQ+WZ8GCBUi7EO8JKUxD/P33
3xhYZ2dneXl55LMi6qURgLnYsWOHtbX1uHHjvL29RbdTKCMjw8DAYPv27cI0
IrzuhYSEoBFGnmepl+TkZKRXpqamGNV9+/aJqJfGRGlpaWZmprq6OpwRchAR
XXZwdHR0dXUVxsAKqXvh4eHKysoieqHM8+fP4WGVlJR0dXURVIuii0bMlStX
/Pz84ClsbW23bNnC+D0maB0SvUmTJvH1gp6aCKN7T58+dXJyEvLNBfXy+vVr
DJeJiUnHjh0xgMKHtf9ZyEtLgZubG48vDOIduCG0DOcu2M+F0T0rKyt0zeyz
HmDjxo3kcjFITU1ltvH/GjB3b1n06NGjZcuWsbGxDL64GeHl0qVLDQ0NBas6
JbDuPXjwAN4wJiaGwRew3r17d9WqVc2bNx85ciQZMTE/PtOIKSgoCAoKIuUm
hHxrZC0CAwPZD5zyhWC6R6ocCJnm1AImTk1NDX4WQyTSSwT/ZS5dutSkSROo
n7u7O0wiI0s7JydHS0vrwoUL/LYmgO6hi7Vr18rJyTESvlZWVn769AnxsI6O
zu7du0WXL1NqMnHiRIQ0MFmMvLg5OTkZdqPeIrQcEED3tm3bhsSTEbt9+vRp
pCp9+/YNCQkRvjUK77x//z4iIgKzr6KiAs0RvsFRo0b169ePr58IoHvKysrC
byOEiV64cCHsv6Ojo0Se46CAJ0+eHD16FJakV69ez58/F2ZH1qNHj8iNTt63
N/Ole+Xl5fPmzRswYIDA2oIWSkpKrl+/jqC3TZs2yJEFrnZFYYoTJ054enrC
DowdO1aY6zAZGRnw4+fPn+fxeL50D8kFFE/gnatYVr6+vhAPCTJOlqmtOBRG
QLDt6uratGlTb2/vtLQ0AVooKiqC5x0xYgSPx/Oue8XFxYMHDz548KAAUlWz
rkOOHz+evAUmMTFRsEYoIqWsrAzK06lTp/bt2yMUF8AloQVEfZMnT+blYN51
b+DAgTBWAhSOLiwsjI2NhYdFJuvv7y/wLRiKeMjKyvLz84P6IQfcsmULv/MV
GRlpbGx8+/ZtrkfyqHvp6el6enpxcXF8iYGwEMLrssDp0NBOhoDdmzNnDvyU
j48PXz+srKxcunSpqakp16eZeNG9K1euQHkQD/AlA7C2tobwYWFhV69e5fe3
FInz9evX4OBgUqhw48aNvF/OhcJ06NCBa0Fyrrr37ds3KE9UVBTvXSOJCAwM
hMCIWt++fcvgTTeK+EEGERQUZGhouGLFijVr1vC4LR+5M+wVu7BtvXDVvU2b
NvFeHBJeHuIpKioiVIDA4n82nCIiEARGR0fLycn16dMH08pLgSx4bXV1dQ67
2Tnr3rZt2zp27Hjv3j2uHUEYLy+vrl27QryjR4/SXU+NEgT8ZIvRzJkzud5B
Q87bs2fP+fPnN/T8CAfdKy0txVdcS2FXVFSkpKQMHz5cXl7e0dGR35t6FNkC
ERSpOgLvtn//fs4Hx8fH48iGCvJw0L20tDQXFxeuyWlERATZa7dq1SpehKfI
Oojhb926ZWlpqa2t3atXr+zs7Iauw7x582bixIlOTk71HtCQ7pGX0XDYqY4D
4NDRtYGBAXnHWXl5ucCnQ5FFLl265OnpqaCgAH/39OnThg6bPHkyPHVhYWGt
z+vVvfv37/fo0YODHYOqm5qaIpJE1/n5+cLIT5F1NmzYAK8H7Vq9enW9B+Tm
5uKAujez6tU98grUhvqaO3cukh3EkKJ+IJciEyDgf/z4MYwbPGDnzp0TEhJq
bTXBAb/++quurm6tdzLW1b2TJ0/q6enVrfSL9jdu3IjGDQ0Ng4ODxVlpiiIT
FBQU+Pn5derUqd57amPGjIHJqvlJXd0j5d1qfvLw4cOaL5ijN2QpHDh79iyc
JkKyKVOm1Pw8IyNDQ0Oj5hPWtXQvMjKyf//+NX8CTevbty9aU1NTo7ueCFUU
jiAPDQ8Pt7CwaNu27YoVK7KyssjnmZmZ+vr66enp5J9IVN3d3fEHstRly5Z1
69bt5cuX7CN9fHzIy87279///v17iZyIFCJp3ZcNPn78GBQU1LNnTxUVFXaR
qDVr1rCf52XbPaSrMG7sbatQNvzT2to6NDRUIpJTGgfILzp27KilpWVjY/Pu
3TtkDTB35JkLtu65ubm5uroWFRXhYBwGXbW0tBRziXhKY+X48ePq6upGRkYp
KSmwhHDHSEyI7t27dw/amMICeYqjoyMN7SjMkpycHBER4ezsTO6CWVlZQRu7
du2KrIR84uXltXfvXkmLSWm0IJuws7NDDvJdDYyNjW/duiXrr0GhyAR37tzx
9PREGqutrY0/RFTHjEJpiKNHj549e1bSUlAoFAqFQqFQKBQKhUKhUCgUCoVC
oVAoFAqFQqFQKBQKhUKhUChSyv8BRmF1/g==
     "], {{0, 141.75}, {159., 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{96., 96.},
     SmoothingQuality->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{159., 141.75},
   PlotRange->{{0, 159.}, {0, 141.75}}]], "Input",ExpressionUUID->
  "a475fd5b-4839-45b4-8772-81745f271528"],
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJztnQdYFcfaxwVF4VJEmoAiStEA0gTUxFgokmhEoihYQaTmRokYVOKNigUM
hquxgYiJhkRBj9EoIiAhGrsg0iwoEbBFFDWKJaio3/+eufd8hHI8ZffsgTO/
50kewN2Zd2f/O/O+uzPv9Jn52fhQ5Q4dOnyuiv+ND1zgOndu4Bc+2vhlYsTn
n4RFhASPiogKCQuZO3hmR/yxBP8V4b///PyGQqFQKBQKhUKhUCgUCoVCoVAo
FAqFQqFQKBQKhdIGeU2hyAquxU6hUCgUCoVCoVAoFAqFQqFQKBQKhUKhUCgU
CoVCoVAoFApF7njy5Mnv/+PRo0dcm0NptzQ0NMyaNavD/5g+fXpaWhrXRlHa
G+Xl5RMmTBg/fryDg8NHH32kpaW1a9euESNGaGho4O+nT5/m2kBKe6Cmpqag
oODbb781MjJycnLy9/efMmWKvr7+G/6QOmrUqF69eqmrqx85cuTmzZtcG0tp
w9TW1np5eWHENDY2zsnJwV8yMzPxKxEb4eTJkwsWLOjcuTM6uq+++oo7Yylt
ldzcXHd398GDB3t7e+Pn/Px88vfmYiMcPnw4MDAQ/4Sz0tPT6UolioicOHEC
nZW1tbWHh8f69esb/xMRW3FxcYsnfv75546OjjggMTGxpKREJsZS2ioXL16c
P3++rq4uAoHS0tIm//ry5UsfHx8ECHfu3GmthMrKSgymcPDeeecdFHX//n2W
Taa0MV68eAFVwPmHQhYuXHj27Flopvlhz58/R6/173//+60FQrQJCQlw5Gxs
bBYtWoQTWbCa0iZZsWIFVKSsrLxy5Uohh4kuNkJSUhLCVZwSGRl56NAhJiyl
tFVu3boVwqdjx45jxozZsmWL8OMxPoolNvDw4cPk5OQBAwbo6emhIvR40plM
aXvU1dX9/vvvtra2Xbt2NTMzu3Tp0oMHD9561rBhw4YPHw79iFtdTU3NwYMH
dXR0DA0N4fWJUhelffDkyZMZM2agj9LW1k5PTxfxLDhyFhYWGBYlrhd6Cw0N
Rb3jxo377rvvJC6H0ibIz8+fMGECwkn0Ubt27crOzhb93GXLlkEn0ojtDT8n
Fer19vZWUVGBJdSRa68UFRWpq6tDMFAaOjdxT4fYOnXq9PjxY+ktefbs2bVr
1zB8q6mp7du3r6qqSvoyKXIC7izCzF69emEcXLBgATwocUu4efOmh4cHuiMG
rSopKYExcBpdXFxgHhTIYOEUGYMxi8fjubu7Ixj09/fPzc1t7c3/Wzl58iS6
RGbFRjh+/HhkZCTpbxG30qR8bZHS0lL4/7iJDg4OuJtSlkbENmjQIEZsaxE8
FGSanOA7LEX++fPPP+fPn29tbd29e/evvvrq999/l75MIrYjR45IX1Rr3L59
G9ZaWlpiuIf9169fZ68uipRg9Ll//35MTIydnV23bt3i4+MvXLjAVOH29vZB
QUF1dXVMFdgaV65cSUlJgf02NjYRERG4ooaGBrYrpYhLRkYGGYamTp3KeOEI
Y7/88kvGixWCs7MzuRzIT5b1UoRTXl4eEhJiYGCA/gc+NoZRxquQvdj27NmD
a0HU4Ovri6s7c+aMLGunNAe6mjhxYp8+fczNzQ8cOCDBOw1RCA4OVlNTE+uT
KFPU1tbCXcTV4RoLCwsrKiqePn0qezMo27Zt8/HxwUCzatUqVisaO3bs4MGD
Wa3irWzevLlLly642NmzZ7969YpbYxSKX375BTLr3LnzmDFjeDweq42fmZlp
ZGTEudjAvn37pk+fDr2NHz9+9+7dXJvTznnw4EF+fj7CNBMTE/jPlZWVMnjr
vm7dOtxff39/tisShb/++is8PBzXjlEVjwBaQ8icYYrEoJ0RZuK+a2lpoTeT
Wb1EbIx8EmWQ7OxsiA2GYYi/d+8e1+a0HzBKpqSkDB8+XElJKSIi4tixYzKr
urq6um/fvnIotjf8GSwxMTFoEwzx8FrRSvQ7lzRUVVXl5OSgPS0sLLy9vWVv
wMWLF8nLLjkUm4AZM2ZYW1vDyJ07d5aXl3NtTlsFDyy517GxsZwYQMQGh03O
V6yUlJTY29vDVLhzly5dkrgczrYD5A64Z3PmzHFxcbG1tU1OTi4sLLx9+zYn
lpw+fbpLly4ISDmpXSwQLiFq0NHReeedd2pqahA6SVAIg/qXfwoKCtLT00NC
QuCHzJ8/n2tz3vTo0WPWrFlcWyEGGEYdHBzQxS1btoxrW+QaKA1PJRrq/fff
Z2SqhvS0LbFFRkYOGjSIOB5UbC3y9OnTiooKT09PfX19PT09BJu1tbVcG/Vf
2oTYrl27hgacOXOmqqqqubl5Gh8qtuZkZGR89tln5K14WFjYb7/9xrVF/8+v
v/7au3dvOU/3d/ToUQMDAzSgm5vb0qVLyR+PHDlCxdaEPXv2kIaaMmWKHObE
CAgIwLDOtRXCQPxiZmaGBnR1dUX/Jvg7FZuAO3fu5OfnY4RCv4FQ/cGDBwg/
uTbqb5SVla1cuVJFRcXU1BSmytua4kePHsEquGdoQzRgaWlpk6kgVGyExMTE
jz/+GA/jnDlzsrKyuDanKXB+4uLi0N9aW1tHR0cHBweT3Lnff/8916b9F0Tr
xCp/f//U1NQWj6Fie/36dUJCApxYNNSiRYtevHjBtUVNqa+vt7Ozg3k6Ojrn
z59/w187jwBBSUlJS0vr22+/5XZuD2qH0mAb7EE4ICQLhCKL7fLlyzk5OQsX
LrSysho5cuSaNWu4tqgpubm5sNDW1hbm/fTTT80P8PLyQqDXsWNHHFZdXS1j
827cuIF6NTU1MazDwreuSlBYsUFpAwcOVFNTi4+Pl3jZJnscO3Zs3rx5UJG7
uzs6XiFHnjhxAiMs8cYFcZ8MQLt98MEHqHfx4sUIkEU5RQHF9uzZs8DAQAsL
CyhNDif7PX78uLCwsGfPnuQ18q1bt956CgaypKQkDGRdunSZO3fuvXv32Fv6
hFES5cPfQOuhRjwIL1++FPFchRLb8ePH4V34+fkNHz7c19f3559/5tqiv4HY
DeYNHToUnpgvH3G/s0dFRZF39Rs2bDh79izjFpaUlJB3GgMGDPjnP/8p7umK
I7bDhw/37t2bJPyRz60B0CmRbzopKSkSF4K4dfPmzd26dYMjivCQqTnDq1ev
Rmn29vbo0FC+ZEtf273Y6urq0P5wz8hap7KyMnl7Tws3OzU1FQ8COo2wsLDK
ykrRB6bWgCOHi1VXV/f09JRy6dNff/2FEoYMGQKZoUyy7YJktG+x7dq1C8E4
+Rawfft2rs1pCvwx+FrQGKI5yOyPP/5gtnwUPm7cOPLy8MCBAxKUcOjQoS++
+AIljB49Gp2blPa0Y7Ft27ata9euaKjw8HAJ8p6xTWxsLFxHmLd8+XI4kyzV
Ameex+PZ2NgYGBj4+Pi0mGy8RWpqanB8jx49MCKgBEaWvrY/saG7yM/P37hx
I/p8Z2dn+Mz19fVcG/U3ioqKFixY0KlTJ7jZ69atk37QfCsIIdEU3bt3NzY2
RuPcvXtXyMFwM3BM37599fT0cNa0adOYMqOdiQ2e/8iRI9Fd4HmUq6kaBERz
cXFxGhoauInR0dEykFljMjMzIyIiSO5cjLAtHvPdd99NnjwZx2BYb/E1sjS0
G7Ht3bvXzc3NyckJ7tkvv/xy7tw5ri36G69fvw4ICECEiPsIT/Ly5cucmPH8
+XM0DhwwePtoLkToZNI1/o/eDH/R1NTE4I5j2Ein0A7EhgATIdKnn36KwBzd
mrzlu0b3BfO8vLy6dOkC83AfubboP0ydOpUoH90XzMvOzsbPlpaW6PTYq7St
i62wsLB///5oqHfffZer7kIIWVlZiARhnre3d2JiItfm/A24jvHx8WQGAsDP
bG+G23bFlpCQ4OjoaGpqumTJEkhO3jIiPnr0iPjkCANhnnCfXPY0NDQgWkcD
KisrQ2mtuXDM0hbFlpeXl56eDsfD09PT19dXxK/AMuPPP/+EeRjT9fX1YZ4c
9rdwz7755hsyHHh4eOAH2QzubU5s+/fvNzQ0RPtMnDhRDrNJJCcnjx8/HuYh
7svIyODanKbU1dUFBwf369cPD8LmzZuvXr0K4VGxNQHdxaRJk3r37t2nT599
+/ZVVlZKsFUTq5w5cwbmqaurI6aDefKWHA/2zJs3z8TERENDY+PGjQKvg4qt
Cffv38d4hDaBCwSlcWjJoUOHkloBfQV6jLCwMHhrHFrYImi02bNnowERETf5
yk/FJgDm+fj4kPe0CxYskIF75u/v79M6ZJpZczA2YXBHz4Zj5KrLvXLlCkzS
09ODD8nj8Zo/qlRsb/hLXLOzs9XU1HAH4QVhGJVsdQD8uvxGpKamdhWKQD/O
f+fChQt/tk59fT06tB07dujo6GhpaQUFBbGRrlksampqEENh0DQyMjp8+HBr
+Y6o2PA8vvfee2gEGxubt04ChB8e1zp+fn4t9kXQcLRQJMtnAr2ReSYBAQE/
/vijRFfPABs2bBg7dizMgNKE7/GnsGLD/d26dSscbDs7u08++QQOUmlp6atX
rxB4urWEu7s7IndjY2OlloD79EvrsPc9CxEfyh84cGC3bt1gZFlZmcxWP6Gi
3NxcVArfzNvbG2a8dQ8ghRXbmjVrWuyFBKAZRzYCkTvXJgujuLgYsTP5fCCD
6srLy0l11tbWgYGBIp6lsGIjSc6BlZVVfEvIee675hw9enT58uUWFhbz5s1b
sWIFS7W8fPkS5cOxVFdXRyuVlJSIfq4iiy00NHTo0KE9evRwdHSEtybPaTxF
pKGhobCwEF2Nvr4+Lio9PZ3B2OH+/fvffPONg4ODiorKwoULxZIZQZHFtmTJ
kjf8fc8tLS3JWjbRJ5fKOdevXyf9tomJCSMeI7pNMhbAQUUoJFkhVGxv+Es2
vv766w78zVUXLVrEqV3MgF56Mx9NTc3+/fsHBwdLnOrhjz/+wOm9evWCk4YC
t2zZIrFVVGwEuCLo1sLDw83MzHr37p2amnrjxg3urGMMtLk5H1zU4sWLRc9m
iQapqKiAp4ETSQnSZ8KkYmsCHmTy2g0Pcnvaz5d8soe7dfDgQVGORydGBmIG
87NRsTUHT7STkxNpZz8/P9naxRZ3797l8Xj9+vUzMjLy8fERMiWvoKAAB2hp
aSF6winC39OKBRVbizx58gRx3Pr16zU0NLp27Tp//nx5W2ggGfDl0LM5Ozsj
XIWicPcFb3jq6urw65AhQ4yNjXHAyJEjGZ9MQsUmnE2bNkVHR7u4uKirq8tb
vg5pWL169ZgxY3DrBWmLPv30U/zasWPHbdu2sVQpFZsoREZGIuQ3NDR0c3Or
qalpH5tdwjtF90UmxQFlZWV/f39W57pQsYkOWglDDJrLy8srJydHxisxGefW
rVu4Ch0dHRIIzJ49m+0aqdjEIjMzMz4+3tvbu/EA1BZ5+PDh6NGjcRUGBgZ4
dvCDDPYtpWKTAER2uEEI6xwdHfPy8uRwumxrvH79+t69e0uXLrW1tdXhc/To
UbIghYqNPaQRG+HKlSu+vr4I6+zs7NLT0+UteXtzysrKvv/+ezJoTp48WfB3
Kja2kV5sBMH+LNOnT5e+NPa4fPky+mHYiUdj8+bNjR8NKja2YUpsb/iLiaKj
o8ms8nXr1sk+k7YQKisrKyoq0AOTr07W1tbNE1JRsbENg2IjLF++PCwsjCyT
TEpKkofJlritmpqaHfjZVr/++uvWDqNiYxvGxUYoKCjQ09NDkw4ePJjDrIC1
tbU+Pj4mfHg8nvA8k1RsbMOS2N7wM2+kpqZqa2traWmhr5Pl1/yGhgaysAvD
pa6urrOzsyhjOhUb27AnNsIPP/wAR44kF42Lizt16hR7dQkQTNUICQlBhybi
WTIW28yZM9mu6I2CiY1QVVWFGFBJSQnOeXl5OXvfuVDyli1b0JcOGTIEXYdY
I7gMxPb69evFixejpxUsJtq+ffsrPixty66AYiOcPXuWbIswbNiwnJwcZmdT
QM8oU1lZGXr28vKSoARWxXb+/HmYRxIyuLq6ClarkQYBn332WQ6f27dvM1iv
wortDX8bjvj4+ClTppAxjqmthWJiYkaMGIEyV65cefLkSckKYU9sRUVFtra2
KHzQoEG4/MZ7qkIMZBXbwIEDierwpMzjw0jiL0UWG+HBgwfTpk1DLwTv/aef
fpJ46RMCgXv37kVGRpI1YoWFhdIMRoyL7fnz5zDv6tWrJNXSwYMHG+9x3AT8
UyGfcePGkZQU6KIDAwPv8amrq5PMBio2wqxZs3x9fXv27NmnT5/09HRxh4+C
goL169eTtyvoB6S3h1mxwQ0je2d07twZl5mXlyf6udAn2UiLdNcA/V46nzNn
zohlBhVbY3Jzc9XU1NCeH374oYgTSODsBQcHW1lZ6ejoIPCUfgUKgUGxHThw
gKQf8fHxaW2PY1G4efMmWR0WFhZGVNe3b99gPjt37hSlBCq2JlRXV8fFxUFy
qqqqy5cvF/LRoYIPmeu4du1aZpP6Si82+AMwb//+/dra2uixGUyfiLC6ks/G
jRs1NDRgJyJujM4I7VGjkMeNiq1FcK/x/Do4OEB1SUlJZLPsxmRkZCgpKXUQ
uoGFlAZIIzYojaRvMjAwwIVABsyaJyAlJSWMjyBzHW4iyY7YvBelYhNCaWkp
2V7T0dExPDyc/DEgIADjEW6ijY0Nj8djaY8/icV29OhRmOfp6YnTo6KixHLP
pOHYsWM8PhYWFkR1eE5JBkUETeQYKjbhIPJCLzFjxgz0Y5MmTYJLjCHD0NAQ
3h2reUgkEBtCSJiHu9mBv4mexOkTpQTNQhIkfvzxxy4uLnBlEekjpEUAtWnT
Jiq2t7J3715Ec6NGjerA304xMzOT7RrFFRvZErQDP18WTOU876WAtLQ02OPm
5ka6Oyo2ESFfOWWTD190scE1cnV1tbe3RwcCC5u7l9zy6tUruLUYWzE0ZGdn
y0+aICo2ASKKDaO5v78/7uPChQtlYJVYwHioi7ydMzU1FfelHNtQsQl4q9jg
kMP/V1FRcXd3l8M1ZXv27CGv4yZPnrxq1SqZxSmiQ8UmoDWx1dfX19bWenh4
YGDS1dU9ceLErVu3ZGCP6MAeBwcHPT09bW3tKVOmsBStSw8Vm4AWxYZfSUIG
TU1Nedvp8g0/GT7CAXNzc1g4YMAAeXsKmkDFJqCJ2IqLi4OCgsgElRkzZuza
tUsGNojFmjVryAprxJ4pKSkXLlzg2qK3QMUmoLHYrl69amBgQHZsr6qqknjS
BUvk5OTA/zczM8PIvmLFCgz0XFskElRsAojYILPExEQMTL169ZKTLZgbc/Hi
RZinrq4OU7Oysrg2Rzyo2AQQsb3//vvkRejx48dlUKlYwHuEYwbz4D3u3r2b
2Tm9MoCKjYDRMzIy0tLSMiAg4OHDh3KVmgnGJCQkaGlp2dvbu7i47N27t40m
K6NiI5w/fx4V7d+/n+2KxOXXX39dtGgR+fB05coVrs2RCiq2N/zvO6NGjRo/
fnxtbS2rFYkOTGpoaHBzc4PrqKSkNHz48Ly8PHnbvVdcqNhu3brl7u5ubW3N
XhXignGcTPTV0dHx9PRkb2qcjKFiI+mz1qxZw14VYpGamjp9+vQO/N1709PT
uTaHSRRcbBUVFQgK4uPjOZmH1pjHjx+XlpY6ODiYmJjo6up+8sknbSi5oogo
uNisrKzkIaHctWvXyPQzMzMzide9yj+KLLYdO3aYmpoePnyYjcJFZ9myZURp
sbGxR48e5dYYVlFMsSHWg6umqanp7OzMbMmic/PmTbhkULu5ubmFhcWGDRs4
H8rZRjHF9vTpUxQ7ZMgQ4Rnb2KOwsLBfv34kIYNcpehkFcUU2/z589GnITpg
tlgRmTZtmo2NDa7L1ta23bzWEAVFE1tdXd2ZM2fs7e3nzp3LVJkiUlxcvGjR
Ii0tLXV1dRcXF/iKHObk5ARFE9tvv/2GAgMDA5kqUEQOHDigra1NVljDPZNx
7XKCQokNccHAgQMDAgJktuwONd6/f9/V1dXIyEhZWdnLy+vOnTuyqVoOURyx
VVVVYfBC9/LDDz9IX9pbgcyys7N9fHxgv6GhoaenZ5ubEcQ4iiO21atXoyhp
cgqJxcaNGwUpJeVwMgknKIjYzp4926NHj7Vr18pgJtjx48cdHByMjY11dXWj
o6Pb+lQNBlEQsXXv3r1v376FhYWMWNUijx49SuOjqqpqZWUlb8vk5QFFEFtK
Soq5uTnbWfFDQ0PJuLlu3bqCggJW62qjtG+xvXjxYv369erq6vDPmTVMwLVr
1zZt2mRqaqqmpmZhYYHoo43O2ZYBENvo0aOTk5O5NqRlpBTb9evXO/C3G2Aq
A2RjqqurExMT4QqiihEjRixevJjxKtoZcXFxaCtlZeXY2FiubWkBKcUWFBQE
GQjJ0S0x6DPfe+89km509+7dVVVVjFfR/nj58iV8DCcnp06dOqHddu7cyVQ+
ZEaQRmwQAMa1pUuXMmsS/LHZs2ejrbp27eri4lJUVMRs+e0ePKdffPEF2eYG
YTt6OTlZAy6x2MrLy5lKWS8AMkPLqKiowKSpU6du3bqVwcIVjcuXL/N4PJIk
edKkSQ0NDSxtqCQ6kont2bNn/fv3x4VcunSJKUsqKystLS1hjI2NTV5envzv
Tt4myM3NReyGwAENGxMTc/r0aQ6NkUxshw8f1tfX//nnn6U3oL6+PpuPrq6u
iYkJWkYG2/YpGoizxo4dixttbGwcFRXF1YbIEogtKyvL1NR0z549jBiAx428
PfvXv/6Fx5CRMinNuXv37rlz5wwMDNDUVlZWtbW1sn+oxRUbnM/IyEgjIyMp
63348GFGRgbZlMHX1xft8Pz5cynLpLwVeNp+fn5kD+5p06Yx1WOIiLhiW7x4
MY6XZoESHrG0tDQyZ9vR0TE0NFTioiiSgcec7JWpqqoaFBR07Ngx2dQrltjW
rFkDkaSkpNTU1Ehc47hx41Bjp06dUE5ZWZnE5VCk4enTp1VVVQj/cS9IalkZ
zAMUXWwID4cOHTp58mTJKoJTGh8fT746wU9TnEUo8syjR4/Cw8PJKDNs2DDE
Eaw6M6KLLSEhAUdKsBoOfgKuQktLC6ePGjVq1apVEllKYQv0b2vXriVhGoLW
7du3s1SRiGKbMWOGra0tAkZxP4JHRESQV9k9e/bcvXs3Vyv7KMJpaGhAyDZn
zhxlZeXOnTtDFWysShNFbBUVFcbGxmLl64DxZ/j07t0bLgGPx5OTLyYU4SxZ
sgTjKSRhaWkZGxsrjXPeHFHENmnSJDs7O7GKhfNPuuWQkBA5TANOEQICh5yc
HHRxSkpKLi4uS5cuZWpOl3Cx3b5929XV1dDQELWLUhqsGjlyJE7R1tYeMmRI
Xl6eoq3cbE8kJydramp24O+jx8gbYOFig5eFf92xY8dby8EomZ2djQcBx5ub
m9M52+2Dbdu2kY0qQkNDo6KiSkpKpClNuNgwcEM/Fy9eFF4I4peAgAAybsbF
xZ04cUIakyhyxYMHD86dO2dlZaWurg4PvLq6WuLRSojY4B8iAhU+MfLy5csO
Dg7dunUbMGDAOT50znZ75dChQ2Qfc29v77S0NAlKaFFsz58/R2keHh7QUmsn
3rhxA8cYGRnh9MGDB8vPzrMU9sjNzV24cCEZwoKCgg4ePCjW6S2K7eHDh/gj
BuvWVhag04MUcczy5csReHKVrYgie+rr6xGuTpgwwdjYGGEgHHXRz21RbB99
9BEG6B9//LH58Twez9TUVFVV1d/fH5W2+/R6lNa4cOECPKh//OMfiXxESVDc
XGynTp2ysLDYtGlTkyOLiopQprKyMo738/Nj2HRKG6S0tHTr1q1kVP3ggw+S
kpKEH99EbDi9X79+zXcxJp+rcOTOnTt3794tm72u2jev2wWIB+FrLVmyxM7O
TkVFRUtLC9FrawcnJydDQrW1teRXDQ0NRBznz58nv2KAjomJQQkINl1cXOAf
yuICFAOuxc4w6H8+/PBDaOnLL7+ES19ZWdn8mMY9244dO5SUlATrW7OysubN
m0c6SUVOekYRkZs3b+bl5aFrgors7e1fvnzZZEmXQGxpaWnkdRk0CWfP1dUV
4YahoWEeHzpnmyI66enpnp6epJtqnJWFiA0CCwoKcnJyunv3Lpz/jh07evK5
ceMGhzZT2jQhISFkpUNUVBRZR0DENnHiRPzfx8fH19eXZDzg2lJKm6euru7c
uXPvvvuupqYmAoHi4mKSLlKArq4u/DQpv7dSKI05deoUhkvEnkRj2trafnzo
l00KSwjS0som5TJFkXnx4kUVH4SoXNtCoVAoFAqFQqFQKBQKhUKhUCgUCoVC
oVAoFAqFQqFQKBQKhUKhUCgUCoVCoVAoFAqFwiT/BwYh4YA=
     "], {{0, 156.75}, {155.25, 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{96., 96.},
     SmoothingQuality->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{155.25, 156.75},
   PlotRange->{{0, 155.25}, {0, 156.75}}]], "Input",ExpressionUUID->
  "840fc862-86a1-42ee-98ef-610cc4e897c2"],
 "\n   ",
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt3U2O9EgVheECJgxZABMkFoE8Y8gUxIhRIzoRk26pGwkx6i3karwZr4E1
mMpyV1ZkpO30T/zce+J9ZBB8UvM5ro9PRjqzit/9/fs/X3759vb246/f/+3P
3/znjz/88M1///Kb9//y1+9+/Nc/v/v2H3/67t/f/vPbH/7w91+9/+HffvH2
9v37v27/eQQAAAAAAAAAAAAAAAAAAAAAAAAAx4ZPtU8EgGPDtXv7dOlrnw0A
r/rL2xtlAuCkhyqhTAAcE1UJZQLgiKcqoUxQ0dBfLzfXng8CnLlXyeX69QSW
MkENtx65h7C7Uiau3Kvk/coNlAlqeagRysSfr/b4KA/KBDWE30mgTHyKqoQy
QR2UiXfh+5uf/4gyQQ2fuetuj1yDTwMoExe+aiO8YJQJqhj6rx/goEx8Ca/X
JfS12+w6PpxDDZSJLzPfK1nA5URhlIkvlAnMoky8GWb14TMTfhUBaqBMNPAA
FtVRJhooE1RHmWigTFAdZdKa//329xwc0ZEkWpRJU6qHlsPscT5dlElTqieW
w+xxPl2USTui8Pz0qXqMOSwc5wNGmTQiSs5Pj6onmcPCcTJjlIm82dhEZVL7
HFFH2jKBtqXXIMoEyXcmELaym6VMGpfjbQ5Urb8vpkxalumZCSS9jApl0qx8
D2ChZ0tOKJM2Zf00B2I2hoQyaVDuj4ahZHtCKJPWFPieCWTsigdl0pSlbFAm
iBx4oaFM2rGeDcoEd8e2rJRJI15mg80JJoff/FImLdiSDcoE47kvMVIm8jbG
gzLByafxlIm27fGgTBp3/nM9ykTYrnhQJi073yQjZaJrbzwok2YlaZKRMhF1
IB6USYMOf3AzizLRcywelElr0jbJSJnIORwPyqQpyZtkpEy0nIkHZdKO5DUy
oUxknEwIZdKITE0yUiYqzieEMmlBviaZ0CfeJUkIZSIvd5OMlIlzqRJCmWgr
0CQjZeJZwoRQJqpyfHCzhDJxKm1CKBNJJZtkpEzcokywrnCTjJSJT8lDQpmI
Kd8kI2XiUI6QUCZKytfIhDLxJVNOKBMZtZpkpExcyZoTykRAxSYZKRM/cueE
zYl3dZtkpEycKJATysSvKo9bn1Em9pXJCWXilJEmGSkT84rlpHoUcYCdJhkp
E9tK5sRCGrGLqSYZKRPDCufESCCxkakamVAmNpWPiqlYYp3BJhkpE5OqRMVa
MrHEZpOMlIk9taJiMJx4ZrZJRsrEmIpRsZlP3Fl73PqMMrGjblTMRhSjhyYZ
KRMzqkfFckob56JJRsrEBgtRMR7UZnlpkpEyMcBIVKqfAJ4ZycZGlElddtJi
4RwQspONjSiTikylxchpYGIqGxtRJrVYS4udM4G1bGxEmVRhMC2mTqZlBrOx
EWVSns20WDufBjn64GYWZVKY5bQYPKV2eG+SkTIpy3hazJ6YPIEmGSmTguyn
xfK5CbMfjI0okzJcBMb46UlyEYyNKJMCvATG/hmK8RKMjSiT3BwFxsVJynAU
jI0ok6x8BcbLeQrwFYyNKJN83AXG0an6pfHBzSzKJBOPgfF1th4JN8lImeTh
NDDuTtgX7SYZKZMM/AbG4zl7Id8kI2WSmuvAOD1t+1ynYjvKJCHvmfF75pZ5
T8V2lEkqAplxffI2CaRiF/rkPI3MeD9/azRSsQtlcpJMZgSWYEQLj1tnUSZn
KGVGYxXVNdskI2VyglhmZBZSUctNMlImR+llRmEtw9B/GYayf3njTTJSJodI
Zsb1cob+0r3N6C7XMpUiGYm9KJO9hGPjd0XDdbZLfi6UPvPfLhyJXSiTXbRj
43ddU5l07xuR6/sbnOvlcZ/S5dyeaEdiF8pkO/nY+F3aMPRxX/SXrzbJtjeR
j8QulMlGLcRGanXhO58MZcLj1meUyRaNxEZqgUGZJH+bQ5PMokxeaic2Omsc
+mBfkrhLaJIlSmUSfssg1ZcMmoqN72X2l26S87McmmSFQpncvmQw98lgii8Z
NJUc38sMn7h+Xv+nx7KnNBWGA/yXyVOG0r0wtRYe3ytdCMJ7ApI0SmthOECp
TLrLJNrnHtyeNBge74sdPvXXx73q6bc6DYbhAIkyeXrxefhC5JE2aTM8WusN
dyqnnsG2GYYD/JfJOPes9aFN9r4uNRsesSUn+aZJs2E4QKBM5hwvk5bDI7bq
k9+B5YObvTTL5GiXNB4erwsfrjOf25zanNIkRyiWyfDwXH9zjgiP17Xfe6P7
+Rl8/E2BnV1CkxwjVyaPTbL5yRvhGQXKZNbOh68k4TCpMol/Rc7WL5mQn4nb
CfTX2W8t7v+OCUk4Q6ZMnn7XFnuS3dwP4eM7Jh8/THHkxylIwkkaZRLvczfv
bMlPqOU5kITzFMrk2FMS8vOk2VGQhCT8l0n00Q1Nckpr0+CDm4Tcl0n0pek5
z/8Q+VnS1ExokrS8l8n6zwx/blce/hHys6KdsdAkybVWJuRnXSOToUlycF4m
619XisuE/LzUwnCIQSbOy2QHIrSF/HyIQT6NlAkR2khyREtvapTWaEELZUKE
ttObEk1SjHyZEKFd9AZFkxQjWSa8GB0mM6v1DHDkOKIyqX4+uY/aGbdOY1zV
Y8Yhf9TOuAMaE6ueNA7to3bAfdAYWvWwcQgftdPthszcqkeOQ/KonWtPZEZX
PXUcekftUDujND3yUJjeR8OE5wy96emtyDKxPiE8Z+hNT29FllEmuNObnt6K
LKNMcKc3Pb0VWUaZ4E5venorsowyQUhseuShJMoEIbEBii3HOMoEIbEBii3H
OMoEIbEBii3HOMoEIbEBRssRWJFllAlCegPUW5FZlAlCegPUW5FZlAlCegPU
W5FZlAlCegPUW5FZlAlCegPUW5FZlAlCegPUW5FZlAlCegPUW5FZlAlCegPU
W5FZlAlCegPUW5FZlAlCegPUW5FZlAlCegPUW5FZlAlCegPUW5FZlAlCegPU
W5FZlAlCegPUW5FZlAlCegPUW5FZlAkiYgMkEsVQJoiIzVBsOZZRJoiIzVBs
OZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBs
OZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBs
OZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBsOZZRJoiIzVBs
OcYp9QnJOU9vhnorMosyQUhvhnorMosyQURshqSiGMoEEbExii3HMsoEEbEx
ii3HMsoEEbExii3HMsoEEbExii3HMsoEEbExii3HMsoEEbExii3HMsoEEbEx
ii3HMsoEEbExii3HMsoEEbExii3HMsoEEbExii3HMsoEEbExii3HMsoEEbEx
ii3HMsoEEbExii3HMsoEEbExii3Hsp/m1D6pg4hNEmJjFFuOZbNl4rRPiE0S
YmMUW45llAkiYmMUW45lS2VyQO2lEJs0do9xWJb/bF8iFWUkbBILiE0SO8fY
X96WXfoSZ7yKVBRQ+9bXVPuqprHj7huuHWXSttr3HHJJEo8dNyBl0rbaeYd1
O27Ar3c5BopjDmWSyVJ4sv6PwyPKBCuWYlP7vJIpd6c1YHeZdFcLn908o0yS
W8pM7fNKyUJsyt3tmW2c5Ncjk+7aG/pA+IuFVChZCkzt80qM2IyJ2mz7JJee
v3a3bim26DWkIqEWamRCbA6LRrd9kqvfMjHxzodUJNHIhuSO2Byz3iSvyqS7
uXx4/w/26oRUnNdak4zE5pCXTbJ3ksPDZqV+m5CKkxpskpHY7LdUHScnGdZJ
9Q+MScUZZ5tkGPpPxh7Mv0BsdlnZhJycZPhUljLx61yNXC/Pz+a7S/Wd6kbE
Zrv1tzPpdib13+aMBGO/sxuSfqZI7Ly+bEFmttj4YGTbGPvr0yfAD89MTHQJ
wdjn9EOSx6dml+vtTc7DVwgc1AmZeSnJI9bAz7EJPs+x+BpEMLZL8Lh14V2u
qSdpL5GZdambZFz/momNXckNwdgoQZOMD6F4KI2lPzeJzKzI0CTjx4vQ3Jvj
29bWSpOMBGObBDUyCXYmDy8oX2Vi53VmEZlZkqFGHn38SM7Hx38WPwAkGOvS
bEgCD3uQKRCDq33JB2LzLHuTmNfy2l9K3iQfHn5mK9y9dhdLe9ZVxCZCk4yk
YlmeJpn0zz8D6udrJjfEJkSTTJjArIxNsvY9k87Juxxi84UmuWMIz7JtSB7f
4tx/E8UQ9ouDB7AjsflEk4SYQyjnW5ubxSetpn7KYgNiM9IkTxjFXe4mWf1Z
iqXPjI0iNjTJM6Yxyd8k42qZWPuZrRcajw1NMouBjOV+4+LDh8JL34DlbY5x
NMmSxmdSZEMSePw5v+kH/aLfR+ChS9qNDU2youWxlG6SD+v/N48e3uLctBkb
mmRds5Op0iSTId6MTD1i64e21jUYG5rkpTaHU7FJAsOXsn/xea3FhibZosH5
GKgR95qKDU2yUVMjsrEhUdBObGiS7dqZEk2SUAuxma0R1cUm0cigaJK05GND
kxzQwqxokuS0Y0OTHCM/LmokB+HY0CSHCU+MDUk+qrGhRs5QnRtNkpVkbGiS
kyRHR5PkphcbmuQ8venRJAWIxYYmSUJsgNRIGUqxoUlSkZkhG5KSZGJDkySk
MUaapDCN2NAkaQlMkiYpTyA2NEly3odJk1ThPTY0SQ6u50mN1OI6NjRJPh6n
yoakLo+ZmdAkWbkbLE1SnbvMTGiS3HzNliaxwFdmJjRJAY7GS5MY4SgzE5qk
DC8Tpkbs8JKZCU1SjP0hsyGxxn5m7miSkozPmSYxyHhmJrM1YvZsNVgeNU1i
k+XMTGiSKsxOmyYxy2xmJjRJLTYHTo1YZjMzE5qkImszZ0Nin7XM3FEjdZma
PE3igqnM3NEk1dkZPk3ihZ3M3NEkFhiZPzXiiJHMLJ2PkbNqUPVLwIbEneqZ
WTkZC6fUrLpXgSbxyM6dS5OYUvFC0CROGbl5aRJral0LmsQvC/cvTWJQlctB
jbhW/RamSWwqfEXYkAioexfTJGaVvCg0iYaKNzJNYlmx60KTyKh1L9MkxpW5
NDSJkiq3M01iX4GrQ42IKX9H0yQuZL1AbEgkFb6paRIv8l0jmkRVyfuaJnEk
02WiSYSVubVna4QmsSzHlaJJtBW4u2kSj5JfLGpEXu4bnCZxKuH1YkPSiKz3
OE3iV6pLRpO0I99tTo24luTC0SRNyXSz0yTenb92NElrctzvNImAk5ePGmlQ
8lueJpFx7CKyIWlW2rueJlFy4DrSJC1LeOPTJGL2XkqapHGp7n2aRM+uq0mT
IMntT5NI2n5BqRGMKcqEJlG15ZqyIcHdyRKgSYS9vKw0CUJneoAm0bZ+ZWkS
RA5XAU0ib+Xi0iR4dqwNaJIWLF1fagSzDhQCTdKI50vMhgQr9nYCTdKO6CrT
JFi3qxZokqbQJNhlYzPM1ghNom29SWqfHczZUg40SZvYkGCXl/1AkzSLJsEu
6xVBkzSLJsFeKy1BjTSLJsEBS11Bk7TsuUaW9qgbj9oLQgmzF508NC5tk5g6
ao9W2fOouQQYgz6pfvurHrWvcHptrhovVb/XOIodxTKT6i+CO9VDzqF01I4z
FFSPMUf1o3YGgcSq31NtHrUvO6Cs+g1OhwBIK2170CQAAAAAAACFDEN/Nwy1
zwaAP8P10r09ufS1zwt5DFvUPkn4M/SX5x6hTIQN15lXjifdlTrBLo9N0nWX
67Xvr9fLbadCmWiiTJBBWCWEpxXbyoSXEuwRdAnRQdgy5AF7BNFhVwLygOO+
9iVTdoaPZyU3Vz4Ybg/bVBz2sKedeRvNq1NLgirhwmOvxU+EeQbXnPC1hIuO
3aIy6W7vbd714dfXeJFqAtsSnLP8sTDZagtPS3DScmWw6W0JVxunLX8SSLwa
Em5Qudg4aHF3y9ucdtAlSGI+SOG+hC4RR5cgkcdvl3S376t14Z8QL3F0CRJa
/rYJuxJ5bEKR2PNvRuq6S0+05D1sTNmYIJ3bF9Z6fsNWQ/gFFAAAAAAAAAAA
AAAAAACg7v9aAdM2
     "], {{0, 260.25}, {275.25, 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{96., 96.},
     SmoothingQuality->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->{185.25, Automatic},
   ImageSizeRaw->{275.25, 260.25},
   PlotRange->{{0, 275.25}, {0, 260.25}}]], "Input",ExpressionUUID->
  "2124b982-f468-42ab-8b27-c4e4e46faba8"],
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt2k+O23QcBfAINiy5ArdA3rFkW8QBWnVcsRmkKRLiFr4Lks/AHXyY4jRN
Ymc8EyGBv/7g95Fa9c/m6f1eHdvpd+9+fdN+dTgcPn4z/vTm7e8/PD29/eOn
b8ff/Pz48ZcPjw/vf3z87eHDw9P3774e//Cv8cef44/jrz9FRERERERERERE
RMS/YDirDhIbMnTN4aztq9PEVvTt4ZBhrG4Y+qsNXqpns8gwVjD0bXNY0LTd
duZxM4sMYwXTT+7n49hE/89mkWGs4DSMZrxAdOOHSNfOrx9N/WXjMosxYZNh
rGa8ubg9++m/0OoTuGQZJzpkGLU281x4DfI5RoZRbHIAlR8lN7PIMGoN/eR6
UbiL6WfIOVqGsbLxifVkK88k1wlMp5lhrO3Z8+D4jPLslrQkTtNOTS5lp7+o
TLkHCy8KvlwySnp/Ic5Swvqn6f+5y9eWfdfOPlEqrtkZxlZNT6ak+2FRP73H
yNfvFTbzJmMmN5/ltvTu8yrDWM/QLdzZz75X29ARZBjruXT95fmvvXmXkRPY
qde+dM9N/56Nd/ov/D+dvDuKT6cHxNP/6sszYERERETE1StP2PHfqT72+6ob
2qnqY7+vuqGdqj72+6ob2qnqY7+vuqGdqj72+7jAKK5nLjCK65kLjOJ65gKj
uJ65wCiuZy4wiuuZC4zieuYCo7ieucAormcuMIrrmQuM4nrmAqO4nrnAKK5n
LjCK65kLjOJ65gKjuJ65wCiuZy4wiuuZC4zieuYCo7ieucAormcuMIrrmQuM
4nrmAqO4nrnAKK5nLjCK65kLjOJ65gKjuJ65wCiuZy4wiuuZC4zieuYCo7ie
ucAormcuMIrrmQuM4nrmAqO4nrnAKK5nLjCK65kLjOJ65gKjuJ65wCiuZy4w
iuuZC4zieuYCo7ieucAormcuMIrrmQuM4nrmAqO4nrnAKK5nLjCK65kLjOJ6
5gKjuJ65wCiuZy4wiuuZC4zieuYCo7ieucAormcuMIrrmQuM4nrmAqO4nrnA
KK5nLjCK65kLjOJ65gKjuJ65wCiuZy4wiuuZC4zieuYCo7ieucAormcuMIrr
mQuM4nrmAqO4nrnAKK5nLjCK65kLjOJ65gKjuJ65wCiuZy4wiuuZC4zieuYC
o7ieucAormcuMIrrmQuM4nrmAqO4nrnAKK5nLjCK65kLjOJ65gKjuJ65wCiu
Zy4wiuuZC4zieuYCo7ieucAormcuMIrrmQuM4nrmAqO4nrnAKK5nLjCK65kL
jOJ65gKjuJ65wCiuZy4wiuuZC4zieuYCo7ieucAormcuMIrrmQuM4nrmAqO4
nrnAKK5nLjCK65kLjOJ6PkSF6mO/r7qhnao+9vuqG9qp6mO/r7qhnao+9vuq
G9qp6mOPiIiIiIiIiIj4Z4ahvxiG6jRRbujbpll49dm0XeaxX3372nvxpu2r
A0aN6zCa9mR+9Why2dincRjjZWF++EPXZBm7t3SfOVvG1j5Nhr77fGXr+ix2
bVsdxnETTS5lZTa4i9kkMowSw+xBpX4Xs5lmGEXmq9hE+RlGteObrlnz9VeL
o/MwmuPt5mS3GcYabkexpdqHyRv6DGNNtxfrDVeeYaxne3cVr8gw1nLzCLL1
rjOMlUx3MTa9pDriTIaxjte/Wz1fRqpTTmQY68gwYslL744yjMBkGLEow4hF
GUYsyjBiUYYREREREREREREr+Btu1Gaj
     "], {{0, 150.}, {134.25, 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{96., 96.},
     SmoothingQuality->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{134.25, 150.},
   PlotRange->{{0, 134.25}, {0, 150.}}]], "Input",ExpressionUUID->
  "3440b615-98e9-4442-80ae-77a2aaeb2ac0"],
 "\n   Q1 counter-clockwise. H1 clockwise\nQ1 Permutation: {1,2,3,4}, \
{2,3,4,1},{3,4,1,2},{4,1,2,3}.\nH1 Permutation:  {1,2,3,4,5,6,7,8}, \
{1,5,6,2,4,8,7,3},{2,6,7,3,1,5,8,4},{1,4,8,5,2,3,7,6},{5,8,7,6,1,4,3,2},{3,7,\
8,4,2,6,5,1};\n\nQ1 BC: {{1,2},{2,3},{3,4},{4,1}}\nH1 BC: \
{{1,2,3,4},{5,6,7,8}, {1,5,6,2},{4,8,7,3},{2,6,7,3},{1,5,8,4}}\n"
}], "Text",
 CellChangeTimes->{{3.8995438193805494`*^9, 3.8995438271328382`*^9}, {
   3.899543936537923*^9, 3.8995439506983805`*^9}, {3.8995446943249855`*^9, 
   3.8995448378633285`*^9}, {3.8995448947522883`*^9, 3.8995449502813244`*^9}, 
   3.8995451583404164`*^9, {3.8995451953597097`*^9, 3.899545242822956*^9}, {
   3.899545277314745*^9, 3.8995453224919944`*^9}, {3.8995508228105993`*^9, 
   3.8995508595009995`*^9}, {3.899550892144166*^9, 3.8995510369607153`*^9}, {
   3.8995518248689203`*^9, 3.899551835360982*^9}, {3.899551974768998*^9, 
   3.8995519760634003`*^9}, {3.899553032960189*^9, 
   3.89955310159696*^9}},ExpressionUUID->"8840f7f9-f292-470b-9546-\
3ad1e11ffbcf"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MathematicaQ1H1TOAbaqus", "[", "ele_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"ele", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "4"}], ",", "ele", ",", 
     RowBox[{"ele", "[", 
      RowBox[{"[", 
       RowBox[{"All", ","}], "]"}], "]"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.899618829292634*^9, 3.8996188838240023`*^9}, 
   3.8996190006881757`*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"62c590d5-e1c7-4dfa-8606-ad046af50cad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Mesh2Abaqus", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mesh2Abaqus", "[", 
    RowBox[{"file_", ",", "coord_", ",", "ele_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "len", ",", "elen", ",", "strAll", ",", "scoord", ",", "sele", ",", 
       "ci", ",", "\[IndentingNewLine]", 
       RowBox[{
       "shead", "=", 
        "\"\<*Heading\\nMesh from Mathematica\\n*Part, \
name=part1\\n*Node\\n\>\""}], ",", "\[IndentingNewLine]", "selement", ",", 
       RowBox[{"send", "=", "\"\<*End Part\>\""}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"elen", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"ele", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "file", "]"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Warning, existed file was deleted!\>\"", "]"}], 
         ";", 
         RowBox[{"DeleteFile", "[", "file", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"coord", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "2"}], ",", 
        RowBox[{"selement", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"elen", "==", "4"}], ",", 
           "\"\<*Element, type=CPS4\\n***CPS4 for plane stress, CPE4 for \
plane strain\\n\>\"", ",", 
           "\"\<*Element, type=CPS3\\n***CPS3 for plane stress, CPE3 for \
plane strain\\n\>\""}], "]"}]}], ",", 
        RowBox[{"selement", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"elen", "==", "8"}], ",", "\"\<*Element, type=C3D8\\n\>\"",
            ",", "\"\<*Element, type=C3D4\\n\>\""}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"scoord", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ci", "=", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"DoubleToString", "[", 
                 RowBox[{"coord", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"\"\<  \>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], ",", 
              "\"\<, \>\""}], "]"}], "]"}], "<>", "\"\<\\n\>\""}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "coord", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sele", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ci", "=", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"IntegerToString", "[", 
                 RowBox[{"ele", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"\"\<  \>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], ",", 
              "\"\<, \>\""}], "]"}], "]"}], "<>", "\"\<\\n\>\""}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ele", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"strAll", "=", 
       RowBox[{"shead", "<>", 
        RowBox[{"StringJoin", "[", "scoord", "]"}], "<>", "selement", "<>", 
        RowBox[{"StringJoin", "[", "sele", "]"}], "<>", "send"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"file", "<>", "\"\<.txt\>\""}], ",", "strAll"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RenameFile", "[", 
       RowBox[{
        RowBox[{"file", "<>", "\"\<.txt\>\""}], ",", "file"}], "]"}], ";", 
      "file"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Mesh2AbaqusInput", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<testinp4.inp\>\""}],
      ",", "coord", ",", "ele"}], "]"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"worked", ".", " ", "LS"}], " ", "prepost", " ", 
     RowBox[{"crashed", "."}]}], "*)"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DoubleToString", "[", "a_", "]"}], ":=", 
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"Internal`MRealToString", "[", 
     RowBox[{"N", "[", "a", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<*^\>\"", "\[Rule]", "\"\<e\>\""}], ",", 
      RowBox[{"\"\<`\>\"", "->", "\"\<\>\""}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"DoubleToString", ",", "Listable"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegerToString", "[", "a_", "]"}], ":=", 
   RowBox[{"ToString", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"IntegerToString", ",", "Listable"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.899625040871282*^9, 3.899625049588196*^9}, {
   3.899636299762705*^9, 3.899636300356451*^9}, {3.899637574864715*^9, 
   3.899637590954475*^9}, {3.8996381110819187`*^9, 3.899638115483426*^9}, {
   3.899638153784229*^9, 3.899638168936843*^9}, {3.899638317781869*^9, 
   3.8996383221638427`*^9}, 3.8996383699884205`*^9, {3.8996384059221163`*^9, 
   3.8996384265503626`*^9}, {3.8996384610258503`*^9, 
   3.8996384738361645`*^9}, {3.900294532558949*^9, 3.9002945426425524`*^9}, {
   3.9003013613926888`*^9, 3.900301365651948*^9}, {3.9003020732662163`*^9, 
   3.900302122537135*^9}, {3.9006007815778246`*^9, 3.900600782140238*^9}, {
   3.934370152086484*^9, 
   3.9343701711851077`*^9}},ExpressionUUID->"26a08de0-777f-4382-a509-\
67497c67f71a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1permutation", "[", "e8_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"face", ",", "pair", ",", "facePer"}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "e8", "]"}], "!=", "8"}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", 
     RowBox[{"face", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",",
           "8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "5", ",", "6", ",", "2", ",", "4", ",", "8", ",", "7", ",",
           "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "2", ",", "6", ",", "7", ",", "3", ",", "1", ",", "5", ",", "8", ",",
           "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "4", ",", "8", ",", "5", ",", "2", ",", "3", ",", "7", ",",
           "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "5", ",", "8", ",", "7", ",", "6", ",", "1", ",", "4", ",", "3", ",",
           "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "3", ",", "7", ",", "8", ",", "4", ",", "2", ",", "6", ",", "5", ",",
           "1"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"facePer", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pair", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"face", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "ii"}], "]"}], "]"}], ",", 
              RowBox[{"face", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"ii", "+", "4"}]}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "facePer"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"e8", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "pair"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{"Test", ":", " ", 
     RowBox[{
     "there", " ", "are", " ", "24", " ", "forms", " ", "of", " ", "node", 
      " ", "list", " ", "to", " ", "represent", " ", "an", " ", "H1", " ", 
      RowBox[{"element", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rg", "=", 
     RowBox[{"Cuboid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", ",", "coord", ",", "ele", ",", "eleB", ",", "eleP"}], 
      "}"}], "=", 
     RowBox[{"Region2Mesh", "[", 
      RowBox[{"rg", ",", "1"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"ele", "\[IndentingNewLine]", 
      RowBox[{"ShowMesh", "[", 
       RowBox[{"m1", ",", "True"}], "]"}], "\[IndentingNewLine]", "ep"}], "=", 
     RowBox[{"H1permutation", "[", 
      RowBox[{"ele", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ShowMesh", "[", 
       RowBox[{
        RowBox[{"Abaqus2Mesh", "[", 
         RowBox[{"coord", ",", 
          RowBox[{"{", "ei", "}"}]}], "]"}], ",", "True"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "ep"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "*)"}]}]}], "Input",
 CellLabel->
  "In[171]:=",ExpressionUUID->"13dc5875-7bd2-4183-b333-d97490309f19"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mesh coord reordering RCM", "Section",
 CellChangeTimes->{{3.8999963993420095`*^9, 
  3.8999964064733534`*^9}},ExpressionUUID->"6329a746-d076-4a90-a422-\
7726a760816d"],

Cell["", "Text",
 CellChangeTimes->{{3.8999964183458924`*^9, 3.8999964207775073`*^9}, 
   3.9343702085927744`*^9},ExpressionUUID->"a5770fd9-57f7-4caf-8af3-\
6a4fdd156d57"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<GraphUtilities`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mesh2ListOrdered", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ei", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nShift", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"e2", "=", 
          RowBox[{"Sort", "[", "ei", "]"}]}], ",", "eL", ",", 
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"len", "=", 
          RowBox[{"Length", "[", "ei", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"eL", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"len", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"len", "-", "1"}], ")"}], "/", "2"}]}], "]"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"eL", "[", 
              RowBox[{"[", 
               RowBox[{"k", "++"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"e2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "nShift"}], "+", 
              RowBox[{"e2", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"i", "+", "1"}], ",", "len"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "len"}], "}"}]}], "]"}], ";", "eL"}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationOptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}]}], "}"}]}],
      ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mesh2ListOrderedNo", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ei", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nShift", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"e2", "=", "ei"}], ",", "eL", ",", 
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"len", "=", 
           RowBox[{"Length", "[", "ei", "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"eL", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"len", 
              RowBox[{"(", 
               RowBox[{"len", "-", "1"}], ")"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "eL", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"eL", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "++"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"e2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "nShift"}], "+", 
                RowBox[{"e2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
              RowBox[{
               RowBox[{"eL", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "++"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"e2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], " ", "nShift"}], "+", 
                RowBox[{"e2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"i", "+", "1"}], ",", "len"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "len"}], "}"}]}], "]"}], ";", "eL"}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationOptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}]}], 
        "}"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ","}], "*)"}], 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeshMinimumBandwidthOrdering", "[", "meshList_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nMax", "=", 
        RowBox[{"Max", "[", "meshList", "]"}]}], ",", "mgraph", ",", "ej", 
       ",", "nshift", ",", "res"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nshift", "=", 
       RowBox[{"10", "^", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"Log10", "[", "nMax", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mgraph", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Mesh2ListOrderedNo", "[", 
           RowBox[{"meshList", ",", "nshift"}], "]"}], ",", "1"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mgraph", "=", 
       RowBox[{"QuotientRemainder", "[", 
        RowBox[{"mgraph", ",", "nshift"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mgraph", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"mgraph", "->", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"nMax", ",", "nMax"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"MinimumBandwidthOrdering", "[", "mgraph", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"]", ";"}], "*)"}], "res"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMMeshReordering", "[", 
    RowBox[{"coord_", ",", "meshList_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gh", ",", "m2"}], "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{"xt1", "=", 
       RowBox[{"AbsoluteTiming", "["}]}], "*)"}], 
     RowBox[{
      RowBox[{"gh", "=", 
       RowBox[{"MeshMinimumBandwidthOrdering", "[", "meshList", "]"}]}], ";", 
      RowBox[{"m2", "=", 
       RowBox[{"meshList", "/.", 
        RowBox[{"Dispatch", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{"gh", "->", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "gh", "]"}], "]"}]}], "]"}], "]"}]}]}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{"]", ";"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"xgh", "=", "gh"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coord", "[", 
         RowBox[{"[", "gh", "]"}], "]"}], ",", "m2"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"90", "k", " ", "H1"}], ",", " ", 
    RowBox[{
     RowBox[{"takes", " ", "25", "s", " ", "to", " ", "index"}], "-", 
     "reordering"}], ",", " ", 
    RowBox[{"MinimumBandwidthOrdering", " ", "is", " ", "very", " ", 
     RowBox[{"slow", ".", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"23.106532`", ",", "Null"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"24.9946448`", ",", "Null"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2601026`", ",", "Null"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "Use", " ", "symmetric", 
     " ", "sparse", " ", "matrix"}], ",", " ", 
    RowBox[{
    "the", " ", "time", " ", "is", " ", "reduced", " ", "from", " ", "25", 
     " ", "to", " ", "4", " ", 
     RowBox[{"seconds", ".", " ", "Sparse"}], " ", "matrix", " ", "is", " ", 
     "much", " ", "faster", " ", "than", " ", "Graph", " ", "in", " ", "the", 
     " ", "function", " ", "of", " ", "MinimumBandwidthOrdering"}]}], 
   "\[IndentingNewLine]", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Test", " ", "RCM", " ", "performance"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "2000000"}], ";", 
        RowBox[{"a", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Band", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", 
              RowBox[{"Random", "[", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Band", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}], "]"}], "->", 
              RowBox[{"Random", "[", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Band", "[", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}], "]"}], "->", 
              RowBox[{"Random", "[", "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "+=", 
         RowBox[{"a", "\[Transpose]"}]}], ";", 
        RowBox[{"p", "=", 
         RowBox[{"Ordering", "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "n", "}"}]}], "]"}], "]"}]}], ";", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"q", "=", 
           RowBox[{"Ordering", "[", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", "n", "}"}]}], "]"}], "]"}]}], ";"}], "*)"}], "\n", 
        RowBox[{"b", "=", 
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"p", ",", "p"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"N", "[", "a", "]"}]}], ";", 
        RowBox[{"b", "=", 
         RowBox[{"N", "[", "b", "]"}]}], ";", 
        RowBox[{"xp", "=", 
         RowBox[{"N", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x1", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"a", ",", "xp", ",", 
           RowBox[{"Method", "->", "\"\<Pardiso\>\""}]}], "]"}]}], ";"}], "//", 
       RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "x2"}]}], "=", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"b", ",", 
        RowBox[{"xp", "[", 
         RowBox[{"[", "p", "]"}], "]"}], ",", 
        RowBox[{"Method", "->", "\"\<Pardiso\>\""}]}], "]"}]}], ";"}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"[", "p", "]"}], "]"}], "-", "x2"}], "]"}], "/", 
      RowBox[{"Norm", "[", "x2", "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2.7941252`", ",", "Null"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.6025204`", ",", "Null"}], "}"}], ",", 
     "8.226559044813807`*^-14"}], "}"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "RCM", " ", "can", " ", "save", " ", "half", " ", "time", " ", "for", " ", 
    "2", " ", "million", " ", 
    RowBox[{"dofs", "."}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8999964472971296`*^9, 3.8999964477542243`*^9}, 
   3.8999965502377267`*^9, {3.900034802718016*^9, 3.9000348080337763`*^9}, {
   3.9000355194761553`*^9, 3.900035520346307*^9}, {3.900036005916597*^9, 
   3.9000360095867047`*^9}, 3.9000393506637926`*^9, {3.934370179796353*^9, 
   3.934370191530205*^9}},ExpressionUUID->"7411a5a7-3ae0-4b47-8c02-\
e27f1ba107b2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428., 729.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"600fd2fe-a1c4-40fd-829e-38fe30430be2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 212, 4, 98, "Title",ExpressionUUID->"0755cff9-3e35-4645-8c7f-357667b38bc1"],
Cell[795, 28, 1254, 22, 104, "Text",ExpressionUUID->"ffa4902b-93df-48a8-8a49-78a11128ef01"],
Cell[CellGroupData[{
Cell[2074, 54, 229, 5, 67, "Section",ExpressionUUID->"c6c726f1-4280-4457-8902-787126562587"],
Cell[2306, 61, 2013, 54, 162, "Input",ExpressionUUID->"cfd1fc96-405b-448b-994c-1970e153d838"],
Cell[4322, 117, 1163, 29, 86, "Input",ExpressionUUID->"ff0fc33e-1e08-41ba-97e3-088d945857a6"],
Cell[5488, 148, 884, 25, 50, "Input",ExpressionUUID->"f2bd049d-493b-47bf-becd-e7efa27d4b09"],
Cell[CellGroupData[{
Cell[6397, 177, 172, 3, 54, "Subsection",ExpressionUUID->"cd3e8814-57ad-4086-b3db-41f627be5269"],
Cell[6572, 182, 6210, 168, 333, "Input",ExpressionUUID->"f03853b6-9f59-4c4c-a396-51fe7b162ba8"],
Cell[12785, 352, 2674, 69, 143, "Input",ExpressionUUID->"b8fb3ffb-d523-4628-a81d-507ca55f3178"],
Cell[15462, 423, 48005, 1195, 1542, "Input",ExpressionUUID->"dbbacb9f-1470-473b-89f4-028376bf3f29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63504, 1623, 238, 4, 54, "Subsection",ExpressionUUID->"5d92b0c8-6dcc-4271-ae49-00520ab7b4e6"],
Cell[63745, 1629, 1202, 16, 28, "Input",ExpressionUUID->"7ab2d612-46c6-4c71-83a2-aeea2e450362"],
Cell[64950, 1647, 21071, 535, 1018, "Input",ExpressionUUID->"ace4e6b4-89fa-410b-a146-2063f21bf45d"],
Cell[86024, 2184, 106382, 2574, 2008, "Input",ExpressionUUID->"77317bcb-5246-4aef-8d37-a31ac1a4ece7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[192455, 4764, 174, 3, 67, "Section",ExpressionUUID->"1eb439b5-3261-48b8-82d2-013418856e66"],
Cell[192632, 4769, 724, 16, 48, "Input",ExpressionUUID->"a478105a-8d18-4ef7-a39b-48ac5b480c7f"],
Cell[193359, 4787, 128, 3, 28, "Input",ExpressionUUID->"15e368be-6bcd-4c05-af6a-ec0a31647ac4"],
Cell[193490, 4792, 9377, 241, 207, "Input",ExpressionUUID->"661deced-f7e7-4ccb-b9ce-2cf24681593f"],
Cell[202870, 5035, 1397, 40, 28, "Input",ExpressionUUID->"96beced4-a89e-431a-81c7-5e15932bebf5"],
Cell[204270, 5077, 1263, 32, 105, "Input",ExpressionUUID->"47cc8103-c817-4739-83ce-cbcd0d83bc56"],
Cell[205536, 5111, 73740, 1769, 733, "Input",ExpressionUUID->"eea08416-59b1-43c3-9316-622d3c6c334d"],
Cell[CellGroupData[{
Cell[279301, 6884, 187, 3, 54, "Subsection",ExpressionUUID->"4b9c0b3b-12eb-41f3-8d16-9d1cd08eb4de"],
Cell[279491, 6889, 34217, 871, 1165, "Input",ExpressionUUID->"60ab1846-3534-4f9d-946c-7c7aa9a5da8f"],
Cell[313711, 7762, 1269, 28, 86, "Input",ExpressionUUID->"a8a3e635-7de5-4890-96e3-155d30d48e40"],
Cell[314983, 7792, 6047, 137, 333, "Input",ExpressionUUID->"eee7c999-75d5-4a13-a4d3-f822840eb630"],
Cell[321033, 7931, 6275, 154, 428, "Input",ExpressionUUID->"38059ea5-fabe-4747-b37b-bedaf6ae608b"],
Cell[327311, 8087, 5924, 150, 428, "Input",ExpressionUUID->"2ad09320-9d74-4da3-a8a3-441d158bf6f7"],
Cell[333238, 8239, 2044, 51, 143, "Input",ExpressionUUID->"73d1f430-30b7-4b56-b528-18663eeeef57"],
Cell[335285, 8292, 2279, 67, 105, "Input",ExpressionUUID->"b1b948e8-878e-45b7-8333-50e385c0a2fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337601, 8364, 190, 3, 54, "Subsection",ExpressionUUID->"538c4d70-6f6a-477f-a2ea-c63338f18251"],
Cell[337794, 8369, 14966, 378, 485, "Input",ExpressionUUID->"ede37a2e-b19e-43f8-97b8-0e65b64a3180"]
}, Open  ]],
Cell[CellGroupData[{
Cell[352797, 8752, 205, 3, 54, "Subsection",ExpressionUUID->"2f59df24-32b2-4386-8cc6-c306b12ce5eb"],
Cell[353005, 8757, 485, 13, 28, "Input",ExpressionUUID->"98d4272f-e67e-4907-9c43-6bd1b7e9a412"],
Cell[353493, 8772, 15951, 423, 866, "Input",ExpressionUUID->"5bd53094-6ac4-4dae-99ad-afe278fe1118"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[369493, 9201, 181, 3, 67, "Section",ExpressionUUID->"d51a0621-ee14-4e7d-a5af-c83b945e05bb"],
Cell[CellGroupData[{
Cell[369699, 9208, 147, 3, 45, "Subsubsection",ExpressionUUID->"507c1f55-7ed6-4f27-a06b-173597077d99"],
Cell[369849, 9213, 42771, 1016, 1665, "Input",ExpressionUUID->"602e8b66-1cb6-4e6d-bf47-133869076448"]
}, Open  ]],
Cell[CellGroupData[{
Cell[412657, 10234, 235, 4, 45, "Subsubsection",ExpressionUUID->"c4fc7ab4-cf7b-42a9-9b93-cbf67d6efad6"],
Cell[412895, 10240, 3182, 87, 105, "Input",ExpressionUUID->"43eba3cf-c3ab-4855-be6a-01346e24caf6"],
Cell[416080, 10329, 32316, 794, 1589, "Input",ExpressionUUID->"a9e218c3-15c8-4cd7-b092-14cf677fcb39"]
}, Open  ]],
Cell[CellGroupData[{
Cell[448433, 11128, 203, 3, 54, "Subsection",ExpressionUUID->"da2ab995-6ed1-434a-bb5b-73b4a516b76a"],
Cell[448639, 11133, 14434, 339, 866, "Input",ExpressionUUID->"90aaec32-efda-4813-aaef-4f494157e2e9"],
Cell[463076, 11474, 10849, 282, 523, "Input",ExpressionUUID->"1b5e6aae-1c20-411b-a79f-5e39726caf09"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[473974, 11762, 192, 3, 67, "Section",ExpressionUUID->"d29fa193-fee2-42ab-ba45-07f002021799"],
Cell[474169, 11767, 3146, 82, 124, "Input",ExpressionUUID->"73c3d8c2-e6c0-4b58-9df7-bb7d6072a850"],
Cell[477318, 11851, 5579, 158, 314, "Input",ExpressionUUID->"dfb8e9dc-13c5-434b-ba9e-e2811db922f5"],
Cell[482900, 12011, 1968, 49, 183, "Input",ExpressionUUID->"f93da6a7-26f2-405d-a24e-ecf874877586"],
Cell[484871, 12062, 6019, 144, 428, "Input",ExpressionUUID->"23e90bf0-eb52-4dba-b2b6-2512f837ef09"],
Cell[490893, 12208, 1915, 55, 48, "Input",ExpressionUUID->"f2ab0fb9-4d41-4697-894d-fc2d5c1e3e08"],
Cell[CellGroupData[{
Cell[492833, 12267, 175, 3, 54, "Subsection",ExpressionUUID->"76a45b66-b2f9-42c6-ac40-638e383183d3"],
Cell[493011, 12272, 3640, 92, 181, "Input",ExpressionUUID->"47fb7539-e9df-420b-8edd-c60a5a79a5fe"],
Cell[496654, 12366, 2001, 56, 67, "Input",ExpressionUUID->"b1e8b1b2-82a6-45f6-9ca0-20d4eb052abd"],
Cell[498658, 12424, 1943, 52, 67, "Input",ExpressionUUID->"76f8d955-57ad-4f92-a56a-e883fd86dbd2"],
Cell[500604, 12478, 8806, 241, 561, "Input",ExpressionUUID->"ab17cfdd-0328-46bf-82d8-33b82beb1c2c"],
Cell[509413, 12721, 7888, 226, 371, "Input",ExpressionUUID->"5443cd7f-3835-498d-92fd-5331d8284548"],
Cell[517304, 12949, 23855, 608, 1246, "Input",ExpressionUUID->"073c4501-6a6f-48a5-ae76-1106b9621bee"],
Cell[541162, 13559, 8712, 239, 542, "Input",ExpressionUUID->"106afda1-d8a7-40a1-9aa2-52cd2de9f48d"],
Cell[549877, 13800, 4932, 131, 238, "Input",ExpressionUUID->"b6cc5df6-906e-4013-bdaa-a0b50c3d9638"],
Cell[554812, 13933, 2003, 56, 124, "Input",ExpressionUUID->"fad018ff-030c-45a1-818c-81701563b77d"],
Cell[556818, 13991, 2392, 64, 124, "Input",ExpressionUUID->"e17f386c-1d32-4b6e-85ab-02b072928a1e"],
Cell[559213, 14057, 1171, 32, 48, "Input",ExpressionUUID->"b16164ef-994e-4c82-922b-d739e9c0ece9"],
Cell[560387, 14091, 1138, 30, 48, "Input",ExpressionUUID->"5a001175-f88c-4100-9caa-7e32d98f121e"],
Cell[561528, 14123, 1709, 51, 28, "Input",ExpressionUUID->"2baefed6-086d-4c72-b8c0-5fdba0029f09"],
Cell[563240, 14176, 2000, 61, 124, "Input",ExpressionUUID->"9d520799-2597-4957-bab4-79104f8c202c"],
Cell[CellGroupData[{
Cell[565265, 14241, 186, 3, 32, "Item",ExpressionUUID->"544d2210-363d-4278-8811-1ca9fb89f010"],
Cell[565454, 14246, 2822, 93, 124, "Input",ExpressionUUID->"870ef738-af1f-4c9f-ba7e-a0b1eb8e1eb6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[568337, 14346, 157, 3, 67, "Section",ExpressionUUID->"f15d1707-b147-429d-a57c-a43f92f40c09"],
Cell[568497, 14351, 8283, 209, 542, "Input",ExpressionUUID->"ddc7fd27-71e5-4a3e-aaa5-706b18f234cc"],
Cell[576783, 14562, 3398, 90, 144, "Input",ExpressionUUID->"1fc5034d-ab19-450d-987d-08de8fa66160"],
Cell[580184, 14654, 1981, 54, 162, "Input",ExpressionUUID->"bc3d396f-c7c9-4681-8994-f1478eeb3dbe"],
Cell[582168, 14710, 2623, 71, 86, "Input",ExpressionUUID->"89934523-16a4-4bd2-923c-84db888ce004"],
Cell[584794, 14783, 442, 10, 28, "Input",ExpressionUUID->"5e28e5ff-ccdb-436a-84eb-2d83f13ce5d1"],
Cell[585239, 14795, 7110, 170, 428, "Input",ExpressionUUID->"65757453-ee34-4a08-a288-68b50a46a078"],
Cell[592352, 14967, 16552, 389, 893, "Input",ExpressionUUID->"0da5cded-a08a-46ce-9f98-14e2be28912b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[608941, 15361, 170, 3, 67, "Section",ExpressionUUID->"8e7469ff-6891-4301-9a16-7bfdac6ff7b4"],
Cell[609114, 15366, 8822, 248, 295, "Input",ExpressionUUID->"d16073cc-9bb4-4e0d-b3b8-c765c9580839"],
Cell[617939, 15616, 4797, 136, 219, "Input",ExpressionUUID->"c086a0b0-77f3-4985-bc6b-32b5bd8f5df5"],
Cell[622739, 15754, 962, 28, 48, "Input",ExpressionUUID->"93006866-db6f-4b62-9e24-8fb85b9c37d5"],
Cell[623704, 15784, 1545, 40, 67, "Input",ExpressionUUID->"05cf5322-9abf-42be-b167-af1d7639d813"],
Cell[CellGroupData[{
Cell[625274, 15828, 176, 3, 54, "Subsection",ExpressionUUID->"6f129ac9-e7c1-4fb9-8292-dbcc785ff197"],
Cell[625453, 15833, 10870, 299, 466, "Input",ExpressionUUID->"86d1868a-87c4-4892-8869-e712e9986486"],
Cell[636326, 16134, 6466, 174, 342, "Input",ExpressionUUID->"ad3a4e0f-87a2-40bf-bc87-6fddc26ad6af"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[642841, 16314, 174, 3, 67, "Section",ExpressionUUID->"5a766905-a619-46cb-b032-9d1c31ae4d9c"],
Cell[CellGroupData[{
Cell[643040, 16321, 206, 3, 45, "Subsubsection",ExpressionUUID->"3ba68173-efc5-4315-8ff1-2e7100099934"],
Cell[643249, 16326, 38781, 666, 731, "Text",ExpressionUUID->"8840f7f9-f292-470b-9546-3ad1e11ffbcf"],
Cell[682033, 16994, 588, 16, 28, "Input",ExpressionUUID->"62c590d5-e1c7-4dfa-8606-ad046af50cad"],
Cell[682624, 17012, 6078, 147, 409, "Input",ExpressionUUID->"26a08de0-777f-4382-a509-67497c67f71a"],
Cell[688705, 17161, 4359, 120, 238, "Input",ExpressionUUID->"13dc5875-7bd2-4183-b333-d97490309f19"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[693113, 17287, 174, 3, 67, "Section",ExpressionUUID->"6329a746-d076-4a90-a422-7726a760816d"],
Cell[693290, 17292, 171, 3, 35, "Text",ExpressionUUID->"a5770fd9-57f7-4caf-8af3-6a4fdd156d57"],
Cell[693464, 17297, 12558, 333, 695, "Input",ExpressionUUID->"7411a5a7-3ae0-4b47-8c02-e27f1ba107b2"]
}, Open  ]]
}, Open  ]]
}
]
*)

